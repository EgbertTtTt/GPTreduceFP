{
    "errors": [],
    "fails": [],
    "findings": [
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_updatePartiallyLiquidatedTrove",
            "impact": "Medium",
            "line": 3436,
            "line_end": 3467,
            "message": "Reentrancy in TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467):\n\tExternal calls:\n\t- sortedTroves.insert(_borrower,ICR,_price,_upperHint,_lowerHint) (TroveManager.sol#3464)\n\tState variables written after the call(s):\n\t- _addTroveOwnerToArray(_borrower) (TroveManager.sol#3465)\n\t\t- Troves[_borrower].arrayIndex = index (TroveManager.sol#3922)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_liquidateNormalMode",
            "impact": "Medium",
            "line": 2963,
            "line_end": 2987,
            "message": "Reentrancy in TroveManager._liquidateNormalMode(address,uint256) (TroveManager.sol#2963-2987):\n\tExternal calls:\n\t- _movePendingTroveRewardsToActivePool(L.pendingDebtReward,L.pendingCollReward) (TroveManager.sol#2971)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t- _closeTrove(_borrower) (TroveManager.sol#2983)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\tState variables written after the call(s):\n\t- _closeTrove(_borrower) (TroveManager.sol#2983)\n\t\t- Troves[_borrower].status = Status.closed (TroveManager.sol#3873)\n\t\t- Troves[_borrower].coll = 0 (TroveManager.sol#3874)\n\t\t- Troves[_borrower].debt = 0 (TroveManager.sol#3875)\n\t\t- Troves[addressToMove].arrayIndex = index (TroveManager.sol#3943)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n\t- _closeTrove(_borrower) (TroveManager.sol#2983)\n\t\t- rewardSnapshots[_borrower].ETH = 0 (TroveManager.sol#3877)\n\t\t- rewardSnapshots[_borrower].LUSDDebt = 0 (TroveManager.sol#3878)\n\tTroveManager.rewardSnapshots (TroveManager.sol#2791) can be used in cross function reentrancies:\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._updateTroveRewardSnapshots(address) (TroveManager.sol#3730-3733)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.hasPendingRewards(address) (TroveManager.sol#3763-3770)\n\t- TroveManager.rewardSnapshots (TroveManager.sol#2791)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "batchLiquidateTroves",
            "impact": "Medium",
            "line": 3291,
            "line_end": 3322,
            "message": "Reentrancy in TroveManager.batchLiquidateTroves(address[]) (TroveManager.sol#3291-3322):\n\tExternal calls:\n\t- T = _getTotalFromBatchLiquidate_RecoveryMode(L.price,L.LUSDInStabPool,_troveArray) (TroveManager.sol#3303)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- T = _getTotalsFromBatchLiquidate_NormalMode(L.price,L.LUSDInStabPool,_troveArray) (TroveManager.sol#3305)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- stabilityPool.offset(T.totalDebtToOffset,T.totalCollToSendToSP) (TroveManager.sol#3309)\n\t- _redistributeDebtAndColl(T.totalDebtToRedistribute,T.totalCollToRedistribute) (TroveManager.sol#3310)\n\t\t- activePool.decreaseLUSDDebt(_debt) (TroveManager.sol#3859)\n\t\t- defaultPool.increaseLUSDDebt(_debt) (TroveManager.sol#3860)\n\t\t- activePool.sendETH(address(defaultPool),_coll) (TroveManager.sol#3861)\n\t- _updatePartiallyLiquidatedTrove(T.partialAddr,T.partialNewDebt,T.partialNewColl,T.partialUpperHint,T.partialLowerHint,L.price) (TroveManager.sol#3314)\n\t\t- sortedTroves.insert(_borrower,ICR,_price,_upperHint,_lowerHint) (TroveManager.sol#3464)\n\tState variables written after the call(s):\n\t- _updatePartiallyLiquidatedTrove(T.partialAddr,T.partialNewDebt,T.partialNewColl,T.partialUpperHint,T.partialLowerHint,L.price) (TroveManager.sol#3314)\n\t\t- TroveOwners.push(_borrower) (TroveManager.sol#3918)\n\tTroveManager.TroveOwners (TroveManager.sol#2797) can be used in cross function reentrancies:\n\t- TroveManager.TroveOwners (TroveManager.sol#2797)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager.getTroveFromTroveOwnersArray(uint256) (TroveManager.sol#2945-2947)\n\t- TroveManager.getTroveOwnersCount() (TroveManager.sol#2941-2943)\n\t- _updatePartiallyLiquidatedTrove(T.partialAddr,T.partialNewDebt,T.partialNewColl,T.partialUpperHint,T.partialLowerHint,L.price) (TroveManager.sol#3314)\n\t\t- Troves[_borrower].stake = newStake (TroveManager.sol#3812)\n\t\t- Troves[_borrower].debt = _newDebt (TroveManager.sol#3449)\n\t\t- Troves[_borrower].arrayIndex = index (TroveManager.sol#3922)\n\t\t- Troves[_borrower].coll = _newColl (TroveManager.sol#3450)\n\t\t- Troves[_borrower].status = Status.active (TroveManager.sol#3451)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n\t- _updatePartiallyLiquidatedTrove(T.partialAddr,T.partialNewDebt,T.partialNewColl,T.partialUpperHint,T.partialLowerHint,L.price) (TroveManager.sol#3314)\n\t\t- rewardSnapshots[_borrower].ETH = L_ETH (TroveManager.sol#3731)\n\t\t- rewardSnapshots[_borrower].LUSDDebt = L_LUSDDebt (TroveManager.sol#3732)\n\tTroveManager.rewardSnapshots (TroveManager.sol#2791) can be used in cross function reentrancies:\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._updateTroveRewardSnapshots(address) (TroveManager.sol#3730-3733)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.hasPendingRewards(address) (TroveManager.sol#3763-3770)\n\t- TroveManager.rewardSnapshots (TroveManager.sol#2791)\n\t- _updatePartiallyLiquidatedTrove(T.partialAddr,T.partialNewDebt,T.partialNewColl,T.partialUpperHint,T.partialLowerHint,L.price) (TroveManager.sol#3314)\n\t\t- totalStakes = totalStakes.sub(oldStake).add(newStake) (TroveManager.sol#3813)\n\tTroveManager.totalStakes (TroveManager.sol#2771) can be used in cross function reentrancies:\n\t- TroveManager._redistributeDebtAndColl(uint256,uint256) (TroveManager.sol#3836-3862)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager._updateSystemSnapshots_excludeCollRemainder(uint256) (TroveManager.sol#3900-3906)\n\t- TroveManager.totalStakes (TroveManager.sol#2771)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_liquidateRecoveryMode",
            "impact": "Medium",
            "line": 2990,
            "line_end": 3050,
            "message": "Reentrancy in TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050):\n\tExternal calls:\n\t- _movePendingTroveRewardsToActivePool(L.pendingDebtReward,L.pendingCollReward) (TroveManager.sol#3000)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t- _closeTrove(_borrower) (TroveManager.sol#3042)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\tState variables written after the call(s):\n\t- _closeTrove(_borrower) (TroveManager.sol#3042)\n\t\t- TroveOwners[index] = addressToMove (TroveManager.sol#3942)\n\t\t- TroveOwners.pop() (TroveManager.sol#3944)\n\tTroveManager.TroveOwners (TroveManager.sol#2797) can be used in cross function reentrancies:\n\t- TroveManager.TroveOwners (TroveManager.sol#2797)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager.getTroveFromTroveOwnersArray(uint256) (TroveManager.sol#2945-2947)\n\t- TroveManager.getTroveOwnersCount() (TroveManager.sol#2941-2943)\n\t- _closeTrove(_borrower) (TroveManager.sol#3042)\n\t\t- Troves[_borrower].status = Status.closed (TroveManager.sol#3873)\n\t\t- Troves[_borrower].coll = 0 (TroveManager.sol#3874)\n\t\t- Troves[_borrower].debt = 0 (TroveManager.sol#3875)\n\t\t- Troves[addressToMove].arrayIndex = index (TroveManager.sol#3943)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n\t- _closeTrove(_borrower) (TroveManager.sol#3042)\n\t\t- rewardSnapshots[_borrower].ETH = 0 (TroveManager.sol#3877)\n\t\t- rewardSnapshots[_borrower].LUSDDebt = 0 (TroveManager.sol#3878)\n\tTroveManager.rewardSnapshots (TroveManager.sol#2791) can be used in cross function reentrancies:\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._updateTroveRewardSnapshots(address) (TroveManager.sol#3730-3733)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.hasPendingRewards(address) (TroveManager.sol#3763-3770)\n\t- TroveManager.rewardSnapshots (TroveManager.sol#2791)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_redeemCollateralFromTrove",
            "impact": "Medium",
            "line": 3489,
            "line_end": 3538,
            "message": "Reentrancy in TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538):\n\tExternal calls:\n\t- sortedTroves.reInsert(_borrower,newICR,_price,_partialRedemptionHint,_partialRedemptionHint) (TroveManager.sol#3525)\n\tState variables written after the call(s):\n\t- Troves[_borrower].debt = newDebt (TroveManager.sol#3527)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n\t- Troves[_borrower].coll = newColl (TroveManager.sol#3528)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n\t- _updateStakeAndTotalStakes(_borrower) (TroveManager.sol#3529)\n\t\t- Troves[_borrower].stake = newStake (TroveManager.sol#3812)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "liquidateTroves",
            "impact": "Medium",
            "line": 3156,
            "line_end": 3186,
            "message": "Reentrancy in TroveManager.liquidateTroves(uint256) (TroveManager.sol#3156-3186):\n\tExternal calls:\n\t- T = _getTotalsFromLiquidateTrovesSequence_RecoveryMode(L.price,L.LUSDInStabPool,_n) (TroveManager.sol#3167)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- T = _getTotalsFromLiquidateTrovesSequence_NormalMode(L.price,L.LUSDInStabPool,_n) (TroveManager.sol#3169)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- stabilityPool.offset(T.totalDebtToOffset,T.totalCollToSendToSP) (TroveManager.sol#3173)\n\t- _redistributeDebtAndColl(T.totalDebtToRedistribute,T.totalCollToRedistribute) (TroveManager.sol#3174)\n\t\t- activePool.decreaseLUSDDebt(_debt) (TroveManager.sol#3859)\n\t\t- defaultPool.increaseLUSDDebt(_debt) (TroveManager.sol#3860)\n\t\t- activePool.sendETH(address(defaultPool),_coll) (TroveManager.sol#3861)\n\tState variables written after the call(s):\n\t- _redistributeDebtAndColl(T.totalDebtToRedistribute,T.totalCollToRedistribute) (TroveManager.sol#3174)\n\t\t- L_ETH = L_ETH.add(ETHRewardPerUnitStaked) (TroveManager.sol#3854)\n\tTroveManager.L_ETH (TroveManager.sol#2787) can be used in cross function reentrancies:\n\t- TroveManager.L_ETH (TroveManager.sol#2787)\n\t- TroveManager._redistributeDebtAndColl(uint256,uint256) (TroveManager.sol#3836-3862)\n\t- TroveManager._updateTroveRewardSnapshots(address) (TroveManager.sol#3730-3733)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.hasPendingRewards(address) (TroveManager.sol#3763-3770)\n\t- _redistributeDebtAndColl(T.totalDebtToRedistribute,T.totalCollToRedistribute) (TroveManager.sol#3174)\n\t\t- L_LUSDDebt = L_LUSDDebt.add(LUSDDebtRewardPerUnitStaked) (TroveManager.sol#3855)\n\tTroveManager.L_LUSDDebt (TroveManager.sol#2788) can be used in cross function reentrancies:\n\t- TroveManager.L_LUSDDebt (TroveManager.sol#2788)\n\t- TroveManager._redistributeDebtAndColl(uint256,uint256) (TroveManager.sol#3836-3862)\n\t- TroveManager._updateTroveRewardSnapshots(address) (TroveManager.sol#3730-3733)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "batchLiquidateTroves",
            "impact": "Medium",
            "line": 3291,
            "line_end": 3322,
            "message": "Reentrancy in TroveManager.batchLiquidateTroves(address[]) (TroveManager.sol#3291-3322):\n\tExternal calls:\n\t- T = _getTotalFromBatchLiquidate_RecoveryMode(L.price,L.LUSDInStabPool,_troveArray) (TroveManager.sol#3303)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- T = _getTotalsFromBatchLiquidate_NormalMode(L.price,L.LUSDInStabPool,_troveArray) (TroveManager.sol#3305)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- stabilityPool.offset(T.totalDebtToOffset,T.totalCollToSendToSP) (TroveManager.sol#3309)\n\t- _redistributeDebtAndColl(T.totalDebtToRedistribute,T.totalCollToRedistribute) (TroveManager.sol#3310)\n\t\t- activePool.decreaseLUSDDebt(_debt) (TroveManager.sol#3859)\n\t\t- defaultPool.increaseLUSDDebt(_debt) (TroveManager.sol#3860)\n\t\t- activePool.sendETH(address(defaultPool),_coll) (TroveManager.sol#3861)\n\tState variables written after the call(s):\n\t- _redistributeDebtAndColl(T.totalDebtToRedistribute,T.totalCollToRedistribute) (TroveManager.sol#3310)\n\t\t- L_ETH = L_ETH.add(ETHRewardPerUnitStaked) (TroveManager.sol#3854)\n\tTroveManager.L_ETH (TroveManager.sol#2787) can be used in cross function reentrancies:\n\t- TroveManager.L_ETH (TroveManager.sol#2787)\n\t- TroveManager._redistributeDebtAndColl(uint256,uint256) (TroveManager.sol#3836-3862)\n\t- TroveManager._updateTroveRewardSnapshots(address) (TroveManager.sol#3730-3733)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.hasPendingRewards(address) (TroveManager.sol#3763-3770)\n\t- _redistributeDebtAndColl(T.totalDebtToRedistribute,T.totalCollToRedistribute) (TroveManager.sol#3310)\n\t\t- L_LUSDDebt = L_LUSDDebt.add(LUSDDebtRewardPerUnitStaked) (TroveManager.sol#3855)\n\tTroveManager.L_LUSDDebt (TroveManager.sol#2788) can be used in cross function reentrancies:\n\t- TroveManager.L_LUSDDebt (TroveManager.sol#2788)\n\t- TroveManager._redistributeDebtAndColl(uint256,uint256) (TroveManager.sol#3836-3862)\n\t- TroveManager._updateTroveRewardSnapshots(address) (TroveManager.sol#3730-3733)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_getTotalsFromLiquidateTrovesSequence_RecoveryMode",
            "impact": "Medium",
            "line": 3192,
            "line_end": 3250,
            "message": "Reentrancy in TroveManager._getTotalsFromLiquidateTrovesSequence_RecoveryMode(uint256,uint256,uint256) (TroveManager.sol#3192-3250):\n\tExternal calls:\n\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3220)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- V = _liquidateNormalMode(L.user,L.remainingLUSDInStabPool) (TroveManager.sol#3236)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\tState variables written after the call(s):\n\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3220)\n\t\t- TroveOwners[index] = addressToMove (TroveManager.sol#3942)\n\t\t- TroveOwners.pop() (TroveManager.sol#3944)\n\tTroveManager.TroveOwners (TroveManager.sol#2797) can be used in cross function reentrancies:\n\t- TroveManager.TroveOwners (TroveManager.sol#2797)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager.getTroveFromTroveOwnersArray(uint256) (TroveManager.sol#2945-2947)\n\t- TroveManager.getTroveOwnersCount() (TroveManager.sol#2941-2943)\n\t- V = _liquidateNormalMode(L.user,L.remainingLUSDInStabPool) (TroveManager.sol#3236)\n\t\t- TroveOwners[index] = addressToMove (TroveManager.sol#3942)\n\t\t- TroveOwners.pop() (TroveManager.sol#3944)\n\tTroveManager.TroveOwners (TroveManager.sol#2797) can be used in cross function reentrancies:\n\t- TroveManager.TroveOwners (TroveManager.sol#2797)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager.getTroveFromTroveOwnersArray(uint256) (TroveManager.sol#2945-2947)\n\t- TroveManager.getTroveOwnersCount() (TroveManager.sol#2941-2943)\n\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3220)\n\t\t- Troves[_borrower].status = Status.closed (TroveManager.sol#3873)\n\t\t- Troves[_borrower].stake = 0 (TroveManager.sol#3800)\n\t\t- Troves[_borrower].coll = 0 (TroveManager.sol#3874)\n\t\t- Troves[_borrower].debt = 0 (TroveManager.sol#3875)\n\t\t- Troves[addressToMove].arrayIndex = index (TroveManager.sol#3943)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n\t- V = _liquidateNormalMode(L.user,L.remainingLUSDInStabPool) (TroveManager.sol#3236)\n\t\t- Troves[_borrower].status = Status.closed (TroveManager.sol#3873)\n\t\t- Troves[_borrower].stake = 0 (TroveManager.sol#3800)\n\t\t- Troves[_borrower].coll = 0 (TroveManager.sol#3874)\n\t\t- Troves[_borrower].debt = 0 (TroveManager.sol#3875)\n\t\t- Troves[addressToMove].arrayIndex = index (TroveManager.sol#3943)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3220)\n\t\t- rewardSnapshots[_borrower].ETH = 0 (TroveManager.sol#3877)\n\t\t- rewardSnapshots[_borrower].LUSDDebt = 0 (TroveManager.sol#3878)\n\tTroveManager.rewardSnapshots (TroveManager.sol#2791) can be used in cross function reentrancies:\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._updateTroveRewardSnapshots(address) (TroveManager.sol#3730-3733)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.hasPendingRewards(address) (TroveManager.sol#3763-3770)\n\t- TroveManager.rewardSnapshots (TroveManager.sol#2791)\n\t- V = _liquidateNormalMode(L.user,L.remainingLUSDInStabPool) (TroveManager.sol#3236)\n\t\t- rewardSnapshots[_borrower].ETH = 0 (TroveManager.sol#3877)\n\t\t- rewardSnapshots[_borrower].LUSDDebt = 0 (TroveManager.sol#3878)\n\tTroveManager.rewardSnapshots (TroveManager.sol#2791) can be used in cross function reentrancies:\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._updateTroveRewardSnapshots(address) (TroveManager.sol#3730-3733)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.hasPendingRewards(address) (TroveManager.sol#3763-3770)\n\t- TroveManager.rewardSnapshots (TroveManager.sol#2791)\n\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3220)\n\t\t- totalStakes = totalStakes.sub(stake) (TroveManager.sol#3799)\n\tTroveManager.totalStakes (TroveManager.sol#2771) can be used in cross function reentrancies:\n\t- TroveManager._redistributeDebtAndColl(uint256,uint256) (TroveManager.sol#3836-3862)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager._updateSystemSnapshots_excludeCollRemainder(uint256) (TroveManager.sol#3900-3906)\n\t- TroveManager.totalStakes (TroveManager.sol#2771)\n\t- V = _liquidateNormalMode(L.user,L.remainingLUSDInStabPool) (TroveManager.sol#3236)\n\t\t- totalStakes = totalStakes.sub(stake) (TroveManager.sol#3799)\n\tTroveManager.totalStakes (TroveManager.sol#2771) can be used in cross function reentrancies:\n\t- TroveManager._redistributeDebtAndColl(uint256,uint256) (TroveManager.sol#3836-3862)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager._updateSystemSnapshots_excludeCollRemainder(uint256) (TroveManager.sol#3900-3906)\n\t- TroveManager.totalStakes (TroveManager.sol#2771)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_liquidateRecoveryMode",
            "impact": "Medium",
            "line": 2990,
            "line_end": 3050,
            "message": "Reentrancy in TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050):\n\tExternal calls:\n\t- _movePendingTroveRewardsToActivePool(L.pendingDebtReward,L.pendingCollReward) (TroveManager.sol#3000)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t- _closeTrove(_borrower) (TroveManager.sol#3016)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\tState variables written after the call(s):\n\t- _closeTrove(_borrower) (TroveManager.sol#3016)\n\t\t- TroveOwners[index] = addressToMove (TroveManager.sol#3942)\n\t\t- TroveOwners.pop() (TroveManager.sol#3944)\n\tTroveManager.TroveOwners (TroveManager.sol#2797) can be used in cross function reentrancies:\n\t- TroveManager.TroveOwners (TroveManager.sol#2797)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager.getTroveFromTroveOwnersArray(uint256) (TroveManager.sol#2945-2947)\n\t- TroveManager.getTroveOwnersCount() (TroveManager.sol#2941-2943)\n\t- _closeTrove(_borrower) (TroveManager.sol#3016)\n\t\t- Troves[_borrower].status = Status.closed (TroveManager.sol#3873)\n\t\t- Troves[_borrower].coll = 0 (TroveManager.sol#3874)\n\t\t- Troves[_borrower].debt = 0 (TroveManager.sol#3875)\n\t\t- Troves[addressToMove].arrayIndex = index (TroveManager.sol#3943)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n\t- _closeTrove(_borrower) (TroveManager.sol#3016)\n\t\t- rewardSnapshots[_borrower].ETH = 0 (TroveManager.sol#3877)\n\t\t- rewardSnapshots[_borrower].LUSDDebt = 0 (TroveManager.sol#3878)\n\tTroveManager.rewardSnapshots (TroveManager.sol#2791) can be used in cross function reentrancies:\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._updateTroveRewardSnapshots(address) (TroveManager.sol#3730-3733)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.hasPendingRewards(address) (TroveManager.sol#3763-3770)\n\t- TroveManager.rewardSnapshots (TroveManager.sol#2791)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_liquidateNormalMode",
            "impact": "Medium",
            "line": 2963,
            "line_end": 2987,
            "message": "Reentrancy in TroveManager._liquidateNormalMode(address,uint256) (TroveManager.sol#2963-2987):\n\tExternal calls:\n\t- _movePendingTroveRewardsToActivePool(L.pendingDebtReward,L.pendingCollReward) (TroveManager.sol#2971)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\tState variables written after the call(s):\n\t- _removeStake(_borrower) (TroveManager.sol#2972)\n\t\t- Troves[_borrower].stake = 0 (TroveManager.sol#3800)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_liquidateRecoveryMode",
            "impact": "Medium",
            "line": 2990,
            "line_end": 3050,
            "message": "Reentrancy in TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050):\n\tExternal calls:\n\t- _movePendingTroveRewardsToActivePool(L.pendingDebtReward,L.pendingCollReward) (TroveManager.sol#3000)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t- _closeTrove(_borrower) (TroveManager.sol#3028)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\tState variables written after the call(s):\n\t- _closeTrove(_borrower) (TroveManager.sol#3028)\n\t\t- TroveOwners[index] = addressToMove (TroveManager.sol#3942)\n\t\t- TroveOwners.pop() (TroveManager.sol#3944)\n\tTroveManager.TroveOwners (TroveManager.sol#2797) can be used in cross function reentrancies:\n\t- TroveManager.TroveOwners (TroveManager.sol#2797)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager.getTroveFromTroveOwnersArray(uint256) (TroveManager.sol#2945-2947)\n\t- TroveManager.getTroveOwnersCount() (TroveManager.sol#2941-2943)\n\t- _closeTrove(_borrower) (TroveManager.sol#3028)\n\t\t- Troves[_borrower].status = Status.closed (TroveManager.sol#3873)\n\t\t- Troves[_borrower].coll = 0 (TroveManager.sol#3874)\n\t\t- Troves[_borrower].debt = 0 (TroveManager.sol#3875)\n\t\t- Troves[addressToMove].arrayIndex = index (TroveManager.sol#3943)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n\t- _closeTrove(_borrower) (TroveManager.sol#3028)\n\t\t- rewardSnapshots[_borrower].ETH = 0 (TroveManager.sol#3877)\n\t\t- rewardSnapshots[_borrower].LUSDDebt = 0 (TroveManager.sol#3878)\n\tTroveManager.rewardSnapshots (TroveManager.sol#2791) can be used in cross function reentrancies:\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._updateTroveRewardSnapshots(address) (TroveManager.sol#3730-3733)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.hasPendingRewards(address) (TroveManager.sol#3763-3770)\n\t- TroveManager.rewardSnapshots (TroveManager.sol#2791)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_liquidateRecoveryMode",
            "impact": "Medium",
            "line": 2990,
            "line_end": 3050,
            "message": "Reentrancy in TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050):\n\tExternal calls:\n\t- _movePendingTroveRewardsToActivePool(L.pendingDebtReward,L.pendingCollReward) (TroveManager.sol#3000)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\tState variables written after the call(s):\n\t- _removeStake(_borrower) (TroveManager.sol#3009)\n\t\t- Troves[_borrower].stake = 0 (TroveManager.sol#3800)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n\t- _removeStake(_borrower) (TroveManager.sol#3021)\n\t\t- Troves[_borrower].stake = 0 (TroveManager.sol#3800)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n\t- _removeStake(_borrower) (TroveManager.sol#3038)\n\t\t- Troves[_borrower].stake = 0 (TroveManager.sol#3800)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "liquidateTroves",
            "impact": "Medium",
            "line": 3156,
            "line_end": 3186,
            "message": "Reentrancy in TroveManager.liquidateTroves(uint256) (TroveManager.sol#3156-3186):\n\tExternal calls:\n\t- T = _getTotalsFromLiquidateTrovesSequence_RecoveryMode(L.price,L.LUSDInStabPool,_n) (TroveManager.sol#3167)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- T = _getTotalsFromLiquidateTrovesSequence_NormalMode(L.price,L.LUSDInStabPool,_n) (TroveManager.sol#3169)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- stabilityPool.offset(T.totalDebtToOffset,T.totalCollToSendToSP) (TroveManager.sol#3173)\n\t- _redistributeDebtAndColl(T.totalDebtToRedistribute,T.totalCollToRedistribute) (TroveManager.sol#3174)\n\t\t- activePool.decreaseLUSDDebt(_debt) (TroveManager.sol#3859)\n\t\t- defaultPool.increaseLUSDDebt(_debt) (TroveManager.sol#3860)\n\t\t- activePool.sendETH(address(defaultPool),_coll) (TroveManager.sol#3861)\n\t- _updatePartiallyLiquidatedTrove(T.partialAddr,T.partialNewDebt,T.partialNewColl,T.partialUpperHint,T.partialLowerHint,L.price) (TroveManager.sol#3178)\n\t\t- sortedTroves.insert(_borrower,ICR,_price,_upperHint,_lowerHint) (TroveManager.sol#3464)\n\tState variables written after the call(s):\n\t- _updatePartiallyLiquidatedTrove(T.partialAddr,T.partialNewDebt,T.partialNewColl,T.partialUpperHint,T.partialLowerHint,L.price) (TroveManager.sol#3178)\n\t\t- TroveOwners.push(_borrower) (TroveManager.sol#3918)\n\tTroveManager.TroveOwners (TroveManager.sol#2797) can be used in cross function reentrancies:\n\t- TroveManager.TroveOwners (TroveManager.sol#2797)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager.getTroveFromTroveOwnersArray(uint256) (TroveManager.sol#2945-2947)\n\t- TroveManager.getTroveOwnersCount() (TroveManager.sol#2941-2943)\n\t- _updatePartiallyLiquidatedTrove(T.partialAddr,T.partialNewDebt,T.partialNewColl,T.partialUpperHint,T.partialLowerHint,L.price) (TroveManager.sol#3178)\n\t\t- Troves[_borrower].stake = newStake (TroveManager.sol#3812)\n\t\t- Troves[_borrower].debt = _newDebt (TroveManager.sol#3449)\n\t\t- Troves[_borrower].arrayIndex = index (TroveManager.sol#3922)\n\t\t- Troves[_borrower].coll = _newColl (TroveManager.sol#3450)\n\t\t- Troves[_borrower].status = Status.active (TroveManager.sol#3451)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n\t- _updatePartiallyLiquidatedTrove(T.partialAddr,T.partialNewDebt,T.partialNewColl,T.partialUpperHint,T.partialLowerHint,L.price) (TroveManager.sol#3178)\n\t\t- rewardSnapshots[_borrower].ETH = L_ETH (TroveManager.sol#3731)\n\t\t- rewardSnapshots[_borrower].LUSDDebt = L_LUSDDebt (TroveManager.sol#3732)\n\tTroveManager.rewardSnapshots (TroveManager.sol#2791) can be used in cross function reentrancies:\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._updateTroveRewardSnapshots(address) (TroveManager.sol#3730-3733)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.hasPendingRewards(address) (TroveManager.sol#3763-3770)\n\t- TroveManager.rewardSnapshots (TroveManager.sol#2791)\n\t- _updatePartiallyLiquidatedTrove(T.partialAddr,T.partialNewDebt,T.partialNewColl,T.partialUpperHint,T.partialLowerHint,L.price) (TroveManager.sol#3178)\n\t\t- totalStakes = totalStakes.sub(oldStake).add(newStake) (TroveManager.sol#3813)\n\tTroveManager.totalStakes (TroveManager.sol#2771) can be used in cross function reentrancies:\n\t- TroveManager._redistributeDebtAndColl(uint256,uint256) (TroveManager.sol#3836-3862)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager._updateSystemSnapshots_excludeCollRemainder(uint256) (TroveManager.sol#3900-3906)\n\t- TroveManager.totalStakes (TroveManager.sol#2771)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "redeemCollateral",
            "impact": "Medium",
            "line": 3590,
            "line_end": 3665,
            "message": "Reentrancy in TroveManager.redeemCollateral(uint256,address,address,uint256,uint256) (TroveManager.sol#3590-3665):\n\tExternal calls:\n\t- _applyPendingRewards(currentBorrower) (TroveManager.sol#3633)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t- V = _redeemCollateralFromTrove(currentBorrower,remainingLUSD,price,_partialRedemptionHint,_partialRedemptionHintICR) (TroveManager.sol#3634-3640)\n\t\t- lusdToken.burn(GAS_POOL_ADDRESS,_LUSD) (TroveManager.sol#3548)\n\t\t- activePool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3550)\n\t\t- collSurplusPool.accountSurplus(_borrower,_ETH) (TroveManager.sol#3553)\n\t\t- activePool.sendETH(address(collSurplusPool),_ETH) (TroveManager.sol#3554)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t\t- sortedTroves.reInsert(_borrower,newICR,_price,_partialRedemptionHint,_partialRedemptionHint) (TroveManager.sol#3525)\n\tState variables written after the call(s):\n\t- V = _redeemCollateralFromTrove(currentBorrower,remainingLUSD,price,_partialRedemptionHint,_partialRedemptionHintICR) (TroveManager.sol#3634-3640)\n\t\t- TroveOwners[index] = addressToMove (TroveManager.sol#3942)\n\t\t- TroveOwners.pop() (TroveManager.sol#3944)\n\tTroveManager.TroveOwners (TroveManager.sol#2797) can be used in cross function reentrancies:\n\t- TroveManager.TroveOwners (TroveManager.sol#2797)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager.getTroveFromTroveOwnersArray(uint256) (TroveManager.sol#2945-2947)\n\t- TroveManager.getTroveOwnersCount() (TroveManager.sol#2941-2943)\n\t- _applyPendingRewards(currentBorrower) (TroveManager.sol#3633)\n\t\t- Troves[_borrower].coll = Troves[_borrower].coll.add(pendingETHReward) (TroveManager.sol#3706)\n\t\t- Troves[_borrower].debt = Troves[_borrower].debt.add(pendingLUSDDebtReward) (TroveManager.sol#3707)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n\t- V = _redeemCollateralFromTrove(currentBorrower,remainingLUSD,price,_partialRedemptionHint,_partialRedemptionHintICR) (TroveManager.sol#3634-3640)\n\t\t- Troves[_borrower].stake = newStake (TroveManager.sol#3812)\n\t\t- Troves[_borrower].status = Status.closed (TroveManager.sol#3873)\n\t\t- Troves[_borrower].stake = 0 (TroveManager.sol#3800)\n\t\t- Troves[_borrower].coll = 0 (TroveManager.sol#3874)\n\t\t- Troves[_borrower].debt = 0 (TroveManager.sol#3875)\n\t\t- Troves[addressToMove].arrayIndex = index (TroveManager.sol#3943)\n\t\t- Troves[_borrower].debt = newDebt (TroveManager.sol#3527)\n\t\t- Troves[_borrower].coll = newColl (TroveManager.sol#3528)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n\t- _applyPendingRewards(currentBorrower) (TroveManager.sol#3633)\n\t\t- rewardSnapshots[_borrower].ETH = L_ETH (TroveManager.sol#3731)\n\t\t- rewardSnapshots[_borrower].LUSDDebt = L_LUSDDebt (TroveManager.sol#3732)\n\tTroveManager.rewardSnapshots (TroveManager.sol#2791) can be used in cross function reentrancies:\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._updateTroveRewardSnapshots(address) (TroveManager.sol#3730-3733)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.hasPendingRewards(address) (TroveManager.sol#3763-3770)\n\t- TroveManager.rewardSnapshots (TroveManager.sol#2791)\n\t- V = _redeemCollateralFromTrove(currentBorrower,remainingLUSD,price,_partialRedemptionHint,_partialRedemptionHintICR) (TroveManager.sol#3634-3640)\n\t\t- rewardSnapshots[_borrower].ETH = 0 (TroveManager.sol#3877)\n\t\t- rewardSnapshots[_borrower].LUSDDebt = 0 (TroveManager.sol#3878)\n\tTroveManager.rewardSnapshots (TroveManager.sol#2791) can be used in cross function reentrancies:\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._updateTroveRewardSnapshots(address) (TroveManager.sol#3730-3733)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.hasPendingRewards(address) (TroveManager.sol#3763-3770)\n\t- TroveManager.rewardSnapshots (TroveManager.sol#2791)\n\t- V = _redeemCollateralFromTrove(currentBorrower,remainingLUSD,price,_partialRedemptionHint,_partialRedemptionHintICR) (TroveManager.sol#3634-3640)\n\t\t- totalStakes = totalStakes.sub(stake) (TroveManager.sol#3799)\n\t\t- totalStakes = totalStakes.sub(oldStake).add(newStake) (TroveManager.sol#3813)\n\tTroveManager.totalStakes (TroveManager.sol#2771) can be used in cross function reentrancies:\n\t- TroveManager._redistributeDebtAndColl(uint256,uint256) (TroveManager.sol#3836-3862)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager._updateSystemSnapshots_excludeCollRemainder(uint256) (TroveManager.sol#3900-3906)\n\t- TroveManager.totalStakes (TroveManager.sol#2771)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_getTotalFromBatchLiquidate_RecoveryMode",
            "impact": "Medium",
            "line": 3328,
            "line_end": 3380,
            "message": "Reentrancy in TroveManager._getTotalFromBatchLiquidate_RecoveryMode(uint256,uint256,address[]) (TroveManager.sol#3328-3380):\n\tExternal calls:\n\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3356)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- V = _liquidateNormalMode(L.user,L.remainingLUSDInStabPool) (TroveManager.sol#3373)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\tState variables written after the call(s):\n\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3356)\n\t\t- TroveOwners[index] = addressToMove (TroveManager.sol#3942)\n\t\t- TroveOwners.pop() (TroveManager.sol#3944)\n\tTroveManager.TroveOwners (TroveManager.sol#2797) can be used in cross function reentrancies:\n\t- TroveManager.TroveOwners (TroveManager.sol#2797)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager.getTroveFromTroveOwnersArray(uint256) (TroveManager.sol#2945-2947)\n\t- TroveManager.getTroveOwnersCount() (TroveManager.sol#2941-2943)\n\t- V = _liquidateNormalMode(L.user,L.remainingLUSDInStabPool) (TroveManager.sol#3373)\n\t\t- TroveOwners[index] = addressToMove (TroveManager.sol#3942)\n\t\t- TroveOwners.pop() (TroveManager.sol#3944)\n\tTroveManager.TroveOwners (TroveManager.sol#2797) can be used in cross function reentrancies:\n\t- TroveManager.TroveOwners (TroveManager.sol#2797)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager.getTroveFromTroveOwnersArray(uint256) (TroveManager.sol#2945-2947)\n\t- TroveManager.getTroveOwnersCount() (TroveManager.sol#2941-2943)\n\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3356)\n\t\t- Troves[_borrower].status = Status.closed (TroveManager.sol#3873)\n\t\t- Troves[_borrower].stake = 0 (TroveManager.sol#3800)\n\t\t- Troves[_borrower].coll = 0 (TroveManager.sol#3874)\n\t\t- Troves[_borrower].debt = 0 (TroveManager.sol#3875)\n\t\t- Troves[addressToMove].arrayIndex = index (TroveManager.sol#3943)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n\t- V = _liquidateNormalMode(L.user,L.remainingLUSDInStabPool) (TroveManager.sol#3373)\n\t\t- Troves[_borrower].status = Status.closed (TroveManager.sol#3873)\n\t\t- Troves[_borrower].stake = 0 (TroveManager.sol#3800)\n\t\t- Troves[_borrower].coll = 0 (TroveManager.sol#3874)\n\t\t- Troves[_borrower].debt = 0 (TroveManager.sol#3875)\n\t\t- Troves[addressToMove].arrayIndex = index (TroveManager.sol#3943)\n\tTroveManager.Troves (TroveManager.sol#2769) can be used in cross function reentrancies:\n\t- TroveManager.Troves (TroveManager.sol#2769)\n\t- TroveManager._addTroveOwnerToArray(address) (TroveManager.sol#3914-3925)\n\t- TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722)\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945)\n\t- TroveManager._requireTroveisActive(address) (TroveManager.sol#4079-4081)\n\t- TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager.decreaseTroveColl(address,uint256) (TroveManager.sol#4127-4132)\n\t- TroveManager.decreaseTroveDebt(address,uint256) (TroveManager.sol#4141-4146)\n\t- TroveManager.getCurrentICR(address,uint256) (TroveManager.sol#3680-3689)\n\t- TroveManager.getEntireDebtAndColl(address) (TroveManager.sol#3773-3789)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.getTroveColl(address) (TroveManager.sol#4109-4111)\n\t- TroveManager.getTroveDebt(address) (TroveManager.sol#4105-4107)\n\t- TroveManager.getTroveStake(address) (TroveManager.sol#4101-4103)\n\t- TroveManager.getTroveStatus(address) (TroveManager.sol#4097-4099)\n\t- TroveManager.increaseTroveColl(address,uint256) (TroveManager.sol#4120-4125)\n\t- TroveManager.increaseTroveDebt(address,uint256) (TroveManager.sol#4134-4139)\n\t- TroveManager.setTroveStatus(address,uint256) (TroveManager.sol#4115-4118)\n\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3356)\n\t\t- rewardSnapshots[_borrower].ETH = 0 (TroveManager.sol#3877)\n\t\t- rewardSnapshots[_borrower].LUSDDebt = 0 (TroveManager.sol#3878)\n\tTroveManager.rewardSnapshots (TroveManager.sol#2791) can be used in cross function reentrancies:\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._updateTroveRewardSnapshots(address) (TroveManager.sol#3730-3733)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.hasPendingRewards(address) (TroveManager.sol#3763-3770)\n\t- TroveManager.rewardSnapshots (TroveManager.sol#2791)\n\t- V = _liquidateNormalMode(L.user,L.remainingLUSDInStabPool) (TroveManager.sol#3373)\n\t\t- rewardSnapshots[_borrower].ETH = 0 (TroveManager.sol#3877)\n\t\t- rewardSnapshots[_borrower].LUSDDebt = 0 (TroveManager.sol#3878)\n\tTroveManager.rewardSnapshots (TroveManager.sol#2791) can be used in cross function reentrancies:\n\t- TroveManager._closeTrove(address) (TroveManager.sol#3869-3882)\n\t- TroveManager._updateTroveRewardSnapshots(address) (TroveManager.sol#3730-3733)\n\t- TroveManager.getPendingETHReward(address) (TroveManager.sol#3736-3747)\n\t- TroveManager.getPendingLUSDDebtReward(address) (TroveManager.sol#3750-3761)\n\t- TroveManager.hasPendingRewards(address) (TroveManager.sol#3763-3770)\n\t- TroveManager.rewardSnapshots (TroveManager.sol#2791)\n\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3356)\n\t\t- totalStakes = totalStakes.sub(stake) (TroveManager.sol#3799)\n\tTroveManager.totalStakes (TroveManager.sol#2771) can be used in cross function reentrancies:\n\t- TroveManager._redistributeDebtAndColl(uint256,uint256) (TroveManager.sol#3836-3862)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager._updateSystemSnapshots_excludeCollRemainder(uint256) (TroveManager.sol#3900-3906)\n\t- TroveManager.totalStakes (TroveManager.sol#2771)\n\t- V = _liquidateNormalMode(L.user,L.remainingLUSDInStabPool) (TroveManager.sol#3373)\n\t\t- totalStakes = totalStakes.sub(stake) (TroveManager.sol#3799)\n\tTroveManager.totalStakes (TroveManager.sol#2771) can be used in cross function reentrancies:\n\t- TroveManager._redistributeDebtAndColl(uint256,uint256) (TroveManager.sol#3836-3862)\n\t- TroveManager._removeStake(address) (TroveManager.sol#3797-3801)\n\t- TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816)\n\t- TroveManager._updateSystemSnapshots_excludeCollRemainder(uint256) (TroveManager.sol#3900-3906)\n\t- TroveManager.totalStakes (TroveManager.sol#2771)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_movePendingTroveRewardsToActivePool",
            "impact": "Low",
            "line": 3480,
            "line_end": 3484,
            "message": "TroveManager._movePendingTroveRewardsToActivePool(uint256,uint256) (TroveManager.sol#3480-3484) has external calls inside a loop: activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n",
            "name": "calls-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_redeemCloseTrove",
            "impact": "Low",
            "line": 3547,
            "line_end": 3555,
            "message": "TroveManager._redeemCloseTrove(address,uint256,uint256) (TroveManager.sol#3547-3555) has external calls inside a loop: activePool.sendETH(address(collSurplusPool),_ETH) (TroveManager.sol#3554)\n",
            "name": "calls-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_movePendingTroveRewardsToActivePool",
            "impact": "Low",
            "line": 3480,
            "line_end": 3484,
            "message": "TroveManager._movePendingTroveRewardsToActivePool(uint256,uint256) (TroveManager.sol#3480-3484) has external calls inside a loop: defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n",
            "name": "calls-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_redeemCloseTrove",
            "impact": "Low",
            "line": 3547,
            "line_end": 3555,
            "message": "TroveManager._redeemCloseTrove(address,uint256,uint256) (TroveManager.sol#3547-3555) has external calls inside a loop: lusdToken.burn(GAS_POOL_ADDRESS,_LUSD) (TroveManager.sol#3548)\n",
            "name": "calls-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_closeTrove",
            "impact": "Low",
            "line": 3869,
            "line_end": 3882,
            "message": "TroveManager._closeTrove(address) (TroveManager.sol#3869-3882) has external calls inside a loop: sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n",
            "name": "calls-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_redeemCloseTrove",
            "impact": "Low",
            "line": 3547,
            "line_end": 3555,
            "message": "TroveManager._redeemCloseTrove(address,uint256,uint256) (TroveManager.sol#3547-3555) has external calls inside a loop: collSurplusPool.accountSurplus(_borrower,_ETH) (TroveManager.sol#3553)\n",
            "name": "calls-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "redeemCollateral",
            "impact": "Low",
            "line": 3590,
            "line_end": 3665,
            "message": "TroveManager.redeemCollateral(uint256,address,address,uint256,uint256) (TroveManager.sol#3590-3665) has external calls inside a loop: currentBorrower = sortedTroves.getPrev(currentBorrower) (TroveManager.sol#3622)\n",
            "name": "calls-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_redeemCloseTrove",
            "impact": "Low",
            "line": 3547,
            "line_end": 3555,
            "message": "TroveManager._redeemCloseTrove(address,uint256,uint256) (TroveManager.sol#3547-3555) has external calls inside a loop: activePool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3550)\n",
            "name": "calls-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_redeemCollateralFromTrove",
            "impact": "Low",
            "line": 3489,
            "line_end": 3538,
            "message": "TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538) has external calls inside a loop: sortedTroves.reInsert(_borrower,newICR,_price,_partialRedemptionHint,_partialRedemptionHint) (TroveManager.sol#3525)\n",
            "name": "calls-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_requireMoreThanOneTroveInSystem",
            "impact": "Low",
            "line": 4087,
            "line_end": 4089,
            "message": "TroveManager._requireMoreThanOneTroveInSystem(uint256) (TroveManager.sol#4087-4089) has external calls inside a loop: require(bool,string)(TroveOwnersArrayLength > 1 && sortedTroves.getSize() > 1,TroveManager: Only one trove in the system) (TroveManager.sol#4088)\n",
            "name": "calls-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_movePendingTroveRewardsToActivePool",
            "impact": "Low",
            "line": 3480,
            "line_end": 3484,
            "message": "TroveManager._movePendingTroveRewardsToActivePool(uint256,uint256) (TroveManager.sol#3480-3484) has external calls inside a loop: defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n",
            "name": "calls-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "redeemCollateral",
            "impact": "Low",
            "line": 3590,
            "line_end": 3665,
            "message": "TroveManager.redeemCollateral(uint256,address,address,uint256,uint256) (TroveManager.sol#3590-3665) has external calls inside a loop: nextUserToCheck = sortedTroves.getPrev(currentBorrower) (TroveManager.sol#3631)\n",
            "name": "calls-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "liquidateTroves",
            "impact": "Low",
            "line": 3156,
            "line_end": 3186,
            "message": "Reentrancy in TroveManager.liquidateTroves(uint256) (TroveManager.sol#3156-3186):\n\tExternal calls:\n\t- T = _getTotalsFromLiquidateTrovesSequence_RecoveryMode(L.price,L.LUSDInStabPool,_n) (TroveManager.sol#3167)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- T = _getTotalsFromLiquidateTrovesSequence_NormalMode(L.price,L.LUSDInStabPool,_n) (TroveManager.sol#3169)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- stabilityPool.offset(T.totalDebtToOffset,T.totalCollToSendToSP) (TroveManager.sol#3173)\n\t- _redistributeDebtAndColl(T.totalDebtToRedistribute,T.totalCollToRedistribute) (TroveManager.sol#3174)\n\t\t- activePool.decreaseLUSDDebt(_debt) (TroveManager.sol#3859)\n\t\t- defaultPool.increaseLUSDDebt(_debt) (TroveManager.sol#3860)\n\t\t- activePool.sendETH(address(defaultPool),_coll) (TroveManager.sol#3861)\n\tState variables written after the call(s):\n\t- _updateSystemSnapshots_excludeCollRemainder(T.partialNewColl.add(T.totalCollGasCompensation)) (TroveManager.sol#3177)\n\t\t- totalCollateralSnapshot = activeColl.sub(_collRemainder).add(liquidatedColl) (TroveManager.sol#3905)\n\t- _updateSystemSnapshots_excludeCollRemainder(T.partialNewColl.add(T.totalCollGasCompensation)) (TroveManager.sol#3177)\n\t\t- totalStakesSnapshot = totalStakes (TroveManager.sol#3901)\n",
            "name": "reentrancy-benign",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "redeemCollateral",
            "impact": "Low",
            "line": 3590,
            "line_end": 3665,
            "message": "Reentrancy in TroveManager.redeemCollateral(uint256,address,address,uint256,uint256) (TroveManager.sol#3590-3665):\n\tExternal calls:\n\t- _applyPendingRewards(currentBorrower) (TroveManager.sol#3633)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t- V = _redeemCollateralFromTrove(currentBorrower,remainingLUSD,price,_partialRedemptionHint,_partialRedemptionHintICR) (TroveManager.sol#3634-3640)\n\t\t- lusdToken.burn(GAS_POOL_ADDRESS,_LUSD) (TroveManager.sol#3548)\n\t\t- activePool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3550)\n\t\t- collSurplusPool.accountSurplus(_borrower,_ETH) (TroveManager.sol#3553)\n\t\t- activePool.sendETH(address(collSurplusPool),_ETH) (TroveManager.sol#3554)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t\t- sortedTroves.reInsert(_borrower,newICR,_price,_partialRedemptionHint,_partialRedemptionHint) (TroveManager.sol#3525)\n\tState variables written after the call(s):\n\t- _updateBaseRateFromRedemption(T.totalETHDrawn,price) (TroveManager.sol#3652)\n\t\t- baseRate = newBaseRate (TroveManager.sol#4023)\n\t\t- baseRate = 1e18 (TroveManager.sol#4023)\n\t- _updateBaseRateFromRedemption(T.totalETHDrawn,price) (TroveManager.sol#3652)\n\t\t- lastFeeOperationTime = block.timestamp (TroveManager.sol#4058)\n",
            "name": "reentrancy-benign",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "batchLiquidateTroves",
            "impact": "Low",
            "line": 3291,
            "line_end": 3322,
            "message": "Reentrancy in TroveManager.batchLiquidateTroves(address[]) (TroveManager.sol#3291-3322):\n\tExternal calls:\n\t- T = _getTotalFromBatchLiquidate_RecoveryMode(L.price,L.LUSDInStabPool,_troveArray) (TroveManager.sol#3303)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- T = _getTotalsFromBatchLiquidate_NormalMode(L.price,L.LUSDInStabPool,_troveArray) (TroveManager.sol#3305)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- stabilityPool.offset(T.totalDebtToOffset,T.totalCollToSendToSP) (TroveManager.sol#3309)\n\t- _redistributeDebtAndColl(T.totalDebtToRedistribute,T.totalCollToRedistribute) (TroveManager.sol#3310)\n\t\t- activePool.decreaseLUSDDebt(_debt) (TroveManager.sol#3859)\n\t\t- defaultPool.increaseLUSDDebt(_debt) (TroveManager.sol#3860)\n\t\t- activePool.sendETH(address(defaultPool),_coll) (TroveManager.sol#3861)\n\tState variables written after the call(s):\n\t- _updateSystemSnapshots_excludeCollRemainder(T.partialNewColl.add(T.totalCollGasCompensation)) (TroveManager.sol#3313)\n\t\t- totalCollateralSnapshot = activeColl.sub(_collRemainder).add(liquidatedColl) (TroveManager.sol#3905)\n\t- _updateSystemSnapshots_excludeCollRemainder(T.partialNewColl.add(T.totalCollGasCompensation)) (TroveManager.sol#3313)\n\t\t- totalStakesSnapshot = totalStakes (TroveManager.sol#3901)\n",
            "name": "reentrancy-benign",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_liquidateRecoveryMode",
            "impact": "Low",
            "line": 2990,
            "line_end": 3050,
            "message": "Reentrancy in TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050):\n\tExternal calls:\n\t- _movePendingTroveRewardsToActivePool(L.pendingDebtReward,L.pendingCollReward) (TroveManager.sol#3000)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\tState variables written after the call(s):\n\t- _removeStake(_borrower) (TroveManager.sol#3009)\n\t\t- totalStakes = totalStakes.sub(stake) (TroveManager.sol#3799)\n\t- _removeStake(_borrower) (TroveManager.sol#3021)\n\t\t- totalStakes = totalStakes.sub(stake) (TroveManager.sol#3799)\n\t- _removeStake(_borrower) (TroveManager.sol#3038)\n\t\t- totalStakes = totalStakes.sub(stake) (TroveManager.sol#3799)\n",
            "name": "reentrancy-benign",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_liquidateNormalMode",
            "impact": "Low",
            "line": 2963,
            "line_end": 2987,
            "message": "Reentrancy in TroveManager._liquidateNormalMode(address,uint256) (TroveManager.sol#2963-2987):\n\tExternal calls:\n\t- _movePendingTroveRewardsToActivePool(L.pendingDebtReward,L.pendingCollReward) (TroveManager.sol#2971)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\tState variables written after the call(s):\n\t- _removeStake(_borrower) (TroveManager.sol#2972)\n\t\t- totalStakes = totalStakes.sub(stake) (TroveManager.sol#3799)\n",
            "name": "reentrancy-benign",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_updatePartiallyLiquidatedTrove",
            "impact": "Low",
            "line": 3436,
            "line_end": 3467,
            "message": "Reentrancy in TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467):\n\tExternal calls:\n\t- sortedTroves.insert(_borrower,ICR,_price,_upperHint,_lowerHint) (TroveManager.sol#3464)\n\tState variables written after the call(s):\n\t- _addTroveOwnerToArray(_borrower) (TroveManager.sol#3465)\n\t\t- TroveOwners.push(_borrower) (TroveManager.sol#3918)\n",
            "name": "reentrancy-benign",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_redeemCollateralFromTrove",
            "impact": "Low",
            "line": 3489,
            "line_end": 3538,
            "message": "Reentrancy in TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538):\n\tExternal calls:\n\t- sortedTroves.reInsert(_borrower,newICR,_price,_partialRedemptionHint,_partialRedemptionHint) (TroveManager.sol#3525)\n\tState variables written after the call(s):\n\t- _updateStakeAndTotalStakes(_borrower) (TroveManager.sol#3529)\n\t\t- totalStakes = totalStakes.sub(oldStake).add(newStake) (TroveManager.sol#3813)\n",
            "name": "reentrancy-benign",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "batchLiquidateTroves",
            "impact": "Low",
            "line": 3291,
            "line_end": 3322,
            "message": "Reentrancy in TroveManager.batchLiquidateTroves(address[]) (TroveManager.sol#3291-3322):\n\tExternal calls:\n\t- T = _getTotalFromBatchLiquidate_RecoveryMode(L.price,L.LUSDInStabPool,_troveArray) (TroveManager.sol#3303)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- T = _getTotalsFromBatchLiquidate_NormalMode(L.price,L.LUSDInStabPool,_troveArray) (TroveManager.sol#3305)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- stabilityPool.offset(T.totalDebtToOffset,T.totalCollToSendToSP) (TroveManager.sol#3309)\n\t- _redistributeDebtAndColl(T.totalDebtToRedistribute,T.totalCollToRedistribute) (TroveManager.sol#3310)\n\t\t- activePool.decreaseLUSDDebt(_debt) (TroveManager.sol#3859)\n\t\t- defaultPool.increaseLUSDDebt(_debt) (TroveManager.sol#3860)\n\t\t- activePool.sendETH(address(defaultPool),_coll) (TroveManager.sol#3861)\n\t- _updatePartiallyLiquidatedTrove(T.partialAddr,T.partialNewDebt,T.partialNewColl,T.partialUpperHint,T.partialLowerHint,L.price) (TroveManager.sol#3314)\n\t\t- sortedTroves.insert(_borrower,ICR,_price,_upperHint,_lowerHint) (TroveManager.sol#3464)\n\tEvent emitted after the call(s):\n\t- Liquidation(L.liquidatedDebt,L.liquidatedColl,T.totalCollGasCompensation,T.totalLUSDGasCompensation) (TroveManager.sol#3318)\n\t- TroveUpdated(_borrower,_newDebt,_newColl,Troves[_borrower].stake,TroveManagerOperation.partiallyLiquidateInRecoveryMode) (TroveManager.sol#3466)\n\t\t- _updatePartiallyLiquidatedTrove(T.partialAddr,T.partialNewDebt,T.partialNewColl,T.partialUpperHint,T.partialLowerHint,L.price) (TroveManager.sol#3314)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_liquidateRecoveryMode",
            "impact": "Low",
            "line": 2990,
            "line_end": 3050,
            "message": "Reentrancy in TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050):\n\tExternal calls:\n\t- _movePendingTroveRewardsToActivePool(L.pendingDebtReward,L.pendingCollReward) (TroveManager.sol#3000)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\tEvent emitted after the call(s):\n\t- TroveLiquidated(_borrower,_entireTroveDebt,_entireTroveColl,TroveManagerOperation.liquidateInRecoveryMode) (TroveManager.sol#3116)\n\t\t- V = _getFullOrPartialOffsetVals(_borrower,V.entireTroveDebt,V.entireTroveColl,_LUSDInStabPool) (TroveManager.sol#3040)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_liquidateNormalMode",
            "impact": "Low",
            "line": 2963,
            "line_end": 2987,
            "message": "Reentrancy in TroveManager._liquidateNormalMode(address,uint256) (TroveManager.sol#2963-2987):\n\tExternal calls:\n\t- _movePendingTroveRewardsToActivePool(L.pendingDebtReward,L.pendingCollReward) (TroveManager.sol#2971)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t- _closeTrove(_borrower) (TroveManager.sol#2983)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\tEvent emitted after the call(s):\n\t- TroveLiquidated(_borrower,V.entireTroveDebt,V.entireTroveColl,TroveManagerOperation.liquidateInNormalMode) (TroveManager.sol#2984)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_applyPendingRewards",
            "impact": "Low",
            "line": 3697,
            "line_end": 3722,
            "message": "Reentrancy in TroveManager._applyPendingRewards(address) (TroveManager.sol#3697-3722):\n\tExternal calls:\n\t- _movePendingTroveRewardsToActivePool(pendingLUSDDebtReward,pendingETHReward) (TroveManager.sol#3712)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\tEvent emitted after the call(s):\n\t- TroveUpdated(_borrower,Troves[_borrower].debt,Troves[_borrower].coll,Troves[_borrower].stake,TroveManagerOperation.applyPendingRewards) (TroveManager.sol#3714-3720)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_getTotalFromBatchLiquidate_RecoveryMode",
            "impact": "Low",
            "line": 3328,
            "line_end": 3380,
            "message": "Reentrancy in TroveManager._getTotalFromBatchLiquidate_RecoveryMode(uint256,uint256,address[]) (TroveManager.sol#3328-3380):\n\tExternal calls:\n\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3356)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- V = _liquidateNormalMode(L.user,L.remainingLUSDInStabPool) (TroveManager.sol#3373)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\tEvent emitted after the call(s):\n\t- TroveLiquidated(_borrower,V.entireTroveDebt,V.entireTroveColl,TroveManagerOperation.liquidateInNormalMode) (TroveManager.sol#2984)\n\t\t- V = _liquidateNormalMode(L.user,L.remainingLUSDInStabPool) (TroveManager.sol#3373)\n\t- TroveLiquidated(_borrower,_entireTroveDebt,_entireTroveColl,TroveManagerOperation.liquidateInRecoveryMode) (TroveManager.sol#3116)\n\t\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3356)\n\t- TroveLiquidated(_borrower,V.entireTroveDebt,V.entireTroveColl,TroveManagerOperation.liquidateInRecoveryMode) (TroveManager.sol#3017)\n\t\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3356)\n\t- TroveLiquidated(_borrower,V.entireTroveDebt,V.entireTroveColl,TroveManagerOperation.liquidateInRecoveryMode) (TroveManager.sol#3029)\n\t\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3356)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "redeemCollateral",
            "impact": "Low",
            "line": 3590,
            "line_end": 3665,
            "message": "Reentrancy in TroveManager.redeemCollateral(uint256,address,address,uint256,uint256) (TroveManager.sol#3590-3665):\n\tExternal calls:\n\t- _applyPendingRewards(currentBorrower) (TroveManager.sol#3633)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t- V = _redeemCollateralFromTrove(currentBorrower,remainingLUSD,price,_partialRedemptionHint,_partialRedemptionHintICR) (TroveManager.sol#3634-3640)\n\t\t- lusdToken.burn(GAS_POOL_ADDRESS,_LUSD) (TroveManager.sol#3548)\n\t\t- activePool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3550)\n\t\t- collSurplusPool.accountSurplus(_borrower,_ETH) (TroveManager.sol#3553)\n\t\t- activePool.sendETH(address(collSurplusPool),_ETH) (TroveManager.sol#3554)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t\t- sortedTroves.reInsert(_borrower,newICR,_price,_partialRedemptionHint,_partialRedemptionHint) (TroveManager.sol#3525)\n\tEvent emitted after the call(s):\n\t- TroveUpdated(_borrower,Troves[_borrower].debt,Troves[_borrower].coll,Troves[_borrower].stake,TroveManagerOperation.applyPendingRewards) (TroveManager.sol#3714-3720)\n\t\t- _applyPendingRewards(currentBorrower) (TroveManager.sol#3633)\n\t- TroveUpdated(_borrower,newDebt,newColl,Troves[_borrower].stake,TroveManagerOperation.redeemCollateral) (TroveManager.sol#3531-3536)\n\t\t- V = _redeemCollateralFromTrove(currentBorrower,remainingLUSD,price,_partialRedemptionHint,_partialRedemptionHintICR) (TroveManager.sol#3634-3640)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_updatePartiallyLiquidatedTrove",
            "impact": "Low",
            "line": 3436,
            "line_end": 3467,
            "message": "Reentrancy in TroveManager._updatePartiallyLiquidatedTrove(address,uint256,uint256,address,address,uint256) (TroveManager.sol#3436-3467):\n\tExternal calls:\n\t- sortedTroves.insert(_borrower,ICR,_price,_upperHint,_lowerHint) (TroveManager.sol#3464)\n\tEvent emitted after the call(s):\n\t- TroveUpdated(_borrower,_newDebt,_newColl,Troves[_borrower].stake,TroveManagerOperation.partiallyLiquidateInRecoveryMode) (TroveManager.sol#3466)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "redeemCollateral",
            "impact": "Low",
            "line": 3590,
            "line_end": 3665,
            "message": "Reentrancy in TroveManager.redeemCollateral(uint256,address,address,uint256,uint256) (TroveManager.sol#3590-3665):\n\tExternal calls:\n\t- _applyPendingRewards(currentBorrower) (TroveManager.sol#3633)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t- V = _redeemCollateralFromTrove(currentBorrower,remainingLUSD,price,_partialRedemptionHint,_partialRedemptionHintICR) (TroveManager.sol#3634-3640)\n\t\t- lusdToken.burn(GAS_POOL_ADDRESS,_LUSD) (TroveManager.sol#3548)\n\t\t- activePool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3550)\n\t\t- collSurplusPool.accountSurplus(_borrower,_ETH) (TroveManager.sol#3553)\n\t\t- activePool.sendETH(address(collSurplusPool),_ETH) (TroveManager.sol#3554)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t\t- sortedTroves.reInsert(_borrower,newICR,_price,_partialRedemptionHint,_partialRedemptionHint) (TroveManager.sol#3525)\n\t- activePool.sendETH(lqtyStakingAddress,T.ETHFee) (TroveManager.sol#3656)\n\t- lqtyStaking.increaseF_ETH(T.ETHFee) (TroveManager.sol#3657)\n\t- _activePoolRedeemCollateral(msg.sender,T.totalLUSDToRedeem,T.ETHToSendToRedeemer) (TroveManager.sol#3662)\n\t\t- lusdToken.burn(_redeemer,_LUSD) (TroveManager.sol#3670)\n\t\t- activePool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3671)\n\t\t- activePool.sendETH(_redeemer,_ETH) (TroveManager.sol#3673)\n\tEvent emitted after the call(s):\n\t- Redemption(_LUSDamount,T.totalLUSDToRedeem,T.totalETHDrawn,T.ETHFee) (TroveManager.sol#3664)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_getTotalsFromLiquidateTrovesSequence_RecoveryMode",
            "impact": "Low",
            "line": 3192,
            "line_end": 3250,
            "message": "Reentrancy in TroveManager._getTotalsFromLiquidateTrovesSequence_RecoveryMode(uint256,uint256,uint256) (TroveManager.sol#3192-3250):\n\tExternal calls:\n\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3220)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- V = _liquidateNormalMode(L.user,L.remainingLUSDInStabPool) (TroveManager.sol#3236)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\tEvent emitted after the call(s):\n\t- TroveLiquidated(_borrower,_entireTroveDebt,_entireTroveColl,TroveManagerOperation.liquidateInRecoveryMode) (TroveManager.sol#3116)\n\t\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3220)\n\t- TroveLiquidated(_borrower,V.entireTroveDebt,V.entireTroveColl,TroveManagerOperation.liquidateInNormalMode) (TroveManager.sol#2984)\n\t\t- V = _liquidateNormalMode(L.user,L.remainingLUSDInStabPool) (TroveManager.sol#3236)\n\t- TroveLiquidated(_borrower,V.entireTroveDebt,V.entireTroveColl,TroveManagerOperation.liquidateInRecoveryMode) (TroveManager.sol#3017)\n\t\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3220)\n\t- TroveLiquidated(_borrower,V.entireTroveDebt,V.entireTroveColl,TroveManagerOperation.liquidateInRecoveryMode) (TroveManager.sol#3029)\n\t\t- V = _liquidateRecoveryMode(L.user,L.ICR,L.remainingLUSDInStabPool,TCR) (TroveManager.sol#3220)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "liquidateTroves",
            "impact": "Low",
            "line": 3156,
            "line_end": 3186,
            "message": "Reentrancy in TroveManager.liquidateTroves(uint256) (TroveManager.sol#3156-3186):\n\tExternal calls:\n\t- T = _getTotalsFromLiquidateTrovesSequence_RecoveryMode(L.price,L.LUSDInStabPool,_n) (TroveManager.sol#3167)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- T = _getTotalsFromLiquidateTrovesSequence_NormalMode(L.price,L.LUSDInStabPool,_n) (TroveManager.sol#3169)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- stabilityPool.offset(T.totalDebtToOffset,T.totalCollToSendToSP) (TroveManager.sol#3173)\n\t- _redistributeDebtAndColl(T.totalDebtToRedistribute,T.totalCollToRedistribute) (TroveManager.sol#3174)\n\t\t- activePool.decreaseLUSDDebt(_debt) (TroveManager.sol#3859)\n\t\t- defaultPool.increaseLUSDDebt(_debt) (TroveManager.sol#3860)\n\t\t- activePool.sendETH(address(defaultPool),_coll) (TroveManager.sol#3861)\n\t- _updatePartiallyLiquidatedTrove(T.partialAddr,T.partialNewDebt,T.partialNewColl,T.partialUpperHint,T.partialLowerHint,L.price) (TroveManager.sol#3178)\n\t\t- sortedTroves.insert(_borrower,ICR,_price,_upperHint,_lowerHint) (TroveManager.sol#3464)\n\tEvent emitted after the call(s):\n\t- Liquidation(L.liquidatedDebt,L.liquidatedColl,T.totalCollGasCompensation,T.totalLUSDGasCompensation) (TroveManager.sol#3182)\n\t- TroveUpdated(_borrower,_newDebt,_newColl,Troves[_borrower].stake,TroveManagerOperation.partiallyLiquidateInRecoveryMode) (TroveManager.sol#3466)\n\t\t- _updatePartiallyLiquidatedTrove(T.partialAddr,T.partialNewDebt,T.partialNewColl,T.partialUpperHint,T.partialLowerHint,L.price) (TroveManager.sol#3178)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_liquidateRecoveryMode",
            "impact": "Low",
            "line": 2990,
            "line_end": 3050,
            "message": "Reentrancy in TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050):\n\tExternal calls:\n\t- _movePendingTroveRewardsToActivePool(L.pendingDebtReward,L.pendingCollReward) (TroveManager.sol#3000)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t- _closeTrove(_borrower) (TroveManager.sol#3028)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\tEvent emitted after the call(s):\n\t- TroveLiquidated(_borrower,V.entireTroveDebt,V.entireTroveColl,TroveManagerOperation.liquidateInRecoveryMode) (TroveManager.sol#3029)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_liquidateRecoveryMode",
            "impact": "Low",
            "line": 2990,
            "line_end": 3050,
            "message": "Reentrancy in TroveManager._liquidateRecoveryMode(address,uint256,uint256,uint256) (TroveManager.sol#2990-3050):\n\tExternal calls:\n\t- _movePendingTroveRewardsToActivePool(L.pendingDebtReward,L.pendingCollReward) (TroveManager.sol#3000)\n\t\t- defaultPool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3481)\n\t\t- activePool.increaseLUSDDebt(_LUSD) (TroveManager.sol#3482)\n\t\t- defaultPool.sendETH(address(activePool),_ETH) (TroveManager.sol#3483)\n\t- _closeTrove(_borrower) (TroveManager.sol#3016)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\tEvent emitted after the call(s):\n\t- TroveLiquidated(_borrower,V.entireTroveDebt,V.entireTroveColl,TroveManagerOperation.liquidateInRecoveryMode) (TroveManager.sol#3017)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_redeemCollateralFromTrove",
            "impact": "Low",
            "line": 3489,
            "line_end": 3538,
            "message": "Reentrancy in TroveManager._redeemCollateralFromTrove(address,uint256,uint256,address,uint256) (TroveManager.sol#3489-3538):\n\tExternal calls:\n\t- _closeTrove(_borrower) (TroveManager.sol#3511)\n\t\t- sortedTroves.remove(_borrower) (TroveManager.sol#3881)\n\t- _redeemCloseTrove(_borrower,LUSD_GAS_COMPENSATION,newColl) (TroveManager.sol#3512)\n\t\t- lusdToken.burn(GAS_POOL_ADDRESS,_LUSD) (TroveManager.sol#3548)\n\t\t- activePool.decreaseLUSDDebt(_LUSD) (TroveManager.sol#3550)\n\t\t- collSurplusPool.accountSurplus(_borrower,_ETH) (TroveManager.sol#3553)\n\t\t- activePool.sendETH(address(collSurplusPool),_ETH) (TroveManager.sol#3554)\n\t- sortedTroves.reInsert(_borrower,newICR,_price,_partialRedemptionHint,_partialRedemptionHint) (TroveManager.sol#3525)\n\tEvent emitted after the call(s):\n\t- TroveUpdated(_borrower,newDebt,newColl,Troves[_borrower].stake,TroveManagerOperation.redeemCollateral) (TroveManager.sol#3531-3536)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_updateBaseRateFromRedemption",
            "impact": "Low",
            "line": 4009,
            "line_end": 4029,
            "message": "TroveManager._updateBaseRateFromRedemption(uint256,uint256) (TroveManager.sol#4009-4029) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- assert(bool)(baseRate <= 1e18 && baseRate > 0) (TroveManager.sol#4024)\n\t- newBaseRate < 1e18 (TroveManager.sol#4023)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "decayBaseRateFromBorrowing",
            "impact": "Low",
            "line": 4042,
            "line_end": 4049,
            "message": "TroveManager.decayBaseRateFromBorrowing() (TroveManager.sol#4042-4049) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- assert(bool)(baseRate <= 1e18) (TroveManager.sol#4046)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_updateLastFeeOpTime",
            "impact": "Low",
            "line": 4054,
            "line_end": 4060,
            "message": "TroveManager._updateLastFeeOpTime() (TroveManager.sol#4054-4060) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- timePassed >= SECONDS_IN_ONE_MINUTE (TroveManager.sol#4057)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_removeStake",
            "impact": "Informational",
            "line": 3797,
            "line_end": 3801,
            "message": "TroveManager._removeStake(address) (TroveManager.sol#3797-3801) has costly operations inside a loop:\n\t- totalStakes = totalStakes.sub(stake) (TroveManager.sol#3799)\n",
            "name": "costly-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_removeTroveOwner",
            "impact": "Informational",
            "line": 3931,
            "line_end": 3945,
            "message": "TroveManager._removeTroveOwner(address,uint256) (TroveManager.sol#3931-3945) has costly operations inside a loop:\n\t- TroveOwners.pop() (TroveManager.sol#3944)\n",
            "name": "costly-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TroveManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-Liquity/dev-f0df3efa5a5f05b205752184cfce107c5bd6e06c/packages/contracts/contracts/TroveManager.sol",
            "function": "_updateStakeAndTotalStakes",
            "impact": "Informational",
            "line": 3809,
            "line_end": 3816,
            "message": "TroveManager._updateStakeAndTotalStakes(address) (TroveManager.sol#3809-3816) has costly operations inside a loop:\n\t- totalStakes = totalStakes.sub(oldStake).add(newStake) (TroveManager.sol#3813)\n",
            "name": "costly-loop",
            "check": "FP"
        }
    ],
    "infos": [],
    "parser": {
        "id": "slither-0.10.0",
        "mode": "solidity",
        "version": "2024/04/30"
    }
}