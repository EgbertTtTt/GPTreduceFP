{
    "errors": [],
    "fails": [],
    "findings": [
        {
            "confidence": "Medium",
            "contract": "FundingRateApplier",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "proposeNewRate",
            "impact": "High",
            "line": 3343,
            "line_end": 3392,
            "message": "Reentrancy in FundingRateApplier.proposeNewRate(FixedPoint.Signed,uint256) (PerpetualPositionManager.sol#3343-3392):\n\tExternal calls:\n\t- fees() (PerpetualPositionManager.sol#3345)\n\t\t- returndata = address(token).functionCall(data,SafeERC20: low-level call failed) (PerpetualPositionManager.sol#537)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t\t- price = optimisticOracle.getPrice(identifier,proposalTime,ancillaryData) (PerpetualPositionManager.sol#3422-3455)\n\t\t- collateralCurrency.safeTransfer(request.proposer,reward.rawValue) (PerpetualPositionManager.sol#3440)\n\t\t- collateralCurrency.safeIncreaseAllowance(address(store),regularFee.rawValue) (PerpetualPositionManager.sol#1832)\n\t\t- store.payOracleFeesErc20(address(collateralCurrency),regularFee) (PerpetualPositionManager.sol#1833)\n\t\t- collateralCurrency.safeTransfer(msg.sender,latePenalty.rawValue) (PerpetualPositionManager.sol#1837)\n\tExternal calls sending eth:\n\t- fees() (PerpetualPositionManager.sol#3345)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\tState variables written after the call(s):\n\t- nonReentrant() (PerpetualPositionManager.sol#3346)\n\t\t- _notEntered = false (PerpetualPositionManager.sol#1537)\n\t\t- _notEntered = true (PerpetualPositionManager.sol#1543)\n\tLockable._notEntered (PerpetualPositionManager.sol#1492) can be used in cross function reentrancies:\n\t- Lockable._preEntranceCheck() (PerpetualPositionManager.sol#1530-1533)\n\t- fundingRate.proposalTime = timestamp (PerpetualPositionManager.sol#3361)\n\tFundingRateApplier.fundingRate (PerpetualPositionManager.sol#3257) can be used in cross function reentrancies:\n\t- FundingRateApplier.constructor(bytes32,address,address,address,FixedPoint.Unsigned,address) (PerpetualPositionManager.sol#3303-3322)\n\t- FundingRateApplier.fundingRate (PerpetualPositionManager.sol#3257)\n",
            "name": "reentrancy-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "PerpetualPositionManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "redeem",
            "impact": "High",
            "line": 3895,
            "line_end": 3932,
            "message": "Reentrancy in PerpetualPositionManager.redeem(FixedPoint.Unsigned) (PerpetualPositionManager.sol#3895-3932):\n\tExternal calls:\n\t- fees() (PerpetualPositionManager.sol#3899)\n\t\t- returndata = address(token).functionCall(data,SafeERC20: low-level call failed) (PerpetualPositionManager.sol#537)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t\t- price = optimisticOracle.getPrice(identifier,proposalTime,ancillaryData) (PerpetualPositionManager.sol#3422-3455)\n\t\t- collateralCurrency.safeTransfer(request.proposer,reward.rawValue) (PerpetualPositionManager.sol#3440)\n\t\t- collateralCurrency.safeIncreaseAllowance(address(store),regularFee.rawValue) (PerpetualPositionManager.sol#1832)\n\t\t- store.payOracleFeesErc20(address(collateralCurrency),regularFee) (PerpetualPositionManager.sol#1833)\n\t\t- collateralCurrency.safeTransfer(msg.sender,latePenalty.rawValue) (PerpetualPositionManager.sol#1837)\n\tExternal calls sending eth:\n\t- fees() (PerpetualPositionManager.sol#3899)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\tState variables written after the call(s):\n\t- nonReentrant() (PerpetualPositionManager.sol#3900)\n\t\t- _notEntered = false (PerpetualPositionManager.sol#1537)\n\t\t- _notEntered = true (PerpetualPositionManager.sol#1543)\n\tLockable._notEntered (PerpetualPositionManager.sol#1492) can be used in cross function reentrancies:\n\t- Lockable._postEntranceReset() (PerpetualPositionManager.sol#1540-1544)\n\t- Lockable._preEntranceCheck() (PerpetualPositionManager.sol#1530-1533)\n\t- Lockable._preEntranceSet() (PerpetualPositionManager.sol#1535-1538)\n\t- amountWithdrawn = _deleteSponsorPosition(msg.sender) (PerpetualPositionManager.sol#3912)\n\t\t- delete positions[sponsor] (PerpetualPositionManager.sol#4138)\n\tPerpetualPositionManager.positions (PerpetualPositionManager.sol#3564) can be used in cross function reentrancies:\n\t- PerpetualPositionManager._deleteSponsorPosition(address) (PerpetualPositionManager.sol#4128-4144)\n\t- PerpetualPositionManager._getPositionData(address) (PerpetualPositionManager.sol#4150-4157)\n\t- PerpetualPositionManager._onlyCollateralizedPosition(address) (PerpetualPositionManager.sol#4235-4240)\n\t- PerpetualPositionManager.getCollateral(address) (PerpetualPositionManager.sol#4055-4063)\n\t- PerpetualPositionManager.positions (PerpetualPositionManager.sol#3564)\n\t- amountWithdrawn = _deleteSponsorPosition(msg.sender) (PerpetualPositionManager.sol#3912)\n\t\t- rawTotalPositionCollateral = rawTotalPositionCollateral.sub(positionToLiquidate.rawCollateral) (PerpetualPositionManager.sol#4134)\n\tPerpetualPositionManager.rawTotalPositionCollateral (PerpetualPositionManager.sol#3572) can be used in cross function reentrancies:\n\t- PerpetualPositionManager._decrementCollateralBalances(PerpetualPositionManager.PositionData,FixedPoint.Unsigned) (PerpetualPositionManager.sol#4212-4218)\n\t- PerpetualPositionManager._deleteSponsorPosition(address) (PerpetualPositionManager.sol#4128-4144)\n\t- PerpetualPositionManager._incrementCollateralBalances(PerpetualPositionManager.PositionData,FixedPoint.Unsigned) (PerpetualPositionManager.sol#4200-4206)\n\t- PerpetualPositionManager._pfc() (PerpetualPositionManager.sol#4146-4148)\n\t- PerpetualPositionManager.rawTotalPositionCollateral (PerpetualPositionManager.sol#3572)\n\t- PerpetualPositionManager.totalPositionCollateral() (PerpetualPositionManager.sol#4069-4076)\n",
            "name": "reentrancy-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "PerpetualPositionManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "create",
            "impact": "High",
            "line": 3846,
            "line_end": 3884,
            "message": "Reentrancy in PerpetualPositionManager.create(FixedPoint.Unsigned,FixedPoint.Unsigned) (PerpetualPositionManager.sol#3846-3884):\n\tExternal calls:\n\t- fees() (PerpetualPositionManager.sol#3849)\n\t\t- returndata = address(token).functionCall(data,SafeERC20: low-level call failed) (PerpetualPositionManager.sol#537)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t\t- price = optimisticOracle.getPrice(identifier,proposalTime,ancillaryData) (PerpetualPositionManager.sol#3422-3455)\n\t\t- collateralCurrency.safeTransfer(request.proposer,reward.rawValue) (PerpetualPositionManager.sol#3440)\n\t\t- collateralCurrency.safeIncreaseAllowance(address(store),regularFee.rawValue) (PerpetualPositionManager.sol#1832)\n\t\t- store.payOracleFeesErc20(address(collateralCurrency),regularFee) (PerpetualPositionManager.sol#1833)\n\t\t- collateralCurrency.safeTransfer(msg.sender,latePenalty.rawValue) (PerpetualPositionManager.sol#1837)\n\tExternal calls sending eth:\n\t- fees() (PerpetualPositionManager.sol#3849)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\tState variables written after the call(s):\n\t- nonReentrant() (PerpetualPositionManager.sol#3850)\n\t\t- _notEntered = false (PerpetualPositionManager.sol#1537)\n\t\t- _notEntered = true (PerpetualPositionManager.sol#1543)\n\tLockable._notEntered (PerpetualPositionManager.sol#1492) can be used in cross function reentrancies:\n\t- Lockable._postEntranceReset() (PerpetualPositionManager.sol#1540-1544)\n\t- Lockable._preEntranceCheck() (PerpetualPositionManager.sol#1530-1533)\n\t- Lockable._preEntranceSet() (PerpetualPositionManager.sol#1535-1538)\n",
            "name": "reentrancy-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "PerpetualPositionManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "settleEmergencyShutdown",
            "impact": "High",
            "line": 3956,
            "line_end": 4012,
            "message": "Reentrancy in PerpetualPositionManager.settleEmergencyShutdown() (PerpetualPositionManager.sol#3956-4012):\n\tExternal calls:\n\t- fees() (PerpetualPositionManager.sol#3959)\n\t\t- returndata = address(token).functionCall(data,SafeERC20: low-level call failed) (PerpetualPositionManager.sol#537)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t\t- price = optimisticOracle.getPrice(identifier,proposalTime,ancillaryData) (PerpetualPositionManager.sol#3422-3455)\n\t\t- collateralCurrency.safeTransfer(request.proposer,reward.rawValue) (PerpetualPositionManager.sol#3440)\n\t\t- collateralCurrency.safeIncreaseAllowance(address(store),regularFee.rawValue) (PerpetualPositionManager.sol#1832)\n\t\t- store.payOracleFeesErc20(address(collateralCurrency),regularFee) (PerpetualPositionManager.sol#1833)\n\t\t- collateralCurrency.safeTransfer(msg.sender,latePenalty.rawValue) (PerpetualPositionManager.sol#1837)\n\tExternal calls sending eth:\n\t- fees() (PerpetualPositionManager.sol#3959)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\tState variables written after the call(s):\n\t- nonReentrant() (PerpetualPositionManager.sol#3960)\n\t\t- _notEntered = false (PerpetualPositionManager.sol#1537)\n\t\t- _notEntered = true (PerpetualPositionManager.sol#1543)\n\tLockable._notEntered (PerpetualPositionManager.sol#1492) can be used in cross function reentrancies:\n\t- Lockable._postEntranceReset() (PerpetualPositionManager.sol#1540-1544)\n\t- Lockable._preEntranceCheck() (PerpetualPositionManager.sol#1530-1533)\n\t- Lockable._preEntranceSet() (PerpetualPositionManager.sol#1535-1538)\n",
            "name": "reentrancy-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "PerpetualPositionManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "withdrawPassedRequest",
            "impact": "High",
            "line": 3789,
            "line_end": 3820,
            "message": "Reentrancy in PerpetualPositionManager.withdrawPassedRequest() (PerpetualPositionManager.sol#3789-3820):\n\tExternal calls:\n\t- fees() (PerpetualPositionManager.sol#3792)\n\t\t- returndata = address(token).functionCall(data,SafeERC20: low-level call failed) (PerpetualPositionManager.sol#537)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t\t- price = optimisticOracle.getPrice(identifier,proposalTime,ancillaryData) (PerpetualPositionManager.sol#3422-3455)\n\t\t- collateralCurrency.safeTransfer(request.proposer,reward.rawValue) (PerpetualPositionManager.sol#3440)\n\t\t- collateralCurrency.safeIncreaseAllowance(address(store),regularFee.rawValue) (PerpetualPositionManager.sol#1832)\n\t\t- store.payOracleFeesErc20(address(collateralCurrency),regularFee) (PerpetualPositionManager.sol#1833)\n\t\t- collateralCurrency.safeTransfer(msg.sender,latePenalty.rawValue) (PerpetualPositionManager.sol#1837)\n\tExternal calls sending eth:\n\t- fees() (PerpetualPositionManager.sol#3792)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\tState variables written after the call(s):\n\t- nonReentrant() (PerpetualPositionManager.sol#3793)\n\t\t- _notEntered = false (PerpetualPositionManager.sol#1537)\n\t\t- _notEntered = true (PerpetualPositionManager.sol#1543)\n\tLockable._notEntered (PerpetualPositionManager.sol#1492) can be used in cross function reentrancies:\n\t- Lockable._postEntranceReset() (PerpetualPositionManager.sol#1540-1544)\n\t- Lockable._preEntranceCheck() (PerpetualPositionManager.sol#1530-1533)\n\t- Lockable._preEntranceSet() (PerpetualPositionManager.sol#1535-1538)\n",
            "name": "reentrancy-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FundingRateApplier",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "applyFundingRate",
            "impact": "High",
            "line": 3334,
            "line_end": 3336,
            "message": "Reentrancy in FundingRateApplier.applyFundingRate() (PerpetualPositionManager.sol#3334-3336):\n\tExternal calls:\n\t- _applyEffectiveFundingRate() (PerpetualPositionManager.sol#3335)\n\t\t- returndata = address(token).functionCall(data,SafeERC20: low-level call failed) (PerpetualPositionManager.sol#537)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t\t- price = optimisticOracle.getPrice(identifier,proposalTime,ancillaryData) (PerpetualPositionManager.sol#3422-3455)\n\t\t- collateralCurrency.safeTransfer(request.proposer,reward.rawValue) (PerpetualPositionManager.sol#3440)\n\t- regularFees() (PerpetualPositionManager.sol#3334)\n\t\t- returndata = address(token).functionCall(data,SafeERC20: low-level call failed) (PerpetualPositionManager.sol#537)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t\t- collateralCurrency.safeIncreaseAllowance(address(store),regularFee.rawValue) (PerpetualPositionManager.sol#1832)\n\t\t- store.payOracleFeesErc20(address(collateralCurrency),regularFee) (PerpetualPositionManager.sol#1833)\n\t\t- collateralCurrency.safeTransfer(msg.sender,latePenalty.rawValue) (PerpetualPositionManager.sol#1837)\n\tExternal calls sending eth:\n\t- _applyEffectiveFundingRate() (PerpetualPositionManager.sol#3335)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t- regularFees() (PerpetualPositionManager.sol#3334)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\tState variables written after the call(s):\n\t- _applyEffectiveFundingRate() (PerpetualPositionManager.sol#3335)\n\t\t- cumulativeFeeMultiplier = cumulativeFeeMultiplier.mul(FixedPoint.fromUnscaledUint(1).sub(effectiveFee)) (PerpetualPositionManager.sol#1954)\n\tFeePayer.cumulativeFeeMultiplier (PerpetualPositionManager.sol#1739) can be used in cross function reentrancies:\n\t- FeePayer.constructor(address,address,address) (PerpetualPositionManager.sol#1765-1774)\n\t- FeePayer.constructor(address,address,address) (PerpetualPositionManager.sol#1765-1774)\n\t- FeePayer.cumulativeFeeMultiplier (PerpetualPositionManager.sol#1739)\n",
            "name": "reentrancy-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "PerpetualPositionManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "depositTo",
            "impact": "High",
            "line": 3696,
            "line_end": 3713,
            "message": "Reentrancy in PerpetualPositionManager.depositTo(address,FixedPoint.Unsigned) (PerpetualPositionManager.sol#3696-3713):\n\tExternal calls:\n\t- fees() (PerpetualPositionManager.sol#3700)\n\t\t- returndata = address(token).functionCall(data,SafeERC20: low-level call failed) (PerpetualPositionManager.sol#537)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t\t- price = optimisticOracle.getPrice(identifier,proposalTime,ancillaryData) (PerpetualPositionManager.sol#3422-3455)\n\t\t- collateralCurrency.safeTransfer(request.proposer,reward.rawValue) (PerpetualPositionManager.sol#3440)\n\t\t- collateralCurrency.safeIncreaseAllowance(address(store),regularFee.rawValue) (PerpetualPositionManager.sol#1832)\n\t\t- store.payOracleFeesErc20(address(collateralCurrency),regularFee) (PerpetualPositionManager.sol#1833)\n\t\t- collateralCurrency.safeTransfer(msg.sender,latePenalty.rawValue) (PerpetualPositionManager.sol#1837)\n\tExternal calls sending eth:\n\t- fees() (PerpetualPositionManager.sol#3700)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\tState variables written after the call(s):\n\t- nonReentrant() (PerpetualPositionManager.sol#3701)\n\t\t- _notEntered = false (PerpetualPositionManager.sol#1537)\n\t\t- _notEntered = true (PerpetualPositionManager.sol#1543)\n\tLockable._notEntered (PerpetualPositionManager.sol#1492) can be used in cross function reentrancies:\n\t- Lockable._postEntranceReset() (PerpetualPositionManager.sol#1540-1544)\n\t- Lockable._preEntranceCheck() (PerpetualPositionManager.sol#1530-1533)\n\t- Lockable._preEntranceSet() (PerpetualPositionManager.sol#1535-1538)\n",
            "name": "reentrancy-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FundingRateApplier",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "applyFundingRate",
            "impact": "High",
            "line": 3334,
            "line_end": 3336,
            "message": "Reentrancy in FundingRateApplier.applyFundingRate() (PerpetualPositionManager.sol#3334-3336):\n\tExternal calls:\n\t- regularFees() (PerpetualPositionManager.sol#3334)\n\t\t- returndata = address(token).functionCall(data,SafeERC20: low-level call failed) (PerpetualPositionManager.sol#537)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t\t- collateralCurrency.safeIncreaseAllowance(address(store),regularFee.rawValue) (PerpetualPositionManager.sol#1832)\n\t\t- store.payOracleFeesErc20(address(collateralCurrency),regularFee) (PerpetualPositionManager.sol#1833)\n\t\t- collateralCurrency.safeTransfer(msg.sender,latePenalty.rawValue) (PerpetualPositionManager.sol#1837)\n\tExternal calls sending eth:\n\t- regularFees() (PerpetualPositionManager.sol#3334)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\tState variables written after the call(s):\n\t- nonReentrant() (PerpetualPositionManager.sol#3334)\n\t\t- _notEntered = false (PerpetualPositionManager.sol#1537)\n\t\t- _notEntered = true (PerpetualPositionManager.sol#1543)\n\tLockable._notEntered (PerpetualPositionManager.sol#1492) can be used in cross function reentrancies:\n\t- Lockable._preEntranceCheck() (PerpetualPositionManager.sol#1530-1533)\n",
            "name": "reentrancy-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FundingRateApplier",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "_applyEffectiveFundingRate",
            "impact": "High",
            "line": 3465,
            "line_end": 3493,
            "message": "Reentrancy in FundingRateApplier._applyEffectiveFundingRate() (PerpetualPositionManager.sol#3465-3493):\n\tExternal calls:\n\t- _latestFundingRatePerSecond = _getLatestFundingRate() (PerpetualPositionManager.sol#3474)\n\t\t- returndata = address(token).functionCall(data,SafeERC20: low-level call failed) (PerpetualPositionManager.sol#537)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t\t- price = optimisticOracle.getPrice(identifier,proposalTime,ancillaryData) (PerpetualPositionManager.sol#3422-3455)\n\t\t- collateralCurrency.safeTransfer(request.proposer,reward.rawValue) (PerpetualPositionManager.sol#3440)\n\t- (fundingRate.cumulativeMultiplier,periodRate) = _calculateEffectiveFundingRate(paymentPeriod,_getLatestFundingRate(),fundingRate.cumulativeMultiplier) (PerpetualPositionManager.sol#3477-3481)\n\t\t- returndata = address(token).functionCall(data,SafeERC20: low-level call failed) (PerpetualPositionManager.sol#537)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t\t- price = optimisticOracle.getPrice(identifier,proposalTime,ancillaryData) (PerpetualPositionManager.sol#3422-3455)\n\t\t- collateralCurrency.safeTransfer(request.proposer,reward.rawValue) (PerpetualPositionManager.sol#3440)\n\tExternal calls sending eth:\n\t- _latestFundingRatePerSecond = _getLatestFundingRate() (PerpetualPositionManager.sol#3474)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t- (fundingRate.cumulativeMultiplier,periodRate) = _calculateEffectiveFundingRate(paymentPeriod,_getLatestFundingRate(),fundingRate.cumulativeMultiplier) (PerpetualPositionManager.sol#3477-3481)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\tState variables written after the call(s):\n\t- (fundingRate.cumulativeMultiplier,periodRate) = _calculateEffectiveFundingRate(paymentPeriod,_getLatestFundingRate(),fundingRate.cumulativeMultiplier) (PerpetualPositionManager.sol#3477-3481)\n\t\t- cumulativeFeeMultiplier = cumulativeFeeMultiplier.mul(FixedPoint.fromUnscaledUint(1).sub(effectiveFee)) (PerpetualPositionManager.sol#1954)\n\tFeePayer.cumulativeFeeMultiplier (PerpetualPositionManager.sol#1739) can be used in cross function reentrancies:\n\t- FeePayer.constructor(address,address,address) (PerpetualPositionManager.sol#1765-1774)\n\t- FeePayer.constructor(address,address,address) (PerpetualPositionManager.sol#1765-1774)\n\t- FeePayer.cumulativeFeeMultiplier (PerpetualPositionManager.sol#1739)\n\t- (fundingRate.cumulativeMultiplier,periodRate) = _calculateEffectiveFundingRate(paymentPeriod,_getLatestFundingRate(),fundingRate.cumulativeMultiplier) (PerpetualPositionManager.sol#3477-3481)\n\t\t- fundingRate.rate = FixedPoint.Signed(price) (PerpetualPositionManager.sol#3431)\n\t\t- fundingRate.updateTime = proposalTime (PerpetualPositionManager.sol#3432)\n\t\t- fundingRate.proposalTime = 0 (PerpetualPositionManager.sol#3446)\n\t\t- fundingRate.proposalTime = 0 (PerpetualPositionManager.sol#3453)\n\tFundingRateApplier.fundingRate (PerpetualPositionManager.sol#3257) can be used in cross function reentrancies:\n\t- FundingRateApplier.constructor(bytes32,address,address,address,FixedPoint.Unsigned,address) (PerpetualPositionManager.sol#3303-3322)\n\t- FundingRateApplier.fundingRate (PerpetualPositionManager.sol#3257)\n\t- fundingRate.applicationTime = currentTime (PerpetualPositionManager.sol#3492)\n\tFundingRateApplier.fundingRate (PerpetualPositionManager.sol#3257) can be used in cross function reentrancies:\n\t- FundingRateApplier.constructor(bytes32,address,address,address,FixedPoint.Unsigned,address) (PerpetualPositionManager.sol#3303-3322)\n\t- FundingRateApplier.fundingRate (PerpetualPositionManager.sol#3257)\n",
            "name": "reentrancy-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "PerpetualPositionManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "withdraw",
            "impact": "High",
            "line": 3733,
            "line_end": 3755,
            "message": "Reentrancy in PerpetualPositionManager.withdraw(FixedPoint.Unsigned) (PerpetualPositionManager.sol#3733-3755):\n\tExternal calls:\n\t- fees() (PerpetualPositionManager.sol#3737)\n\t\t- returndata = address(token).functionCall(data,SafeERC20: low-level call failed) (PerpetualPositionManager.sol#537)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t\t- price = optimisticOracle.getPrice(identifier,proposalTime,ancillaryData) (PerpetualPositionManager.sol#3422-3455)\n\t\t- collateralCurrency.safeTransfer(request.proposer,reward.rawValue) (PerpetualPositionManager.sol#3440)\n\t\t- collateralCurrency.safeIncreaseAllowance(address(store),regularFee.rawValue) (PerpetualPositionManager.sol#1832)\n\t\t- store.payOracleFeesErc20(address(collateralCurrency),regularFee) (PerpetualPositionManager.sol#1833)\n\t\t- collateralCurrency.safeTransfer(msg.sender,latePenalty.rawValue) (PerpetualPositionManager.sol#1837)\n\tExternal calls sending eth:\n\t- fees() (PerpetualPositionManager.sol#3737)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\tState variables written after the call(s):\n\t- nonReentrant() (PerpetualPositionManager.sol#3738)\n\t\t- _notEntered = false (PerpetualPositionManager.sol#1537)\n\t\t- _notEntered = true (PerpetualPositionManager.sol#1543)\n\tLockable._notEntered (PerpetualPositionManager.sol#1492) can be used in cross function reentrancies:\n\t- Lockable._postEntranceReset() (PerpetualPositionManager.sol#1540-1544)\n\t- Lockable._preEntranceCheck() (PerpetualPositionManager.sol#1530-1533)\n\t- Lockable._preEntranceSet() (PerpetualPositionManager.sol#1535-1538)\n",
            "name": "reentrancy-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "PerpetualPositionManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "emergencyShutdown",
            "impact": "High",
            "line": 4025,
            "line_end": 4033,
            "message": "Reentrancy in PerpetualPositionManager.emergencyShutdown() (PerpetualPositionManager.sol#4025-4033):\n\tExternal calls:\n\t- fees() (PerpetualPositionManager.sol#4025)\n\t\t- returndata = address(token).functionCall(data,SafeERC20: low-level call failed) (PerpetualPositionManager.sol#537)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t\t- price = optimisticOracle.getPrice(identifier,proposalTime,ancillaryData) (PerpetualPositionManager.sol#3422-3455)\n\t\t- collateralCurrency.safeTransfer(request.proposer,reward.rawValue) (PerpetualPositionManager.sol#3440)\n\t\t- collateralCurrency.safeIncreaseAllowance(address(store),regularFee.rawValue) (PerpetualPositionManager.sol#1832)\n\t\t- store.payOracleFeesErc20(address(collateralCurrency),regularFee) (PerpetualPositionManager.sol#1833)\n\t\t- collateralCurrency.safeTransfer(msg.sender,latePenalty.rawValue) (PerpetualPositionManager.sol#1837)\n\tExternal calls sending eth:\n\t- fees() (PerpetualPositionManager.sol#4025)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\tState variables written after the call(s):\n\t- nonReentrant() (PerpetualPositionManager.sol#4025)\n\t\t- _notEntered = false (PerpetualPositionManager.sol#1537)\n\t\t- _notEntered = true (PerpetualPositionManager.sol#1543)\n\tLockable._notEntered (PerpetualPositionManager.sol#1492) can be used in cross function reentrancies:\n\t- Lockable._postEntranceReset() (PerpetualPositionManager.sol#1540-1544)\n\t- Lockable._preEntranceCheck() (PerpetualPositionManager.sol#1530-1533)\n\t- Lockable._preEntranceSet() (PerpetualPositionManager.sol#1535-1538)\n\t- emergencyShutdownTimestamp = getCurrentTime() (PerpetualPositionManager.sol#4029)\n\tFundingRateApplier.emergencyShutdownTimestamp (PerpetualPositionManager.sol#3260) can be used in cross function reentrancies:\n\t- FundingRateApplier._applyEffectiveFundingRate() (PerpetualPositionManager.sol#3465-3493)\n\t- PerpetualPositionManager._notEmergencyShutdown() (PerpetualPositionManager.sol#4242-4245)\n\t- FundingRateApplier.constructor(bytes32,address,address,address,FixedPoint.Unsigned,address) (PerpetualPositionManager.sol#3303-3322)\n\t- FundingRateApplier.constructor(bytes32,address,address,address,FixedPoint.Unsigned,address) (PerpetualPositionManager.sol#3303-3322)\n\t- FundingRateApplier.emergencyShutdownTimestamp (PerpetualPositionManager.sol#3260)\n",
            "name": "reentrancy-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FundingRateApplier",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "_getLatestFundingRate",
            "impact": "Medium",
            "line": 3413,
            "line_end": 3458,
            "message": "Reentrancy in FundingRateApplier._getLatestFundingRate() (PerpetualPositionManager.sol#3413-3458):\n\tExternal calls:\n\t- price = optimisticOracle.getPrice(identifier,proposalTime,ancillaryData) (PerpetualPositionManager.sol#3422-3455)\n\t- collateralCurrency.safeTransfer(request.proposer,reward.rawValue) (PerpetualPositionManager.sol#3440)\n\tState variables written after the call(s):\n\t- fundingRate.proposalTime = 0 (PerpetualPositionManager.sol#3446)\n\tFundingRateApplier.fundingRate (PerpetualPositionManager.sol#3257) can be used in cross function reentrancies:\n\t- FundingRateApplier.constructor(bytes32,address,address,address,FixedPoint.Unsigned,address) (PerpetualPositionManager.sol#3303-3322)\n\t- FundingRateApplier.fundingRate (PerpetualPositionManager.sol#3257)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FundingRateApplier",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "_getLatestFundingRate",
            "impact": "Medium",
            "line": 3413,
            "line_end": 3458,
            "message": "Reentrancy in FundingRateApplier._getLatestFundingRate() (PerpetualPositionManager.sol#3413-3458):\n\tExternal calls:\n\t- price = optimisticOracle.getPrice(identifier,proposalTime,ancillaryData) (PerpetualPositionManager.sol#3422-3455)\n\tState variables written after the call(s):\n\t- fundingRate.rate = FixedPoint.Signed(price) (PerpetualPositionManager.sol#3431)\n\tFundingRateApplier.fundingRate (PerpetualPositionManager.sol#3257) can be used in cross function reentrancies:\n\t- FundingRateApplier.constructor(bytes32,address,address,address,FixedPoint.Unsigned,address) (PerpetualPositionManager.sol#3303-3322)\n\t- FundingRateApplier.fundingRate (PerpetualPositionManager.sol#3257)\n\t- fundingRate.updateTime = proposalTime (PerpetualPositionManager.sol#3432)\n\tFundingRateApplier.fundingRate (PerpetualPositionManager.sol#3257) can be used in cross function reentrancies:\n\t- FundingRateApplier.constructor(bytes32,address,address,address,FixedPoint.Unsigned,address) (PerpetualPositionManager.sol#3303-3322)\n\t- FundingRateApplier.fundingRate (PerpetualPositionManager.sol#3257)\n\t- fundingRate.proposalTime = 0 (PerpetualPositionManager.sol#3453)\n\tFundingRateApplier.fundingRate (PerpetualPositionManager.sol#3257) can be used in cross function reentrancies:\n\t- FundingRateApplier.constructor(bytes32,address,address,address,FixedPoint.Unsigned,address) (PerpetualPositionManager.sol#3303-3322)\n\t- FundingRateApplier.fundingRate (PerpetualPositionManager.sol#3257)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FundingRateApplier",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "proposeNewRate",
            "impact": "Medium",
            "line": 3343,
            "line_end": 3392,
            "message": "FundingRateApplier.proposeNewRate(FixedPoint.Signed,uint256) (PerpetualPositionManager.sol#3343-3392) ignores return value by optimisticOracle.requestPrice(identifier,timestamp,ancillaryData,collateralCurrency,0) (PerpetualPositionManager.sol#3368)\n",
            "name": "unused-return",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FundingRateApplier",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "proposeNewRate",
            "impact": "Medium",
            "line": 3343,
            "line_end": 3392,
            "message": "FundingRateApplier.proposeNewRate(FixedPoint.Signed,uint256) (PerpetualPositionManager.sol#3343-3392) ignores return value by optimisticOracle.proposePriceFor(msg.sender,address(this),identifier,timestamp,ancillaryData,rate.rawValue) (PerpetualPositionManager.sol#3384-3391)\n",
            "name": "unused-return",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "PerpetualPositionManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "create",
            "impact": "Low",
            "line": 3846,
            "line_end": 3884,
            "message": "Reentrancy in PerpetualPositionManager.create(FixedPoint.Unsigned,FixedPoint.Unsigned) (PerpetualPositionManager.sol#3846-3884):\n\tExternal calls:\n\t- fees() (PerpetualPositionManager.sol#3849)\n\t\t- returndata = address(token).functionCall(data,SafeERC20: low-level call failed) (PerpetualPositionManager.sol#537)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t\t- price = optimisticOracle.getPrice(identifier,proposalTime,ancillaryData) (PerpetualPositionManager.sol#3422-3455)\n\t\t- collateralCurrency.safeTransfer(request.proposer,reward.rawValue) (PerpetualPositionManager.sol#3440)\n\t\t- collateralCurrency.safeIncreaseAllowance(address(store),regularFee.rawValue) (PerpetualPositionManager.sol#1832)\n\t\t- store.payOracleFeesErc20(address(collateralCurrency),regularFee) (PerpetualPositionManager.sol#1833)\n\t\t- collateralCurrency.safeTransfer(msg.sender,latePenalty.rawValue) (PerpetualPositionManager.sol#1837)\n\tExternal calls sending eth:\n\t- fees() (PerpetualPositionManager.sol#3849)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\tState variables written after the call(s):\n\t- positionData.tokensOutstanding = positionData.tokensOutstanding.add(numTokens) (PerpetualPositionManager.sol#3873)\n\t- totalTokensOutstanding = totalTokensOutstanding.add(numTokens) (PerpetualPositionManager.sol#3875)\n",
            "name": "reentrancy-benign",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "PerpetualPositionManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "redeem",
            "impact": "Low",
            "line": 3895,
            "line_end": 3932,
            "message": "Reentrancy in PerpetualPositionManager.redeem(FixedPoint.Unsigned) (PerpetualPositionManager.sol#3895-3932):\n\tExternal calls:\n\t- fees() (PerpetualPositionManager.sol#3899)\n\t\t- returndata = address(token).functionCall(data,SafeERC20: low-level call failed) (PerpetualPositionManager.sol#537)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t\t- price = optimisticOracle.getPrice(identifier,proposalTime,ancillaryData) (PerpetualPositionManager.sol#3422-3455)\n\t\t- collateralCurrency.safeTransfer(request.proposer,reward.rawValue) (PerpetualPositionManager.sol#3440)\n\t\t- collateralCurrency.safeIncreaseAllowance(address(store),regularFee.rawValue) (PerpetualPositionManager.sol#1832)\n\t\t- store.payOracleFeesErc20(address(collateralCurrency),regularFee) (PerpetualPositionManager.sol#1833)\n\t\t- collateralCurrency.safeTransfer(msg.sender,latePenalty.rawValue) (PerpetualPositionManager.sol#1837)\n\tExternal calls sending eth:\n\t- fees() (PerpetualPositionManager.sol#3899)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\tState variables written after the call(s):\n\t- amountWithdrawn = _deleteSponsorPosition(msg.sender) (PerpetualPositionManager.sol#3912)\n\t\t- totalTokensOutstanding = totalTokensOutstanding.sub(positionToLiquidate.tokensOutstanding) (PerpetualPositionManager.sol#4135)\n\t- totalTokensOutstanding = totalTokensOutstanding.sub(numTokens) (PerpetualPositionManager.sol#3923)\n",
            "name": "reentrancy-benign",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FundingRateApplier",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "_getLatestFundingRate",
            "impact": "Low",
            "line": 3413,
            "line_end": 3458,
            "message": "Reentrancy in FundingRateApplier._getLatestFundingRate() (PerpetualPositionManager.sol#3413-3458):\n\tExternal calls:\n\t- price = optimisticOracle.getPrice(identifier,proposalTime,ancillaryData) (PerpetualPositionManager.sol#3422-3455)\n\tState variables written after the call(s):\n\t- _adjustCumulativeFeeMultiplier(reward,_pfc()) (PerpetualPositionManager.sol#3439)\n\t\t- cumulativeFeeMultiplier = cumulativeFeeMultiplier.mul(FixedPoint.fromUnscaledUint(1).sub(effectiveFee)) (PerpetualPositionManager.sol#1954)\n",
            "name": "reentrancy-benign",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "PerpetualPositionManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "settleEmergencyShutdown",
            "impact": "Low",
            "line": 3956,
            "line_end": 4012,
            "message": "Reentrancy in PerpetualPositionManager.settleEmergencyShutdown() (PerpetualPositionManager.sol#3956-4012):\n\tExternal calls:\n\t- fees() (PerpetualPositionManager.sol#3959)\n\t\t- returndata = address(token).functionCall(data,SafeERC20: low-level call failed) (PerpetualPositionManager.sol#537)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\t\t- price = optimisticOracle.getPrice(identifier,proposalTime,ancillaryData) (PerpetualPositionManager.sol#3422-3455)\n\t\t- collateralCurrency.safeTransfer(request.proposer,reward.rawValue) (PerpetualPositionManager.sol#3440)\n\t\t- collateralCurrency.safeIncreaseAllowance(address(store),regularFee.rawValue) (PerpetualPositionManager.sol#1832)\n\t\t- store.payOracleFeesErc20(address(collateralCurrency),regularFee) (PerpetualPositionManager.sol#1833)\n\t\t- collateralCurrency.safeTransfer(msg.sender,latePenalty.rawValue) (PerpetualPositionManager.sol#1837)\n\tExternal calls sending eth:\n\t- fees() (PerpetualPositionManager.sol#3959)\n\t\t- (success,returndata) = target.call{value: value}(data) (PerpetualPositionManager.sol#405)\n\tState variables written after the call(s):\n\t- emergencyShutdownPrice = _getOracleEmergencyShutdownPrice() (PerpetualPositionManager.sol#3965)\n\t- delete positions[msg.sender] (PerpetualPositionManager.sol#3993)\n\t- totalTokensOutstanding = totalTokensOutstanding.sub(tokensToRedeem) (PerpetualPositionManager.sol#4004)\n",
            "name": "reentrancy-benign",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FeePayer",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "_payFinalFees",
            "impact": "Low",
            "line": 1859,
            "line_end": 1883,
            "message": "Reentrancy in FeePayer._payFinalFees(address,FixedPoint.Unsigned) (PerpetualPositionManager.sol#1859-1883):\n\tExternal calls:\n\t- collateralCurrency.safeTransferFrom(payer,address(this),amount.rawValue) (PerpetualPositionManager.sol#1866)\n\tEvent emitted after the call(s):\n\t- FinalFeesPaid(amount.rawValue) (PerpetualPositionManager.sol#1878)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FeePayer",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "payRegularFees",
            "impact": "Low",
            "line": 1789,
            "line_end": 1840,
            "message": "FeePayer.payRegularFees() (PerpetualPositionManager.sol#1789-1840) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- lastPaymentTime == time (PerpetualPositionManager.sol#1803)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "PerpetualPositionManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "create",
            "impact": "Low",
            "line": 3846,
            "line_end": 3884,
            "message": "PerpetualPositionManager.create(FixedPoint.Unsigned,FixedPoint.Unsigned) (PerpetualPositionManager.sol#3846-3884) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool,string)((_checkCollateralization(_getFeeAdjustedCollateral(positionData.rawCollateral).add(collateralAmount),positionData.tokensOutstanding.add(numTokens)) || _checkCollateralization(collateralAmount,numTokens)),Insufficient collateral) (PerpetualPositionManager.sol#3855-3861)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "PerpetualPositionManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "_isEmergencyShutdown",
            "impact": "Low",
            "line": 4247,
            "line_end": 4250,
            "message": "PerpetualPositionManager._isEmergencyShutdown() (PerpetualPositionManager.sol#4247-4250) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool)(emergencyShutdownTimestamp != 0) (PerpetualPositionManager.sol#4249)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FundingRateApplier",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "proposeNewRate",
            "impact": "Low",
            "line": 3343,
            "line_end": 3392,
            "message": "FundingRateApplier.proposeNewRate(FixedPoint.Signed,uint256) (PerpetualPositionManager.sol#3343-3392) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool,string)(fundingRate.proposalTime == 0,Proposal in progress) (PerpetualPositionManager.sol#3349)\n\t- require(bool,string)(timestamp > updateTime && timestamp >= currentTime.sub(1800) && timestamp <= currentTime.add(90),Invalid proposal time) (PerpetualPositionManager.sol#3355-3358)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "PerpetualPositionManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "_reduceSponsorPosition",
            "impact": "Low",
            "line": 4093,
            "line_end": 4125,
            "message": "PerpetualPositionManager._reduceSponsorPosition(address,FixedPoint.Unsigned,FixedPoint.Unsigned,FixedPoint.Unsigned) (PerpetualPositionManager.sol#4093-4125) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- tokensToRemove.isEqual(positionData.tokensOutstanding) && _getFeeAdjustedCollateral(positionData.rawCollateral).isEqual(collateralToRemove) (PerpetualPositionManager.sol#4103-4104)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "PerpetualPositionManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "withdrawPassedRequest",
            "impact": "Low",
            "line": 3789,
            "line_end": 3820,
            "message": "PerpetualPositionManager.withdrawPassedRequest() (PerpetualPositionManager.sol#3789-3820) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool,string)(positionData.withdrawalRequestPassTimestamp != 0 && positionData.withdrawalRequestPassTimestamp <= getCurrentTime(),Invalid withdraw request) (PerpetualPositionManager.sol#3797-3801)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FundingRateApplier",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "_getLatestFundingRate",
            "impact": "Low",
            "line": 3413,
            "line_end": 3458,
            "message": "FundingRateApplier._getLatestFundingRate() (PerpetualPositionManager.sol#3413-3458) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- proposalTime != 0 (PerpetualPositionManager.sol#3415)\n\t- proposalTime >= lastUpdateTime (PerpetualPositionManager.sol#3429)\n\t- request.disputer == address(0) (PerpetualPositionManager.sol#3435)\n\t- optimisticOracle.getRequest(address(this),identifier,proposalTime,ancillaryData).disputer != address(0) (PerpetualPositionManager.sol#3450-3451)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "PerpetualPositionManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "requestWithdrawal",
            "impact": "Low",
            "line": 3762,
            "line_end": 3780,
            "message": "PerpetualPositionManager.requestWithdrawal(FixedPoint.Unsigned) (PerpetualPositionManager.sol#3762-3780) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool,string)(collateralAmount.isGreaterThan(0) && collateralAmount.isLessThanOrEqual(_getFeeAdjustedCollateral(positionData.rawCollateral)),Invalid collateral amount) (PerpetualPositionManager.sol#3769-3773)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "OptimisticOracle",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "getState",
            "impact": "Low",
            "line": 3052,
            "line_end": 3080,
            "message": "OptimisticOracle.getState(address,bytes32,uint256,bytes) (PerpetualPositionManager.sol#3052-3080) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- request.expirationTime <= getCurrentTime() (PerpetualPositionManager.sol#3073)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "PerpetualPositionManager",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/openzeppelin-UMA/protocol-1631ef7ad29aaeba756ef3b9a01c667e1343df85/packages/core/contracts/financial-templates/perpetual-multiparty/PerpetualPositionManager.sol",
            "function": "_notEmergencyShutdown",
            "impact": "Low",
            "line": 4242,
            "line_end": 4245,
            "message": "PerpetualPositionManager._notEmergencyShutdown() (PerpetualPositionManager.sol#4242-4245) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool)(emergencyShutdownTimestamp == 0) (PerpetualPositionManager.sol#4244)\n",
            "name": "timestamp",
            "check": "FP"
        }
    ],
    "infos": [],
    "parser": {
        "id": "slither-0.10.0",
        "mode": "solidity",
        "version": "2024/04/30"
    }
}