{
    "errors": [],
    "fails": [],
    "findings": [
        {
            "confidence": "Medium",
            "contract": "AniaLottery",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "withdrawTokens",
            "impact": "High",
            "line": 812,
            "line_end": 817,
            "message": "AniaLottery.withdrawTokens(uint256,address) (AniaLottery.sol#812-817) ignores return value by token.transfer(recipient,token.balanceOf(address(this))) (AniaLottery.sol#816)\n",
            "name": "unchecked-transfer",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaLottery",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "buy",
            "impact": "High",
            "line": 1028,
            "line_end": 1057,
            "message": "AniaLottery.buy(uint256,uint256,address) (AniaLottery.sol#1028-1057) ignores return value by stableCoin.transferFrom(msg.sender,billingAddress,pay * decimals) (AniaLottery.sol#1052)\n",
            "name": "unchecked-transfer",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaLottery",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "buy",
            "impact": "High",
            "line": 1028,
            "line_end": 1057,
            "message": "AniaLottery.buy(uint256,uint256,address) (AniaLottery.sol#1028-1057) ignores return value by token.transfer(msg.sender,tokensToBuy) (AniaLottery.sol#1048)\n",
            "name": "unchecked-transfer",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaStake",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "stakeTokens",
            "impact": "High",
            "line": 579,
            "line_end": 608,
            "message": "AniaStake.stakeTokens(uint256) (AniaLottery.sol#579-608) ignores return value by aniaToken.transferFrom(msg.sender,address(this),_amount) (AniaLottery.sol#607)\n",
            "name": "unchecked-transfer",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaStake",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "unstakeTokens",
            "impact": "High",
            "line": 611,
            "line_end": 638,
            "message": "AniaStake.unstakeTokens(uint256) (AniaLottery.sol#611-638) ignores return value by aniaToken.transfer(msg.sender,_amount) (AniaLottery.sol#627)\n",
            "name": "unchecked-transfer",
            "check": "FP"
        },
        {
            "confidence": "High",
            "contract": "AniaStake",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "constructor",
            "impact": "Medium",
            "line": 493,
            "line_end": 693,
            "message": "Contract locking ether found:\n\tContract AniaStake (AniaLottery.sol#493-693) has payable functions:\n\t - AniaStake.constructor(ArkaniaProtocol) (AniaLottery.sol#535-543)\n\tBut does not have a function to withdraw the ether\n",
            "name": "locked-ether",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaLottery",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "buy",
            "impact": "Medium",
            "line": 1028,
            "line_end": 1057,
            "message": "Reentrancy in AniaLottery.buy(uint256,uint256,address) (AniaLottery.sol#1028-1057):\n\tExternal calls:\n\t- token.transfer(msg.sender,tokensToBuy) (AniaLottery.sol#1048)\n\t- stableCoin.transferFrom(msg.sender,billingAddress,pay * decimals) (AniaLottery.sol#1052)\n\tState variables written after the call(s):\n\t- setLotteryWinnerClaimedStatus(projectId,msg.sender) (AniaLottery.sol#1055)\n\t\t- lotteryWinners[projectId][index].claimed = true (AniaLottery.sol#930)\n\tAniaLottery.lotteryWinners (AniaLottery.sol#759) can be used in cross function reentrancies:\n\t- AniaLottery._checkUserIsProjectWinner(uint256,address) (AniaLottery.sol#1085-1095)\n\t- AniaLottery.getLotteryWinner(uint256,address) (AniaLottery.sol#917-921)\n\t- AniaLottery.lotteryDraw(uint256,address[]) (AniaLottery.sol#872-901)\n\t- AniaLottery.setLotteryWinnerClaimedStatus(uint256,address) (AniaLottery.sol#927-931)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaStake",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "unstakeTokens",
            "impact": "Medium",
            "line": 611,
            "line_end": 638,
            "message": "Reentrancy in AniaStake.unstakeTokens(uint256) (AniaLottery.sol#611-638):\n\tExternal calls:\n\t- aniaToken.transfer(msg.sender,_amount) (AniaLottery.sol#627)\n\tState variables written after the call(s):\n\t- stakers[index].address_stake = Stake(msg.sender,userStakes + reward - _amount,block.timestamp) (AniaLottery.sol#630)\n\tAniaStake.stakers (AniaLottery.sol#527) can be used in cross function reentrancies:\n\t- AniaStake._addStaker(address) (AniaLottery.sol#557-567)\n\t- AniaStake.constructor(ArkaniaProtocol) (AniaLottery.sol#535-543)\n\t- AniaStake.hasRewards() (AniaLottery.sol#641-645)\n\t- AniaStake.hasStakeWithRewards(address) (AniaLottery.sol#648-663)\n\t- AniaStake.redistributeRewards(address[]) (AniaLottery.sol#666-680)\n\t- AniaStake.stakeTokens(uint256) (AniaLottery.sol#579-608)\n\t- AniaStake.unstakeTokens(uint256) (AniaLottery.sol#611-638)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaLottery",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "changeTierThreeTicketValue",
            "impact": "Low",
            "line": 964,
            "line_end": 969,
            "message": "AniaLottery.changeTierThreeTicketValue(uint256) (AniaLottery.sol#964-969) should emit an event for: \n\t- tierThreeTicketValue = _value (AniaLottery.sol#968) \n",
            "name": "events-maths",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaLottery",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "changeTierTwoTicketValue",
            "impact": "Low",
            "line": 958,
            "line_end": 963,
            "message": "AniaLottery.changeTierTwoTicketValue(uint256) (AniaLottery.sol#958-963) should emit an event for: \n\t- tierTwoTicketValue = _value (AniaLottery.sol#962) \n",
            "name": "events-maths",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaStake",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "changeAPY",
            "impact": "Low",
            "line": 683,
            "line_end": 692,
            "message": "AniaStake.changeAPY(uint256,address[]) (AniaLottery.sol#683-692) should emit an event for: \n\t- apy = _value (AniaLottery.sol#691) \n",
            "name": "events-maths",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaLottery",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "changeTierOne",
            "impact": "Low",
            "line": 934,
            "line_end": 939,
            "message": "AniaLottery.changeTierOne(uint256) (AniaLottery.sol#934-939) should emit an event for: \n\t- tierOne = _value (AniaLottery.sol#938) \n",
            "name": "events-maths",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaLottery",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "changeTierTwo",
            "impact": "Low",
            "line": 940,
            "line_end": 945,
            "message": "AniaLottery.changeTierTwo(uint256) (AniaLottery.sol#940-945) should emit an event for: \n\t- tierTwo = _value (AniaLottery.sol#944) \n",
            "name": "events-maths",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaLottery",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "changeTierThree",
            "impact": "Low",
            "line": 946,
            "line_end": 951,
            "message": "AniaLottery.changeTierThree(uint256) (AniaLottery.sol#946-951) should emit an event for: \n\t- tierThree = _value (AniaLottery.sol#950) \n",
            "name": "events-maths",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaLottery",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "changeTierOneTicketValue",
            "impact": "Low",
            "line": 952,
            "line_end": 957,
            "message": "AniaLottery.changeTierOneTicketValue(uint256) (AniaLottery.sol#952-957) should emit an event for: \n\t- tierOneTicketValue = _value (AniaLottery.sol#956) \n",
            "name": "events-maths",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaStake",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "stakeTokens",
            "impact": "Low",
            "line": 579,
            "line_end": 608,
            "message": "AniaStake.stakeTokens(uint256) (AniaLottery.sol#579-608) should emit an event for: \n\t- totalStaked += newStake (AniaLottery.sol#604) \n",
            "name": "events-maths",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaLottery",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "getUserTicketValue",
            "impact": "Low",
            "line": 852,
            "line_end": 862,
            "message": "AniaLottery.getUserTicketValue(address) (AniaLottery.sol#852-862) has external calls inside a loop: userStake = tokenStaking.hasStakeWithRewards(_address) (AniaLottery.sol#853)\n",
            "name": "calls-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaStake",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "unstakeTokens",
            "impact": "Low",
            "line": 611,
            "line_end": 638,
            "message": "Reentrancy in AniaStake.unstakeTokens(uint256) (AniaLottery.sol#611-638):\n\tExternal calls:\n\t- aniaToken.transfer(msg.sender,_amount) (AniaLottery.sol#627)\n\tState variables written after the call(s):\n\t- totalStaked -= userStakes (AniaLottery.sol#634)\n\t- totalStaked -= _amount (AniaLottery.sol#636)\n",
            "name": "reentrancy-benign",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaLottery",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "buy",
            "impact": "Low",
            "line": 1028,
            "line_end": 1057,
            "message": "Reentrancy in AniaLottery.buy(uint256,uint256,address) (AniaLottery.sol#1028-1057):\n\tExternal calls:\n\t- token.transfer(msg.sender,tokensToBuy) (AniaLottery.sol#1048)\n\t- stableCoin.transferFrom(msg.sender,billingAddress,pay * decimals) (AniaLottery.sol#1052)\n\tState variables written after the call(s):\n\t- projectRaisedAmount[projectId] += pay (AniaLottery.sol#1056)\n",
            "name": "reentrancy-benign",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaLottery",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "_checkOpenProject",
            "impact": "Low",
            "line": 1097,
            "line_end": 1099,
            "message": "AniaLottery._checkOpenProject(uint256) (AniaLottery.sol#1097-1099) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- projects[projectId].id > 0 && projects[projectId].endDate > block.timestamp (AniaLottery.sol#1098)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaStake",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "unstakeTokens",
            "impact": "Low",
            "line": 611,
            "line_end": 638,
            "message": "AniaStake.unstakeTokens(uint256) (AniaLottery.sol#611-638) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool,string)(_amount <= stakedWithRewards,amount has to be less or equal than current stakes with rewards) (AniaLottery.sol#626)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "AniaStake",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Hacken-Arkania Protocol/Code-4fe28aed2e2549ba649ed2edb6a11ef7d2ac73fd/AniaLottery.sol",
            "function": "redistributeRewards",
            "impact": "Informational",
            "line": 666,
            "line_end": 680,
            "message": "AniaStake.redistributeRewards(address[]) (AniaLottery.sol#666-680) has costly operations inside a loop:\n\t- totalStaked += reward (AniaLottery.sol#678)\n",
            "name": "costly-loop",
            "check": "FP"
        }
    ],
    "infos": [],
    "parser": {
        "id": "slither-0.10.0",
        "mode": "solidity",
        "version": "2024/04/30"
    }
}