{
    "errors": [],
    "fails": [],
    "findings": [
        {
            "confidence": "Medium",
            "contract": "FountainBase",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "_beforeTokenTransfer",
            "impact": "Medium",
            "line": 1839,
            "line_end": 1865,
            "message": "Reentrancy in FountainBase._beforeTokenTransfer(address,address,uint256) (FountainBase.sol#1839-1865):\n\tExternal calls:\n\t- _withdrawAngel(from,angel,amount) (FountainBase.sol#1849)\n\t\t- angel.withdraw(info.pid,amount,user) (FountainBase.sol#1897)\n\t- _emergencyWithdrawAngel(from,angel_scope_1) (FountainBase.sol#1854)\n\t\t- angel.emergencyWithdraw(info.pid,user) (FountainBase.sol#1926)\n\t- _depositAngel(to,angel_scope_4,amount) (FountainBase.sol#1862)\n\t\t- angel.deposit(info.pid,amount,user) (FountainBase.sol#1881)\n\tState variables written after the call(s):\n\t- _depositAngel(to,angel_scope_4,amount) (FountainBase.sol#1862)\n\t\t- info.totalBalance = info.totalBalance.add(amount) (FountainBase.sol#1882)\n\tFountainBase._angelInfos (FountainBase.sol#1628) can be used in cross function reentrancies:\n\t- FountainBase._depositAngel(address,IAngel,uint256) (FountainBase.sol#1870-1883)\n\t- FountainBase._emergencyWithdrawAngel(address,IAngel) (FountainBase.sol#1915-1928)\n\t- FountainBase._harvestAngel(IAngel,address,address) (FountainBase.sol#1901-1913)\n\t- FountainBase._withdrawAngel(address,IAngel,uint256) (FountainBase.sol#1886-1899)\n\t- FountainBase.angelInfo(IAngel) (FountainBase.sol#1666-1670)\n\t- FountainBase.setPoolId(uint256) (FountainBase.sol#1676-1687)\n\t- _depositAngel(to,angel_scope_4,amount) (FountainBase.sol#1862)\n\t\t- _status = _ENTERED (FountainBase.sol#55)\n\t\t- _status = _NOT_ENTERED (FountainBase.sol#61)\n\tReentrancyGuard._status (FountainBase.sol#37) can be used in cross function reentrancies:\n\t- ReentrancyGuard.nonReentrant() (FountainBase.sol#50-62)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FountainBase",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "quitAllAngel",
            "impact": "Medium",
            "line": 1825,
            "line_end": 1834,
            "message": "Reentrancy in FountainBase.quitAllAngel() (FountainBase.sol#1825-1834):\n\tExternal calls:\n\t- _withdrawAngel(_msgSender(),angel,balanceOf(_msgSender())) (FountainBase.sol#1831)\n\t\t- angel.withdraw(info.pid,amount,user) (FountainBase.sol#1897)\n\tState variables written after the call(s):\n\t- delete _joinedAngels[_msgSender()] (FountainBase.sol#1833)\n\tFountainBase._joinedAngels (FountainBase.sol#1626) can be used in cross function reentrancies:\n\t- FountainBase._beforeTokenTransfer(address,address,uint256) (FountainBase.sol#1839-1865)\n\t- FountainBase._joinAngel(IAngel,address) (FountainBase.sol#1930-1941)\n\t- FountainBase.harvestAll() (FountainBase.sol#1760-1768)\n\t- FountainBase.joinedAngel(address) (FountainBase.sol#1657-1659)\n\t- FountainBase.quitAllAngel() (FountainBase.sol#1825-1834)\n\t- FountainBase.quitAngel(IAngel) (FountainBase.sol#1798-1822)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FountainBase",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "_emergencyWithdrawAngel",
            "impact": "Medium",
            "line": 1915,
            "line_end": 1928,
            "message": "Reentrancy in FountainBase._emergencyWithdrawAngel(address,IAngel) (FountainBase.sol#1915-1928):\n\tExternal calls:\n\t- angel.emergencyWithdraw(info.pid,user) (FountainBase.sol#1926)\n\tState variables written after the call(s):\n\t- info.totalBalance = info.totalBalance.sub(amount) (FountainBase.sol#1927)\n\tFountainBase._angelInfos (FountainBase.sol#1628) can be used in cross function reentrancies:\n\t- FountainBase._depositAngel(address,IAngel,uint256) (FountainBase.sol#1870-1883)\n\t- FountainBase._emergencyWithdrawAngel(address,IAngel) (FountainBase.sol#1915-1928)\n\t- FountainBase._harvestAngel(IAngel,address,address) (FountainBase.sol#1901-1913)\n\t- FountainBase._withdrawAngel(address,IAngel,uint256) (FountainBase.sol#1886-1899)\n\t- FountainBase.angelInfo(IAngel) (FountainBase.sol#1666-1670)\n\t- FountainBase.setPoolId(uint256) (FountainBase.sol#1676-1687)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FountainBase",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "_withdrawAngel",
            "impact": "Medium",
            "line": 1886,
            "line_end": 1899,
            "message": "Reentrancy in FountainBase._withdrawAngel(address,IAngel,uint256) (FountainBase.sol#1886-1899):\n\tExternal calls:\n\t- angel.withdraw(info.pid,amount,user) (FountainBase.sol#1897)\n\tState variables written after the call(s):\n\t- info.totalBalance = info.totalBalance.sub(amount) (FountainBase.sol#1898)\n\tFountainBase._angelInfos (FountainBase.sol#1628) can be used in cross function reentrancies:\n\t- FountainBase._depositAngel(address,IAngel,uint256) (FountainBase.sol#1870-1883)\n\t- FountainBase._emergencyWithdrawAngel(address,IAngel) (FountainBase.sol#1915-1928)\n\t- FountainBase._harvestAngel(IAngel,address,address) (FountainBase.sol#1901-1913)\n\t- FountainBase._withdrawAngel(address,IAngel,uint256) (FountainBase.sol#1886-1899)\n\t- FountainBase.angelInfo(IAngel) (FountainBase.sol#1666-1670)\n\t- FountainBase.setPoolId(uint256) (FountainBase.sol#1676-1687)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FountainBase",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "_depositAngel",
            "impact": "Medium",
            "line": 1870,
            "line_end": 1883,
            "message": "Reentrancy in FountainBase._depositAngel(address,IAngel,uint256) (FountainBase.sol#1870-1883):\n\tExternal calls:\n\t- angel.deposit(info.pid,amount,user) (FountainBase.sol#1881)\n\tState variables written after the call(s):\n\t- info.totalBalance = info.totalBalance.add(amount) (FountainBase.sol#1882)\n\tFountainBase._angelInfos (FountainBase.sol#1628) can be used in cross function reentrancies:\n\t- FountainBase._depositAngel(address,IAngel,uint256) (FountainBase.sol#1870-1883)\n\t- FountainBase._emergencyWithdrawAngel(address,IAngel) (FountainBase.sol#1915-1928)\n\t- FountainBase._harvestAngel(IAngel,address,address) (FountainBase.sol#1901-1913)\n\t- FountainBase._withdrawAngel(address,IAngel,uint256) (FountainBase.sol#1886-1899)\n\t- FountainBase.angelInfo(IAngel) (FountainBase.sol#1666-1670)\n\t- FountainBase.setPoolId(uint256) (FountainBase.sol#1676-1687)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "High",
            "contract": "ERC20",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "name",
            "impact": "Low",
            "line": 1532,
            "message": "ERC20Permit.constructor(string).name (FountainBase.sol#1532) shadows:\n\t- ERC20.name() (FountainBase.sol#966-968) (function)\n",
            "name": "shadowing-local",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FountainBase",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "_harvestAngel",
            "impact": "Low",
            "line": 1901,
            "line_end": 1913,
            "message": "FountainBase._harvestAngel(IAngel,address,address) (FountainBase.sol#1901-1913) has external calls inside a loop: angel.harvest(info.pid,from,to) (FountainBase.sol#1912)\n",
            "name": "calls-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FountainBase",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "_depositAngel",
            "impact": "Low",
            "line": 1870,
            "line_end": 1883,
            "message": "FountainBase._depositAngel(address,IAngel,uint256) (FountainBase.sol#1870-1883) has external calls inside a loop: angel.deposit(info.pid,amount,user) (FountainBase.sol#1881)\n",
            "name": "calls-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FountainBase",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "_withdrawAngel",
            "impact": "Low",
            "line": 1886,
            "line_end": 1899,
            "message": "FountainBase._withdrawAngel(address,IAngel,uint256) (FountainBase.sol#1886-1899) has external calls inside a loop: angel.withdraw(info.pid,amount,user) (FountainBase.sol#1897)\n",
            "name": "calls-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FountainBase",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "emergencyWithdraw",
            "impact": "Low",
            "line": 1771,
            "line_end": 1780,
            "message": "Reentrancy in FountainBase.emergencyWithdraw() (FountainBase.sol#1771-1780):\n\tExternal calls:\n\t- _burn(_msgSender(),type()(uint256).max) (FountainBase.sol#1775)\n\t\t- angel.deposit(info.pid,amount,user) (FountainBase.sol#1881)\n\t\t- angel.withdraw(info.pid,amount,user) (FountainBase.sol#1897)\n\t\t- angel.emergencyWithdraw(info.pid,user) (FountainBase.sol#1926)\n\t- stakingToken.safeTransfer(_msgSender(),amount) (FountainBase.sol#1778)\n\tEvent emitted after the call(s):\n\t- EmergencyWithdraw(_msgSender(),amount,_msgSender()) (FountainBase.sol#1779)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FountainBase",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "harvestAll",
            "impact": "Low",
            "line": 1760,
            "line_end": 1768,
            "message": "Reentrancy in FountainBase.harvestAll() (FountainBase.sol#1760-1768):\n\tExternal calls:\n\t- _harvestAngel(angel,_msgSender(),_msgSender()) (FountainBase.sol#1765)\n\t\t- angel.harvest(info.pid,from,to) (FountainBase.sol#1912)\n\tEvent emitted after the call(s):\n\t- Harvest(_msgSender()) (FountainBase.sol#1767)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FountainBase",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "depositTo",
            "impact": "Low",
            "line": 1710,
            "line_end": 1717,
            "message": "Reentrancy in FountainBase.depositTo(uint256,address) (FountainBase.sol#1710-1717):\n\tExternal calls:\n\t- _mint(to,amount) (FountainBase.sol#1712)\n\t\t- angel.deposit(info.pid,amount,user) (FountainBase.sol#1881)\n\t\t- angel.withdraw(info.pid,amount,user) (FountainBase.sol#1897)\n\t\t- angel.emergencyWithdraw(info.pid,user) (FountainBase.sol#1926)\n\t- stakingToken.safeTransferFrom(_msgSender(),address(this),amount) (FountainBase.sol#1715)\n\tEvent emitted after the call(s):\n\t- Deposit(_msgSender(),amount,to) (FountainBase.sol#1716)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FountainBase",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "withdrawTo",
            "impact": "Low",
            "line": 1740,
            "line_end": 1750,
            "message": "Reentrancy in FountainBase.withdrawTo(uint256,address) (FountainBase.sol#1740-1750):\n\tExternal calls:\n\t- _burn(_msgSender(),amount) (FountainBase.sol#1745)\n\t\t- angel.deposit(info.pid,amount,user) (FountainBase.sol#1881)\n\t\t- angel.withdraw(info.pid,amount,user) (FountainBase.sol#1897)\n\t\t- angel.emergencyWithdraw(info.pid,user) (FountainBase.sol#1926)\n\t- stakingToken.safeTransfer(to,amount) (FountainBase.sol#1748)\n\tEvent emitted after the call(s):\n\t- Withdraw(_msgSender(),amount,to) (FountainBase.sol#1749)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FountainBase",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "quitAllAngel",
            "impact": "Low",
            "line": 1825,
            "line_end": 1834,
            "message": "Reentrancy in FountainBase.quitAllAngel() (FountainBase.sol#1825-1834):\n\tExternal calls:\n\t- _withdrawAngel(_msgSender(),angel,balanceOf(_msgSender())) (FountainBase.sol#1831)\n\t\t- angel.withdraw(info.pid,amount,user) (FountainBase.sol#1897)\n\tEvent emitted after the call(s):\n\t- Quit(_msgSender(),address(angel)) (FountainBase.sol#1829)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FountainBase",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "harvest",
            "impact": "Low",
            "line": 1754,
            "line_end": 1757,
            "message": "Reentrancy in FountainBase.harvest(IAngel) (FountainBase.sol#1754-1757):\n\tExternal calls:\n\t- _harvestAngel(angel,_msgSender(),_msgSender()) (FountainBase.sol#1755)\n\t\t- angel.harvest(info.pid,from,to) (FountainBase.sol#1912)\n\tEvent emitted after the call(s):\n\t- Harvest(_msgSender()) (FountainBase.sol#1756)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FountainBase",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "deposit",
            "impact": "Low",
            "line": 1694,
            "line_end": 1702,
            "message": "Reentrancy in FountainBase.deposit(uint256) (FountainBase.sol#1694-1702):\n\tExternal calls:\n\t- _mint(_msgSender(),amount) (FountainBase.sol#1696)\n\t\t- angel.deposit(info.pid,amount,user) (FountainBase.sol#1881)\n\t\t- angel.withdraw(info.pid,amount,user) (FountainBase.sol#1897)\n\t\t- angel.emergencyWithdraw(info.pid,user) (FountainBase.sol#1926)\n\t- stakingToken.safeTransferFrom(_msgSender(),address(this),amount) (FountainBase.sol#1699)\n\tEvent emitted after the call(s):\n\t- Deposit(_msgSender(),amount,_msgSender()) (FountainBase.sol#1701)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "FountainBase",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "withdraw",
            "impact": "Low",
            "line": 1723,
            "line_end": 1733,
            "message": "Reentrancy in FountainBase.withdraw(uint256) (FountainBase.sol#1723-1733):\n\tExternal calls:\n\t- _burn(_msgSender(),amount) (FountainBase.sol#1728)\n\t\t- angel.deposit(info.pid,amount,user) (FountainBase.sol#1881)\n\t\t- angel.withdraw(info.pid,amount,user) (FountainBase.sol#1897)\n\t\t- angel.emergencyWithdraw(info.pid,user) (FountainBase.sol#1926)\n\t- stakingToken.safeTransfer(_msgSender(),amount) (FountainBase.sol#1731)\n\tEvent emitted after the call(s):\n\t- Withdraw(_msgSender(),amount,_msgSender()) (FountainBase.sol#1732)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "ERC20Permit",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "permit",
            "impact": "Low",
            "line": 1537,
            "line_end": 1568,
            "message": "ERC20Permit.permit(address,address,uint256,uint256,uint8,bytes32,bytes32) (FountainBase.sol#1537-1568) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool,string)(block.timestamp <= deadline,ERC20Permit: expired deadline) (FountainBase.sol#1547)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "ReentrancyGuard",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "nonReentrant",
            "impact": "Informational",
            "line": 50,
            "line_end": 62,
            "message": "ReentrancyGuard.nonReentrant() (FountainBase.sol#50-62) has costly operations inside a loop:\n\t- _status = _ENTERED (FountainBase.sol#55)\n",
            "name": "costly-loop",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "ReentrancyGuard",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Chainsulting-Furucombo-project2/trevi-b3f7fd332873321152db48c9d43fc23a60a29f1a/contracts/FountainBase.sol",
            "function": "nonReentrant",
            "impact": "Informational",
            "line": 50,
            "line_end": 62,
            "message": "ReentrancyGuard.nonReentrant() (FountainBase.sol#50-62) has costly operations inside a loop:\n\t- _status = _NOT_ENTERED (FountainBase.sol#61)\n",
            "name": "costly-loop",
            "check": "FP"
        }
    ],
    "infos": [],
    "parser": {
        "id": "slither-0.10.0",
        "mode": "solidity",
        "version": "2024/04/30"
    }
}