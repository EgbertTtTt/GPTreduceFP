{
    "errors": [],
    "fails": [],
    "findings": [
        {
            "confidence": "Medium",
            "contract": "TokenProxy",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-golem/golem-contracts-62a1e0dab3baf8e9bff79b653dffa7df5f2d10a0/contracts/GNTPaymentChannels.sol",
            "function": "withdrawTo",
            "impact": "High",
            "line": 329,
            "line_end": 340,
            "message": "TokenProxy.withdrawTo(uint256,address) (GNTPaymentChannels.sol#329-340) ignores return value by TOKEN.transfer(_destination,_value) (GNTPaymentChannels.sol#337)\n",
            "name": "unchecked-transfer",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "GNTPaymentChannels",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-golem/golem-contracts-62a1e0dab3baf8e9bff79b653dffa7df5f2d10a0/contracts/GNTPaymentChannels.sol",
            "function": "_do_withdraw",
            "impact": "Medium",
            "line": 584,
            "line_end": 595,
            "message": "Reentrancy in GNTPaymentChannels._do_withdraw(bytes32,uint256) (GNTPaymentChannels.sol#584-595):\n\tExternal calls:\n\t- token.transfer(ch.receiver,_amount) (GNTPaymentChannels.sol#589)\n\tState variables written after the call(s):\n\t- ch.withdrawn += _amount (GNTPaymentChannels.sol#590)\n\tGNTPaymentChannels.channels (GNTPaymentChannels.sol#413) can be used in cross function reentrancies:\n\t- GNTPaymentChannels._do_close(bytes32,bool) (GNTPaymentChannels.sol#597-612)\n\t- GNTPaymentChannels._do_withdraw(bytes32,uint256) (GNTPaymentChannels.sol#584-595)\n\t- GNTPaymentChannels.channels (GNTPaymentChannels.sol#413)\n\t- GNTPaymentChannels.createChannel(address) (GNTPaymentChannels.sol#503-508)\n\t- GNTPaymentChannels.forceClose(bytes32) (GNTPaymentChannels.sol#575-580)\n\t- GNTPaymentChannels.fund(bytes32,uint256) (GNTPaymentChannels.sol#524-537)\n\t- GNTPaymentChannels.getDeposited(bytes32) (GNTPaymentChannels.sol#453-459)\n\t- GNTPaymentChannels.getOwner(bytes32) (GNTPaymentChannels.sol#468-473)\n\t- GNTPaymentChannels.getReceiver(bytes32) (GNTPaymentChannels.sol#475-480)\n\t- GNTPaymentChannels.getWithdrawn(bytes32) (GNTPaymentChannels.sol#461-466)\n\t- GNTPaymentChannels.isLocked(bytes32) (GNTPaymentChannels.sol#482-484)\n\t- GNTPaymentChannels.isTimeLocked(bytes32) (GNTPaymentChannels.sol#486-488)\n\t- GNTPaymentChannels.isUnlocked(bytes32) (GNTPaymentChannels.sol#490-493)\n\t- GNTPaymentChannels.isValidSig(bytes32,uint256,uint8,bytes32,bytes32) (GNTPaymentChannels.sol#495-498)\n\t- GNTPaymentChannels.onTokenReceived(address,uint256,bytes) (GNTPaymentChannels.sol#511-520)\n\t- GNTPaymentChannels.onlyOwner(bytes32) (GNTPaymentChannels.sol#441-444)\n\t- GNTPaymentChannels.unlock(bytes32) (GNTPaymentChannels.sol#556-562)\n\t- GNTPaymentChannels.withdraw(bytes32,uint256,uint8,bytes32,bytes32) (GNTPaymentChannels.sol#540-552)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "GNTPaymentChannels",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-golem/golem-contracts-62a1e0dab3baf8e9bff79b653dffa7df5f2d10a0/contracts/GNTPaymentChannels.sol",
            "function": "_do_close",
            "impact": "Medium",
            "line": 597,
            "line_end": 612,
            "message": "Reentrancy in GNTPaymentChannels._do_close(bytes32,bool) (GNTPaymentChannels.sol#597-612):\n\tExternal calls:\n\t- token.transfer(ch.owner,amount) (GNTPaymentChannels.sol#603)\n\tState variables written after the call(s):\n\t- delete channels[_channel] (GNTPaymentChannels.sol#608)\n\tGNTPaymentChannels.channels (GNTPaymentChannels.sol#413) can be used in cross function reentrancies:\n\t- GNTPaymentChannels._do_close(bytes32,bool) (GNTPaymentChannels.sol#597-612)\n\t- GNTPaymentChannels._do_withdraw(bytes32,uint256) (GNTPaymentChannels.sol#584-595)\n\t- GNTPaymentChannels.channels (GNTPaymentChannels.sol#413)\n\t- GNTPaymentChannels.createChannel(address) (GNTPaymentChannels.sol#503-508)\n\t- GNTPaymentChannels.forceClose(bytes32) (GNTPaymentChannels.sol#575-580)\n\t- GNTPaymentChannels.fund(bytes32,uint256) (GNTPaymentChannels.sol#524-537)\n\t- GNTPaymentChannels.getDeposited(bytes32) (GNTPaymentChannels.sol#453-459)\n\t- GNTPaymentChannels.getOwner(bytes32) (GNTPaymentChannels.sol#468-473)\n\t- GNTPaymentChannels.getReceiver(bytes32) (GNTPaymentChannels.sol#475-480)\n\t- GNTPaymentChannels.getWithdrawn(bytes32) (GNTPaymentChannels.sol#461-466)\n\t- GNTPaymentChannels.isLocked(bytes32) (GNTPaymentChannels.sol#482-484)\n\t- GNTPaymentChannels.isTimeLocked(bytes32) (GNTPaymentChannels.sol#486-488)\n\t- GNTPaymentChannels.isUnlocked(bytes32) (GNTPaymentChannels.sol#490-493)\n\t- GNTPaymentChannels.isValidSig(bytes32,uint256,uint8,bytes32,bytes32) (GNTPaymentChannels.sol#495-498)\n\t- GNTPaymentChannels.onTokenReceived(address,uint256,bytes) (GNTPaymentChannels.sol#511-520)\n\t- GNTPaymentChannels.onlyOwner(bytes32) (GNTPaymentChannels.sol#441-444)\n\t- GNTPaymentChannels.unlock(bytes32) (GNTPaymentChannels.sol#556-562)\n\t- GNTPaymentChannels.withdraw(bytes32,uint256,uint8,bytes32,bytes32) (GNTPaymentChannels.sol#540-552)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "GNTPaymentChannels",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-golem/golem-contracts-62a1e0dab3baf8e9bff79b653dffa7df5f2d10a0/contracts/GNTPaymentChannels.sol",
            "function": "fund",
            "impact": "Medium",
            "line": 524,
            "line_end": 537,
            "message": "Reentrancy in GNTPaymentChannels.fund(bytes32,uint256) (GNTPaymentChannels.sol#524-537):\n\tExternal calls:\n\t- token.transferFrom(msg.sender,address(this),_amount) (GNTPaymentChannels.sol#530)\n\tState variables written after the call(s):\n\t- ch.deposited += _amount (GNTPaymentChannels.sol#531)\n\tGNTPaymentChannels.channels (GNTPaymentChannels.sol#413) can be used in cross function reentrancies:\n\t- GNTPaymentChannels._do_close(bytes32,bool) (GNTPaymentChannels.sol#597-612)\n\t- GNTPaymentChannels._do_withdraw(bytes32,uint256) (GNTPaymentChannels.sol#584-595)\n\t- GNTPaymentChannels.channels (GNTPaymentChannels.sol#413)\n\t- GNTPaymentChannels.createChannel(address) (GNTPaymentChannels.sol#503-508)\n\t- GNTPaymentChannels.forceClose(bytes32) (GNTPaymentChannels.sol#575-580)\n\t- GNTPaymentChannels.fund(bytes32,uint256) (GNTPaymentChannels.sol#524-537)\n\t- GNTPaymentChannels.getDeposited(bytes32) (GNTPaymentChannels.sol#453-459)\n\t- GNTPaymentChannels.getOwner(bytes32) (GNTPaymentChannels.sol#468-473)\n\t- GNTPaymentChannels.getReceiver(bytes32) (GNTPaymentChannels.sol#475-480)\n\t- GNTPaymentChannels.getWithdrawn(bytes32) (GNTPaymentChannels.sol#461-466)\n\t- GNTPaymentChannels.isLocked(bytes32) (GNTPaymentChannels.sol#482-484)\n\t- GNTPaymentChannels.isTimeLocked(bytes32) (GNTPaymentChannels.sol#486-488)\n\t- GNTPaymentChannels.isUnlocked(bytes32) (GNTPaymentChannels.sol#490-493)\n\t- GNTPaymentChannels.isValidSig(bytes32,uint256,uint8,bytes32,bytes32) (GNTPaymentChannels.sol#495-498)\n\t- GNTPaymentChannels.onTokenReceived(address,uint256,bytes) (GNTPaymentChannels.sol#511-520)\n\t- GNTPaymentChannels.onlyOwner(bytes32) (GNTPaymentChannels.sol#441-444)\n\t- GNTPaymentChannels.unlock(bytes32) (GNTPaymentChannels.sol#556-562)\n\t- GNTPaymentChannels.withdraw(bytes32,uint256,uint8,bytes32,bytes32) (GNTPaymentChannels.sol#540-552)\n\t- ch.locked_until = 0 (GNTPaymentChannels.sol#532)\n\tGNTPaymentChannels.channels (GNTPaymentChannels.sol#413) can be used in cross function reentrancies:\n\t- GNTPaymentChannels._do_close(bytes32,bool) (GNTPaymentChannels.sol#597-612)\n\t- GNTPaymentChannels._do_withdraw(bytes32,uint256) (GNTPaymentChannels.sol#584-595)\n\t- GNTPaymentChannels.channels (GNTPaymentChannels.sol#413)\n\t- GNTPaymentChannels.createChannel(address) (GNTPaymentChannels.sol#503-508)\n\t- GNTPaymentChannels.forceClose(bytes32) (GNTPaymentChannels.sol#575-580)\n\t- GNTPaymentChannels.fund(bytes32,uint256) (GNTPaymentChannels.sol#524-537)\n\t- GNTPaymentChannels.getDeposited(bytes32) (GNTPaymentChannels.sol#453-459)\n\t- GNTPaymentChannels.getOwner(bytes32) (GNTPaymentChannels.sol#468-473)\n\t- GNTPaymentChannels.getReceiver(bytes32) (GNTPaymentChannels.sol#475-480)\n\t- GNTPaymentChannels.getWithdrawn(bytes32) (GNTPaymentChannels.sol#461-466)\n\t- GNTPaymentChannels.isLocked(bytes32) (GNTPaymentChannels.sol#482-484)\n\t- GNTPaymentChannels.isTimeLocked(bytes32) (GNTPaymentChannels.sol#486-488)\n\t- GNTPaymentChannels.isUnlocked(bytes32) (GNTPaymentChannels.sol#490-493)\n\t- GNTPaymentChannels.isValidSig(bytes32,uint256,uint8,bytes32,bytes32) (GNTPaymentChannels.sol#495-498)\n\t- GNTPaymentChannels.onTokenReceived(address,uint256,bytes) (GNTPaymentChannels.sol#511-520)\n\t- GNTPaymentChannels.onlyOwner(bytes32) (GNTPaymentChannels.sol#441-444)\n\t- GNTPaymentChannels.unlock(bytes32) (GNTPaymentChannels.sol#556-562)\n\t- GNTPaymentChannels.withdraw(bytes32,uint256,uint8,bytes32,bytes32) (GNTPaymentChannels.sol#540-552)\n",
            "name": "reentrancy-no-eth",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TokenProxy",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-golem/golem-contracts-62a1e0dab3baf8e9bff79b653dffa7df5f2d10a0/contracts/GNTPaymentChannels.sol",
            "function": "transferFromGate",
            "impact": "Low",
            "line": 305,
            "line_end": 323,
            "message": "Reentrancy in TokenProxy.transferFromGate() (GNTPaymentChannels.sol#305-323):\n\tExternal calls:\n\t- value = TOKEN.balanceOf(gate) (GNTPaymentChannels.sol#313)\n\t- Gate(gate).transferToProxy(value) (GNTPaymentChannels.sol#315)\n\tState variables written after the call(s):\n\t- balances[user] += value (GNTPaymentChannels.sol#320)\n\t- totalSupply_ += value (GNTPaymentChannels.sol#319)\n",
            "name": "reentrancy-benign",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "GNTPaymentChannels",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-golem/golem-contracts-62a1e0dab3baf8e9bff79b653dffa7df5f2d10a0/contracts/GNTPaymentChannels.sol",
            "function": "fund",
            "impact": "Low",
            "line": 524,
            "line_end": 537,
            "message": "Reentrancy in GNTPaymentChannels.fund(bytes32,uint256) (GNTPaymentChannels.sol#524-537):\n\tExternal calls:\n\t- token.transferFrom(msg.sender,address(this),_amount) (GNTPaymentChannels.sol#530)\n\tEvent emitted after the call(s):\n\t- Fund(ch.receiver,_channel,_amount) (GNTPaymentChannels.sol#533)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "GNTPaymentChannels",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-golem/golem-contracts-62a1e0dab3baf8e9bff79b653dffa7df5f2d10a0/contracts/GNTPaymentChannels.sol",
            "function": "_do_close",
            "impact": "Low",
            "line": 597,
            "line_end": 612,
            "message": "Reentrancy in GNTPaymentChannels._do_close(bytes32,bool) (GNTPaymentChannels.sol#597-612):\n\tExternal calls:\n\t- token.transfer(ch.owner,amount) (GNTPaymentChannels.sol#603)\n\tEvent emitted after the call(s):\n\t- Close(ch.owner,ch.receiver,_channel) (GNTPaymentChannels.sol#607)\n\t- ForceClose(ch.owner,ch.receiver,_channel) (GNTPaymentChannels.sol#605)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TokenProxy",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-golem/golem-contracts-62a1e0dab3baf8e9bff79b653dffa7df5f2d10a0/contracts/GNTPaymentChannels.sol",
            "function": "withdrawTo",
            "impact": "Low",
            "line": 329,
            "line_end": 340,
            "message": "Reentrancy in TokenProxy.withdrawTo(uint256,address) (GNTPaymentChannels.sol#329-340):\n\tExternal calls:\n\t- TOKEN.transfer(_destination,_value) (GNTPaymentChannels.sol#337)\n\tEvent emitted after the call(s):\n\t- Burned(user,_value) (GNTPaymentChannels.sol#339)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "GNTPaymentChannels",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-golem/golem-contracts-62a1e0dab3baf8e9bff79b653dffa7df5f2d10a0/contracts/GNTPaymentChannels.sol",
            "function": "_do_withdraw",
            "impact": "Low",
            "line": 584,
            "line_end": 595,
            "message": "Reentrancy in GNTPaymentChannels._do_withdraw(bytes32,uint256) (GNTPaymentChannels.sol#584-595):\n\tExternal calls:\n\t- token.transfer(ch.receiver,_amount) (GNTPaymentChannels.sol#589)\n\tEvent emitted after the call(s):\n\t- Withdraw(ch.owner,ch.receiver) (GNTPaymentChannels.sol#591)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "TokenProxy",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-golem/golem-contracts-62a1e0dab3baf8e9bff79b653dffa7df5f2d10a0/contracts/GNTPaymentChannels.sol",
            "function": "transferFromGate",
            "impact": "Low",
            "line": 305,
            "line_end": 323,
            "message": "Reentrancy in TokenProxy.transferFromGate() (GNTPaymentChannels.sol#305-323):\n\tExternal calls:\n\t- value = TOKEN.balanceOf(gate) (GNTPaymentChannels.sol#313)\n\t- Gate(gate).transferToProxy(value) (GNTPaymentChannels.sol#315)\n\tEvent emitted after the call(s):\n\t- Minted(user,value) (GNTPaymentChannels.sol#322)\n",
            "name": "reentrancy-events",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "GNTPaymentChannels",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-golem/golem-contracts-62a1e0dab3baf8e9bff79b653dffa7df5f2d10a0/contracts/GNTPaymentChannels.sol",
            "function": "isLocked",
            "impact": "Low",
            "line": 482,
            "line_end": 484,
            "message": "GNTPaymentChannels.isLocked(bytes32) (GNTPaymentChannels.sol#482-484) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- channels[_channel].locked_until == 0 (GNTPaymentChannels.sol#483)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "GNTPaymentChannels",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-golem/golem-contracts-62a1e0dab3baf8e9bff79b653dffa7df5f2d10a0/contracts/GNTPaymentChannels.sol",
            "function": "forceClose",
            "impact": "Low",
            "line": 575,
            "line_end": 580,
            "message": "GNTPaymentChannels.forceClose(bytes32) (GNTPaymentChannels.sol#575-580) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool)(msg.sender == channels[_channel].receiver) (GNTPaymentChannels.sol#578)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "GNTPaymentChannels",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-golem/golem-contracts-62a1e0dab3baf8e9bff79b653dffa7df5f2d10a0/contracts/GNTPaymentChannels.sol",
            "function": "isUnlocked",
            "impact": "Low",
            "line": 490,
            "line_end": 493,
            "message": "GNTPaymentChannels.isUnlocked(bytes32) (GNTPaymentChannels.sol#490-493) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- ((channels[_channel].locked_until != 0) && (channels[_channel].locked_until < block.timestamp)) (GNTPaymentChannels.sol#491-492)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "GNTPaymentChannels",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-golem/golem-contracts-62a1e0dab3baf8e9bff79b653dffa7df5f2d10a0/contracts/GNTPaymentChannels.sol",
            "function": "isTimeLocked",
            "impact": "Low",
            "line": 486,
            "line_end": 488,
            "message": "GNTPaymentChannels.isTimeLocked(bytes32) (GNTPaymentChannels.sol#486-488) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- channels[_channel].locked_until >= block.timestamp (GNTPaymentChannels.sol#487)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "GolemNetworkTokenBatching",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-golem/golem-contracts-62a1e0dab3baf8e9bff79b653dffa7df5f2d10a0/contracts/GNTPaymentChannels.sol",
            "function": "batchTransfer",
            "impact": "Low",
            "line": 365,
            "line_end": 384,
            "message": "GolemNetworkTokenBatching.batchTransfer(bytes32[],uint64) (GNTPaymentChannels.sol#365-384) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool)(block.timestamp >= closureTime) (GNTPaymentChannels.sol#366)\n",
            "name": "timestamp",
            "check": "FP"
        },
        {
            "confidence": "Medium",
            "contract": "GNTPaymentChannels",
            "filename": "Dapp_dataset/positive/DAppSCAN-source/contracts/Trail_of_Bits-golem/golem-contracts-62a1e0dab3baf8e9bff79b653dffa7df5f2d10a0/contracts/GNTPaymentChannels.sol",
            "function": "isValidSig",
            "impact": "Low",
            "line": 495,
            "line_end": 498,
            "message": "GNTPaymentChannels.isValidSig(bytes32,uint256,uint8,bytes32,bytes32) (GNTPaymentChannels.sol#495-498) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- (channels[_ch].owner) == (ecrecover(bytes32,uint8,bytes32,bytes32)(sha3()(_ch,_value),_v,_r,_s)) (GNTPaymentChannels.sol#497)\n",
            "name": "timestamp",
            "check": "FP"
        }
    ],
    "infos": [],
    "parser": {
        "id": "slither-0.10.0",
        "mode": "solidity",
        "version": "2024/04/30"
    }
}