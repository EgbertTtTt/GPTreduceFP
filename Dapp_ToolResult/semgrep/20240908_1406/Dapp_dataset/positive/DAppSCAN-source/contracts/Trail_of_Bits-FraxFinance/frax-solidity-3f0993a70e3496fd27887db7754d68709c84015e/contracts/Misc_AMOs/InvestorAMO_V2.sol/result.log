METRICS: Using configs from the Registry (like --config=p/ci) reports pseudonymous rule metrics to semgrep.dev.
To disable Registry rule metrics, use "--metrics=off".
Using configs only from local files (like --config=xyz.yml) does not enable metrics.

More information: https://semgrep.dev/docs/metrics

               
               
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Scan Status â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  Scanning 1 file tracked by git with 48 Code rules:
  Scanning 1 file with 48 solidity rules.
                     
                     
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 201 Code Findings â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           
    /sb/InvestorAMO_V2.sol 
       solidity.performance.array-length-outside-loop                           
          Caching the array length outside a loop saves reading it on each      
  iteration, as long as the                                                     
          array's length is not changed during the loop.                        
                                                                                
         2056â”† for (uint i; i < path.length - 1; i++) {
            â‹®â”†----------------------------------------
         2067â”† for (uint i = path.length - 1; i > 0; i--) {
            â‹®â”†----------------------------------------
         2404â”† for (uint i = 0; i < frax_pools_array.length; i++){
            â‹®â”†----------------------------------------
         2472â”† for (uint i = 0; i < frax_pools_array.length; i++){
            â‹®â”†----------------------------------------
       solidity.performance.init-variables-with-default-value                   
          Uninitialized variables are assigned with the types default value.    
  Explicitly initializing a                                                     
          variable with its default value costs unnecessary gas.                
                                                                                
         2084â”† bool public ALLOW_STALE_CONSULTS = false; // If false, consult() 
  will fail if the TWAP is stale                                                
            â‹®â”†----------------------------------------
         2298â”† bool public collateral_ratio_paused = false;
            â‹®â”†----------------------------------------
         2724â”† uint256 public pool_ceiling = 0;
            â‹®â”†----------------------------------------
         2727â”† uint256 public pausedPrice = 0;
            â‹®â”†----------------------------------------
         2743â”† bool public mintPaused = false;
            â‹®â”†----------------------------------------
         2744â”† bool public redeemPaused = false;
            â‹®â”†----------------------------------------
         2745â”† bool public recollateralizePaused = false;
            â‹®â”†----------------------------------------
         2746â”† bool public buyBackPaused = false;
            â‹®â”†----------------------------------------
         2747â”† bool public collateralPricePaused = false;
            â‹®â”†----------------------------------------
       solidity.performance.non-payable-constructor      
          Consider making costructor payable to save gas.
                                                         
          174â”† constructor () internal { }
            â‹®â”†----------------------------------------
          769â”† constructor (string memory name, string memory symbol) public {
          770â”†     _name = name;
          771â”†     _symbol = symbol;
          772â”†     _decimals = 18;
          773â”† }
            â‹®â”†----------------------------------------
         1562â”† constructor(
         1563â”†     string memory _name,
         1564â”†     string memory _symbol,
         1565â”†     address _oracle_address,
         1566â”†     address _owner_address,
         1567â”†     address _timelock_address
         1568â”† ) public {
         1569â”†     name = _name;
         1570â”†     symbol = _symbol;
         1571â”†     owner_address = _owner_address;
             [hid 8 additional lines, adjust with --max-lines-per-finding] 
         2101â”† constructor(address factory, address tokenA, address tokenB,     
  address _owner_address, address _timelock_address) public {                   
         2102â”†     IUniswapV2Pair _pair =                                       
  IUniswapV2Pair(UniswapV2Library.pairFor(factory, tokenA, tokenB));            
         2103â”†     pair = _pair;
         2104â”†     token0 = _pair.token0();
         2105â”†     token1 = _pair.token1();
         2106â”†     price0CumulativeLast = _pair.price0CumulativeLast(); // Fetch
  the current accumulated price value (1 / 0)                                   
         2107â”†     price1CumulativeLast = _pair.price1CumulativeLast(); // Fetch
  the current accumulated price value (0 / 1)                                   
         2108â”†     uint112 reserve0;
         2109â”†     uint112 reserve1;
         2110â”†     (reserve0, reserve1, blockTimestampLast) =                   
  _pair.getReserves();                                                          
             [hid 5 additional lines, adjust with --max-lines-per-finding] 
         2216â”† constructor() public {
         2217â”†     priceFeed =                                                  
  AggregatorV3Interface(0x5f4eC3Df9cbd43714FE2740f5E3616155c5b8419);            
         2218â”† }
            â‹®â”†----------------------------------------
         2328â”† constructor(
         2329â”†     string memory _name,
         2330â”†     string memory _symbol,
         2331â”†     address _creator_address,
         2332â”†     address _timelock_address
         2333â”† ) public {
         2334â”†     name = _name;
         2335â”†     symbol = _symbol;
         2336â”†     creator_address = _creator_address;
         2337â”†     timelock_address = _timelock_address;
             [hid 12 additional lines, adjust with --max-lines-per-finding] 
         2768â”† constructor(
         2769â”†     address _frax_contract_address,
         2770â”†     address _fxs_contract_address,
         2771â”†     address _collateral_address,
         2772â”†     address _creator_address,
         2773â”†     address _timelock_address,
         2774â”†     uint256 _pool_ceiling
         2775â”† ) public {
         2776â”†     FRAX = FRAXStablecoin(_frax_contract_address);
         2777â”†     FXS = FRAXShares(_fxs_contract_address);
             [hid 16 additional lines, adjust with --max-lines-per-finding] 
         3199â”† constructor(address account) public {
         3200â”†     balances[account] = uint96(totalSupply);
         3201â”†     emit Transfer(address(0), account, totalSupply);
         3202â”† }
            â‹®â”†----------------------------------------
         3750â”† constructor(
         3751â”†     address _frax_contract_address,
         3752â”†     address _fxs_contract_address,
         3753â”†     address _pool_address,
         3754â”†     address _collateral_address,
         3755â”†     address _owner_address,
         3756â”†     address _custodian_address,
         3757â”†     address _timelock_address
         3758â”† ) public {
         3759â”†     FRAX = FRAXStablecoin(_frax_contract_address);
             [hid 40 additional lines, adjust with --max-lines-per-finding] 
       solidity.performance.state-variable-read-in-a-loop                       
          Replace state variable reads and writes within loops with local       
  variable reads and writes.                                                    
                                                                                
         1704â”† Checkpoint memory cp = checkpoints[account][center];
            â‹®â”†----------------------------------------
         2404â”† for (uint i = 0; i < frax_pools_array.length; i++){
            â‹®â”†----------------------------------------
         2406â”† if (frax_pools_array[i] != address(0)){
            â‹®â”†----------------------------------------
         2407â”† total_collateral_value_d18 =                                     
  total_collateral_value_d18.add(FraxPool(frax_pools_array[i]).collatDollarBalan
  ce());                                                                        
            â‹®â”†----------------------------------------
         2472â”† for (uint i = 0; i < frax_pools_array.length; i++){
            â‹®â”†----------------------------------------
         2473â”† if (frax_pools_array[i] == pool_address) {
            â‹®â”†----------------------------------------
         2474â”† frax_pools_array[i] = address(0); // This will leave a null in   
  the array and keep the indices the same                                       
            â‹®â”†----------------------------------------
         3347â”† Checkpoint memory cp = checkpoints[account][center];
            â‹®â”†----------------------------------------
       solidity.performance.unnecessary-checked-arithmetic-in-loop              
          A lot of times there is no risk that the loop counter can overflow.   
  Using Solidity's                                                              
          unchecked block saves the overflow checks.                            
                                                                                
         2056â”† for (uint i; i < path.length - 1; i++) {
            â‹®â”†----------------------------------------
         2404â”† for (uint i = 0; i < frax_pools_array.length; i++){
            â‹®â”†----------------------------------------
         2472â”† for (uint i = 0; i < frax_pools_array.length; i++){
            â‹®â”†----------------------------------------
         3811â”† for (uint i = 0; i < 4; i++){
            â‹®â”†----------------------------------------
       solidity.performance.use-custom-error-not-require                        
          Consider using custom errors as they are more gas efficient while     
  allowing developers  to                                                       
          describe the error in detail using NatSpec.                           
                                                                                
           31â”† require(c >= a, "SafeMath: addition overflow");
            â‹®â”†----------------------------------------
           85â”† require(c / a == b, "SafeMath: multiplication overflow");
            â‹®â”†----------------------------------------
          310â”† require(address(this).balance >= amount, "Address: insufficient  
  balance");                                                                    
            â‹®â”†----------------------------------------
          314â”† require(success, "Address: unable to send value, recipient may   
  have reverted");                                                              
            â‹®â”†----------------------------------------
          371â”† require(address(this).balance >= value, "Address: insufficient   
  balance for call");                                                           
            â‹®â”†----------------------------------------
          372â”† require(isContract(target), "Address: call to non-contract");
            â‹®â”†----------------------------------------
          396â”† require(isContract(target), "Address: static call to             
  non-contract");                                                               
            â‹®â”†----------------------------------------
          420â”† require(isContract(target), "Address: delegate call to           
  non-contract");                                                               
            â‹®â”†----------------------------------------
          596â”† require(sender != address(0), "ERC20: transfer from the zero     
  address");                                                                    
            â‹®â”†----------------------------------------
          597â”† require(recipient != address(0), "ERC20: transfer to the zero    
  address");                                                                    
            â‹®â”†----------------------------------------
          616â”† require(account != address(0), "ERC20: mint to the zero          
  address");                                                                    
            â‹®â”†----------------------------------------
          665â”† require(account != address(0), "ERC20: burn from the zero        
  address");                                                                    
            â‹®â”†----------------------------------------
          688â”† require(owner != address(0), "ERC20: approve from the zero       
  address");                                                                    
            â‹®â”†----------------------------------------
          689â”† require(spender != address(0), "ERC20: approve to the zero       
  address");                                                                    
            â‹®â”†----------------------------------------
          922â”† require(sender != address(0), "ERC20: transfer from the zero     
  address");                                                                    
            â‹®â”†----------------------------------------
          923â”† require(recipient != address(0), "ERC20: transfer to the zero    
  address");                                                                    
            â‹®â”†----------------------------------------
          942â”† require(account != address(0), "ERC20: mint to the zero          
  address");                                                                    
            â‹®â”†----------------------------------------
          991â”† require(account != address(0), "ERC20: burn from the zero        
  address");                                                                    
            â‹®â”†----------------------------------------
         1014â”† require(owner != address(0), "ERC20: approve from the zero       
  address");                                                                    
            â‹®â”†----------------------------------------
         1015â”† require(spender != address(0), "ERC20: approve to the zero       
  address");                                                                    
            â‹®â”†----------------------------------------
         1175â”† require(set._values.length > index, "EnumerableSet: index out of 
  bounds");                                                                     
            â‹®â”†----------------------------------------
         1416â”† require(hasRole(_roles[role].adminRole, _msgSender()),           
  "AccessControl: sender must be an admin to grant");                           
            â‹®â”†----------------------------------------
         1431â”† require(hasRole(_roles[role].adminRole, _msgSender()),           
  "AccessControl: sender must be an admin to revoke");                          
            â‹®â”†----------------------------------------
         1451â”† require(account == _msgSender(), "AccessControl: can only        
  renounce roles for self");                                                    
            â‹®â”†----------------------------------------
         1551â”† require(FRAX.frax_pools(msg.sender) == true, "Only frax pools can
  mint new FRAX");                                                              
            â‹®â”†----------------------------------------
         1556â”† require(msg.sender == owner_address || msg.sender ==             
  timelock_address, "You are not an owner or the governance timelock");         
            â‹®â”†----------------------------------------
         1683â”† require(blockNumber < block.number, "FXS::getPriorVotes: not yet 
  determined");                                                                 
            â‹®â”†----------------------------------------
         1919â”† require(x != 0, 'FixedPoint: DIV_BY_ZERO');
            â‹®â”†----------------------------------------
         1927â”† require(y == 0 || (z = uint(self._x) * y) / y == uint(self._x),  
  "FixedPoint: MULTIPLICATION_OVERFLOW");                                       
            â‹®â”†----------------------------------------
         1934â”† require(denominator > 0, "FixedPoint: DIV_BY_ZERO");
            â‹®â”†----------------------------------------
         1950â”† require(self._x != 0, 'FixedPoint: ZERO_RECIPROCAL');
            â‹®â”†----------------------------------------
         1996â”† require(tokenA != tokenB, 'UniswapV2Library:                     
  IDENTICAL_ADDRESSES');                                                        
            â‹®â”†----------------------------------------
         1998â”† require(token0 != address(0), 'UniswapV2Library: ZERO_ADDRESS');
            â‹®â”†----------------------------------------
         2027â”† require(amountA > 0, 'UniswapV2Library: INSUFFICIENT_AMOUNT');
            â‹®â”†----------------------------------------
         2028â”† require(reserveA > 0 && reserveB > 0, 'UniswapV2Library:         
  INSUFFICIENT_LIQUIDITY');                                                     
            â‹®â”†----------------------------------------
         2034â”† require(amountIn > 0, 'UniswapV2Library:                         
  INSUFFICIENT_INPUT_AMOUNT');                                                  
            â‹®â”†----------------------------------------
         2035â”† require(reserveIn > 0 && reserveOut > 0, 'UniswapV2Library:      
  INSUFFICIENT_LIQUIDITY');                                                     
            â‹®â”†----------------------------------------
         2044â”† require(amountOut > 0, 'UniswapV2Library:                        
  INSUFFICIENT_OUTPUT_AMOUNT');                                                 
            â‹®â”†----------------------------------------
         2045â”† require(reserveIn > 0 && reserveOut > 0, 'UniswapV2Library:      
  INSUFFICIENT_LIQUIDITY');                                                     
            â‹®â”†----------------------------------------
         2053â”† require(path.length >= 2, 'UniswapV2Library: INVALID_PATH');
            â‹®â”†----------------------------------------
         2064â”† require(path.length >= 2, 'UniswapV2Library: INVALID_PATH');
            â‹®â”†----------------------------------------
         2097â”† require(msg.sender == owner_address || msg.sender ==             
  timelock_address, "You are not an owner or the governance timelock");         
            â‹®â”†----------------------------------------
         2111â”† require(reserve0 != 0 && reserve1 != 0, 'UniswapPairOracle:      
  NO_RESERVES'); // Ensure that there's liquidity in the pair                   
            â‹®â”†----------------------------------------
         2150â”† require(timeElapsed >= PERIOD, 'UniswapPairOracle:               
  PERIOD_NOT_ELAPSED');                                                         
            â‹®â”†----------------------------------------
         2168â”† require((timeElapsed < (PERIOD + CONSULT_LENIENCY)) ||           
  ALLOW_STALE_CONSULTS, 'UniswapPairOracle:                                     
  PRICE_IS_STALE_NEED_TO_CALL_UPDATE');                                         
            â‹®â”†----------------------------------------
         2173â”† require(token == token1, 'UniswapPairOracle: INVALID_TOKEN');
            â‹®â”†----------------------------------------
         2308â”† require(frax_pools[msg.sender] == true, "Only frax pools can call
  this function");                                                              
            â‹®â”†----------------------------------------
         2313â”† require(msg.sender == owner_address || msg.sender ==             
  timelock_address || msg.sender == controller_address, "You are not the owner, 
  controller, or the governance ... [0m                                         
                
                
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Scan Summary â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ran 48 rules on 1 file: 201 findings.
            [shortened a long line from output, adjust with                     
  --max-chars-per-line]                                                         
            â‹®â”†----------------------------------------
         2318â”† require(
         2319â”†     msg.sender == owner_address
         2320â”†     || msg.sender == timelock_address
         2321â”†     || frax_pools[msg.sender] == true,
         2322â”†     "You are not the owner, the governance timelock, or a pool");
            â‹®â”†----------------------------------------
         2365â”† else revert("INVALID PRICE CHOICE. Needs to be either 0 (FRAX) or
  1 (FXS)");                                                                    
            â‹®â”†----------------------------------------
         2419â”† require(collateral_ratio_paused == false, "Collateral Ratio has  
  been paused");                                                                
            â‹®â”†----------------------------------------
         2421â”† require(block.timestamp - last_call_time >= refresh_cooldown,    
  "Must wait for the refresh cooldown since last refresh");                     
            â‹®â”†----------------------------------------
         2458â”† require(frax_pools[pool_address] == false, "address already      
  exists");                                                                     
            â‹®â”†----------------------------------------
         2465â”† require(frax_pools[pool_address] == true, "address doesn't exist 
  already");                                                                    
            â‹®â”†----------------------------------------
         2619â”† require(params.excess_collateral_dollar_value_d18 > 0, "No excess
  collateral to buy back!");                                                    
            â‹®â”†----------------------------------------
         2623â”† require(fxs_dollar_value_d18 <=                                  
  params.excess_collateral_dollar_value_d18, "You are trying to buy back more   
  than the excess!");                                                           
            â‹®â”†----------------------------------------
         2752â”† require(msg.sender == timelock_address || msg.sender ==          
  owner_address, "You are not the owner or the governance timelock");           
            â‹®â”†----------------------------------------
         2757â”† require(redeemPaused == false, "Redeeming is paused");
            â‹®â”†----------------------------------------
         2762â”† require(mintPaused == false, "Minting is paused");
            â‹®â”†----------------------------------------
         2844â”† require(FRAX.global_collateral_ratio() >= COLLATERAL_RATIO_MAX,  
  "Collateral ratio must be >= 1");                                             
            â‹®â”†----------------------------------------
         2845â”†                                                                  
  require((collateral_token.balanceOf(address(this))).sub(unclaimedPoolCollatera
  l).add(collateral_amount) <= pool_ceiling, "[Pool's Closed]: Ceiling          
  reached");                                                                    
            â‹®â”†----------------------------------------
         2853â”† require(FRAX_out_min <= frax_amount_d18, "Slippage limit         
  reached");                                                                    
            â‹®â”†----------------------------------------
         2863â”† require(FRAX.global_collateral_ratio() == 0, "Collateral ratio   
  must be 0");                                                                  
            â‹®â”†----------------------------------------
         2871â”† require(FRAX_out_min <= frax_amount_d18, "Slippage limit         
  reached");                                                                    
            â‹®â”†----------------------------------------
         2883â”† require(global_collateral_ratio < COLLATERAL_RATIO_MAX &&        
  global_collateral_ratio > 0, "Collateral ratio needs to be between .000001 and
  .999999");                                                                    
            â‹®â”†----------------------------------------
         2884â”†                                                                  
  require(collateral_token.balanceOf(address(this)).sub(unclaimedPoolCollateral)
  .add(collateral_amount) <= pool_ceiling, "Pool ceiling reached, no more FRAX  
  can b ... [0m                                                                 
            [shortened a long line from output, adjust with                     
  --max-chars-per-line]                                                         
            â‹®â”†----------------------------------------
         2898â”† require(FRAX_out_min <= mint_amount, "Slippage limit reached");
            â‹®â”†----------------------------------------
         2899â”† require(fxs_needed <= fxs_amount, "Not enough FXS inputted");
            â‹®â”†----------------------------------------
         2909â”† require(FRAX.global_collateral_ratio() == COLLATERAL_RATIO_MAX,  
  "Collateral ratio must be == 1");                                             
            â‹®â”†----------------------------------------
         2919â”† require(collateral_needed <=                                     
  collateral_token.balanceOf(address(this)).sub(unclaimedPoolCollateral), "Not  
  enough collateral in pool");                                                  
            â‹®â”†----------------------------------------
         2920â”† require(COLLATERAL_out_min <= collateral_needed, "Slippage limit 
  reached");                                                                    
            â‹®â”†----------------------------------------
         2936â”† require(global_collateral_ratio < COLLATERAL_RATIO_MAX &&        
  global_collateral_ratio > 0, "Collateral ratio needs to be between .000001 and
  .999999");                                                                    
            â‹®â”†----------------------------------------
         2950â”† require(collateral_amount <=                                     
  collateral_token.balanceOf(address(this)).sub(unclaimedPoolCollateral), "Not  
  enough collateral in pool");                                                  
            â‹®â”†----------------------------------------
         2951â”† require(COLLATERAL_out_min <= collateral_amount, "Slippage limit 
  reached [collateral]");                                                       
            â‹®â”†----------------------------------------
         2952â”† require(FXS_out_min <= fxs_amount, "Slippage limit reached       
  [FXS]");                                                                      
            â‹®â”†----------------------------------------
         2972â”† require(global_collateral_ratio == 0, "Collateral ratio must be  
  0");                                                                          
            â‹®â”†----------------------------------------
         2984â”† require(FXS_out_min <= fxs_amount, "Slippage limit reached");
            â‹®â”†----------------------------------------
         2994â”† require((lastRedeemed[msg.sender].add(redemption_delay)) <=      
  block.number, "Must wait for redemption_delay blocks before collecting        
  redemption");                                                                 
            â‹®â”†----------------------------------------
         3033â”† require(recollateralizePaused == false, "Recollateralize is      
  paused");                                                                     
            â‹®â”†----------------------------------------
         3052â”† require(FXS_out_min <= fxs_paid_back, "Slippage limit reached");
            â‹®â”†----------------------------------------
         3062â”† require(buyBackPaused == false, "Buyback is paused");
            â‹®â”†----------------------------------------
         3075â”† require(COLLATERAL_out_min <= collateral_precision, "Slippage    
  limit reached");                                                              
            â‹®â”†----------------------------------------
         3302â”† require(signatory != address(0), "Comp::delegateBySig: invalid   
  signature");                                                                  
            â‹®â”†----------------------------------------
         3303â”† require(nonce == nonces[signatory]++, "Comp::delegateBySig:      
  invalid nonce");                                                              
            â‹®â”†----------------------------------------
         3304â”† require(now <= expiry, "Comp::delegateBySig: signature expired");
            â‹®â”†----------------------------------------
         3326â”† require(blockNumber < block.number, "Comp::getPriorVotes: not yet
  determined");                                                                 
            â‹®â”†----------------------------------------
         3370â”† require(src != address(0), "Comp::_transferTokens: cannot        
  transfer from the zero address");                                             
            â‹®â”†----------------------------------------
         3371â”† require(dst != address(0), "Comp::_transferTokens: cannot        
  transfer to the zero address");                                               
            â‹®â”†----------------------------------------
         3739â”† require(msg.sender == timelock_address || msg.sender ==          
  owner_address, "You are not the owner or the governance timelock");           
            â‹®â”†----------------------------------------
         3744â”† require(msg.sender == custodian_address, "You are not the rewards
  custodian");                                                                  
            â‹®â”†----------------------------------------
         3868â”† require(allow_yearn || allow_aave || allow_compound, 'All        
  strategies are currently off');                                               
            â‹®â”†----------------------------------------
         3876â”† require(borrowed_balance.add(expected_collat_amount) <=          
  borrow_cap, "Borrow cap reached");                                            
            â‹®â”†----------------------------------------
         3914â”† require(allow_yearn, 'yearn strategy is currently off');
            â‹®â”†----------------------------------------
         3927â”† require(allow_aave, 'AAVE strategy is currently off');
            â‹®â”†----------------------------------------
         3959â”† require(allow_compound, 'Compound strategy is currently off');
            â‹®â”†----------------------------------------
       solidity.performance.use-multiple-require                                
          Using multiple require statements is cheaper than using && multiple   
  check combinations.                                                           
          There are more advantages, such as easier to read code and better     
  coverage reports.                                                             
                                                                                
         2028â”† require(reserveA > 0 && reserveB > 0, 'UniswapV2Library:         
  INSUFFICIENT_LIQUIDITY');                                                     
            â‹®â”†----------------------------------------
         2035â”† require(reserveIn > 0 && reserveOut > 0, 'UniswapV2Library:      
  INSUFFICIENT_LIQUIDITY');                                                     
            â‹®â”†----------------------------------------
         2045â”† require(reserveIn > 0 && reserveOut > 0, 'UniswapV2Library:      
  INSUFFICIENT_LIQUIDITY');                                                     
            â‹®â”†----------------------------------------
         2111â”† require(reserve0 != 0 && reserve1 != 0, 'UniswapPairOracle:      
  NO_RESERVES'); // Ensure that there's liquidity in the pair                   
            â‹®â”†----------------------------------------
         2883â”† require(global_collateral_ratio < COLLATERAL_RATIO_MAX &&        
  global_collateral_ratio > 0, "Collateral ratio needs to be between .000001 and
  .999999");                                                                    
            â‹®â”†----------------------------------------
         2936â”† require(global_collateral_ratio < COLLATERAL_RATIO_MAX &&        
  global_collateral_ratio > 0, "Collateral ratio needs to be between .000001 and
  .999999");                                                                    
            â‹®â”†----------------------------------------
       solidity.performance.use-nested-if                                       
          Using nested is cheaper than using && multiple check combinations.    
  There are more                                                                
          advantages, such as easier to read code and better coverage reports.  
                                                                                
         1721â”† if (srcRep != dstRep && amount > 0) {
         1722â”†     if (srcRep != address(0)) {
         1723â”†         uint32 srcRepNum = numCheckpoints[srcRep];
         1724â”†         uint96 srcRepOld = srcRepNum > 0 ?                       
  checkpoints[srcRep][srcRepNum - 1].votes : 0;                                 
         1725â”†         uint96 srcRepNew = sub96(srcRepOld, amount,              
  "FXS::_moveVotes: vote amount underflows");                                   
         1726â”†         _writeCheckpoint(srcRep, srcRepNum, srcRepOld,           
  srcRepNew);                                                                   
         1727â”†     }
         1728â”† 
         1729â”†     if (dstRep != address(0)) {
         1730â”†         uint32 dstRepNum = numCheckpoints[dstRep];
             [hid 5 additional lines, adjust with --max-lines-per-finding] 
         1741â”† if (nCheckpoints > 0 && checkpoints[voter][nCheckpoints -        
  1].fromBlock == blockNumber) {                                                
         1742â”†     checkpoints[voter][nCheckpoints - 1].votes = newVotes;
         1743â”† } else {
         1744â”†     checkpoints[voter][nCheckpoints] = Checkpoint(blockNumber,   
  newVotes);                                                                    
         1745â”†     numCheckpoints[voter] = nCheckpoints + 1;
         1746â”† }
            â‹®â”†----------------------------------------
         3269â”† if (spender != src && spenderAllowance != uint96(-1)) {
         3270â”†     uint96 newAllowance = sub96(spenderAllowance, amount,        
  "Comp::transferFrom: transfer amount exceeds spender allowance");             
         3271â”†     allowances[src][spender] = newAllowance;
         3272â”† 
         3273â”†     emit Approval(src, spender, newAllowance);
         3274â”† }
            â‹®â”†----------------------------------------
         3381â”† if (srcRep != dstRep && amount > 0) {
         3382â”†     if (srcRep != address(0)) {
         3383â”†         uint32 srcRepNum = numCheckpoints[srcRep];
         3384â”†         uint96 srcRepOld = srcRepNum > 0 ?                       
  checkpoints[srcRep][srcRepNum - 1].votes : 0;                                 
         3385â”†         uint96 srcRepNew = sub96(srcRepOld, amount,              
  "Comp::_moveVotes: vote amount underflows");                                  
         3386â”†         _writeCheckpoint(srcRep, srcRepNum, srcRepOld,           
  srcRepNew);                                                                   
         3387â”†     }
         3388â”† 
         3389â”†     if (dstRep != address(0)) {
         3390â”†         uint32 dstRepNum = numCheckpoints[dstRep];
             [hid 5 additional lines, adjust with --max-lines-per-finding] 
         3401â”† if (nCheckpoints > 0 && checkpoints[delegatee][nCheckpoints -    
  1].fromBlock == blockNumber) {                                                
         3402â”†     checkpoints[delegatee][nCheckpoints - 1].votes = newVotes;
         3403â”† } else {
         3404â”†     checkpoints[delegatee][nCheckpoints] =                       
  Checkpoint(blockNumber, newVotes);                                            
         3405â”†     numCheckpoints[delegatee] = nCheckpoints + 1;
         3406â”† }
            â‹®â”†----------------------------------------
       solidity.performance.use-prefix-decrement-not-postfix                    
          Consider using the prefix decrement expression whenever the return    
  value is not needed. The                                                      
          prefix decrement expression is cheaper in terms of gas.               
                                                                                
         2067â”† for (uint i = path.length - 1; i > 0; i--) {
            â‹®â”†----------------------------------------
       solidity.performance.use-prefix-increment-not-postfix                    
          Consider using the prefix increment expression whenever the return    
  value is not needed. The                                                      
          prefix increment expression is cheaper in terms of gas.               
                                                                                
         2056â”† for (uint i; i < path.length - 1; i++) {
            â‹®â”†----------------------------------------
         2404â”† for (uint i = 0; i < frax_pools_array.length; i++){
            â‹®â”†----------------------------------------
         2472â”† for (uint i = 0; i < frax_pools_array.length; i++){
            â‹®â”†----------------------------------------
         3303â”† require(nonce == nonces[signatory]++, "Comp::delegateBySig:      
  invalid nonce");                                                              
            â‹®â”†----------------------------------------
         3811â”† for (uint i = 0; i < 4; i++){
            â‹®â”†----------------------------------------
       solidity.performance.use-short-revert-string                             
          Shortening revert strings to fit in 32 bytes will decrease gas costs  
  for deployment and  gas                                                       
          costs when the revert condition has been met.                         
                                                                                
           85â”† require(c / a == b, "SafeMath: multiplication overflow");
            â‹®â”†----------------------------------------
          314â”† require(success, "Address: unable to send value, recipient may   
  have reverted");                                                              
            â‹®â”†----------------------------------------
          371â”† require(address(this).balance >= value, "Address: insufficient   
  balance for call");                                                           
            â‹®â”†----------------------------------------
          396â”† require(isContract(target), "Address: static call to             
  non-contract");                                                               
            â‹®â”†----------------------------------------
          420â”† require(isContract(target), "Address: delegate call to           
  non-contract");                                                               
            â‹®â”†----------------------------------------
          596â”† require(sender != address(0), "ERC20: transfer from the zero     
  address");                                                                    
            â‹®â”†----------------------------------------
          597â”† require(recipient != address(0), "ERC20: transfer to the zero    
  address");                                                                    
            â‹®â”†----------------------------------------
          665â”† require(account != address(0), "ERC20: burn from the zero        
  address");                                                                    
            â‹®â”†----------------------------------------
          688â”† require(owner != address(0), "ERC20: approve from the zero       
  address");                                                                    
            â‹®â”†----------------------------------------
          689â”† require(spender != address(0), "ERC20: approve to the zero       
  address");                                                                    
            â‹®â”†----------------------------------------
          922â”† require(sender != address(0), "ERC20: transfer from the zero     
  address");                                                                    
            â‹®â”†----------------------------------------
          923â”† require(recipient != address(0), "ERC20: transfer to the zero    
  address");                                                                    
            â‹®â”†----------------------------------------
          991â”† require(account != address(0), "ERC20: burn from the zero        
  address");                                                                    
            â‹®â”†----------------------------------------
         1014â”† require(owner != address(0), "ERC20: approve from the zero       
  address");                                                                    
            â‹®â”†----------------------------------------
         1015â”† require(spender != address(0), "ERC20: approve to the zero       
  address");                                                                    
            â‹®â”†----------------------------------------
         1175â”† require(set._values.length > index, "EnumerableSet: index out of 
  bounds");                                                                     
            â‹®â”†----------------------------------------
         1416â”† require(hasRole(_roles[role].adminRole, _msgSender()),           
  "AccessControl: sender must be an admin to grant");                           
            â‹®â”†----------------------------------------
         1431â”† require(hasRole(_roles[role].adminRole, _msgSender()),           
  "AccessControl: sender must be an admin to revoke");                          
            â‹®â”†----------------------------------------
         1451â”† require(account == _msgSender(), "AccessControl: can only        
  renounce roles for self");                                                    
            â‹®â”†----------------------------------------
         1551â”† require(FRAX.frax_pools(msg.sender) == true, "Only frax pools can
  mint new FRAX");                                                              
            â‹®â”†----------------------------------------
         1556â”† require(msg.sender == owner_address || msg.sender ==             
  timelock_address, "You are not an owner or the governance timelock");         
            â‹®â”†----------------------------------------
         1683â”† require(blockNumber < block.number, "FXS::getPriorVotes: not yet 
  determined");                                                                 
            â‹®â”†----------------------------------------
         1927â”† require(y == 0 || (z = uint(self._x) * y) / y == uint(self._x),  
  "FixedPoint: MULTIPLICATION_OVERFLOW");                                       
            â‹®â”†----------------------------------------
         1996â”† require(tokenA != tokenB, 'UniswapV2Library:                     
  IDENTICAL_ADDRESSES');                                                        
            â‹®â”†----------------------------------------
         2027â”† require(amountA > 0, 'UniswapV2Library: INSUFFICIENT_AMOUNT');
            â‹®â”†----------------------------------------
         2028â”† require(reserveA > 0 && reserveB > 0, 'UniswapV2Library:         
  INSUFFICIENT_LIQUIDITY');                                                     
            â‹®â”†----------------------------------------
         2034â”† require(amountIn > 0, 'UniswapV2Library:                         
  INSUFFICIENT_INPUT_AMOUNT');                                                  
            â‹®â”†----------------------------------------
         2035â”† require(reserveIn > 0 && reserveOut > 0, 'UniswapV2Library:      
  INSUFFICIENT_LIQUIDITY');                                                     
            â‹®â”†----------------------------------------
         2044â”† require(amountOut > 0, 'UniswapV2Library:                        
  INSUFFICIENT_OUTPUT_AMOUNT');                                                 
            â‹®â”†----------------------------------------
         2045â”† require(reserveIn > 0 && reserveOut > 0, 'UniswapV2Library:      
  INSUFFICIENT_LIQUIDITY');                                                     
            â‹®â”†----------------------------------------
         2097â”† require(msg.sender == owner_address || msg.sender ==             
  timelock_address, "You are not an owner or the governance timelock");         
            â‹®â”†----------------------------------------
         2150â”† require(timeElapsed >= PERIOD, 'UniswapPairOracle:               
  PERIOD_NOT_ELAPSED');                                                         
            â‹®â”†----------------------------------------
         2168â”† require((timeElapsed < (PERIOD + CONSULT_LENIENCY)) ||           
  ALLOW_STALE_CONSULTS, 'UniswapPairOracle:                                     
  PRICE_IS_STALE_NEED_TO_CALL_UPDATE');                                         
            â‹®â”†----------------------------------------
         2308â”† require(frax_pools[msg.sender] == true, "Only frax pools can call
  this function");                                                              
            â‹®â”†----------------------------------------
         2313â”† require(msg.sender == owner_address || msg.sender ==             
  timelock_address || msg.sender == controller_address, "You are not the owner, 
  controller, or the governance ... [0m                                         
            [shortened a long line from output, adjust with                     
  --max-chars-per-line]                                                         
            â‹®â”†----------------------------------------
         2318â”† require(
         2319â”†     msg.sender == owner_address
         2320â”†     || msg.sender == timelock_address
         2321â”†     || frax_pools[msg.sender] == true,
         2322â”†     "You are not the owner, the governance timelock, or a pool");
            â‹®â”†----------------------------------------
         2365â”† else revert("INVALID PRICE CHOICE. Needs to be either 0 (FRAX) or
  1 (FXS)");                                                                    
            â‹®â”†----------------------------------------
         2421â”† require(block.timestamp - last_call_time >= refresh_cooldown,    
  "Must wait for the refresh cooldown since last refresh");                     
            â‹®â”†----------------------------------------
         2619â”† require(params.excess_collateral_dollar_value_d18 > 0, "No excess
  collateral to buy back!");                                                    
            â‹®â”†----------------------------------------
         2623â”† require(fxs_dollar_value_d18 <=                                  
  params.excess_collateral_dollar_value_d18, "You are trying to buy back more   
  than the excess!");                                                           
            â‹®â”†----------------------------------------
         2752â”† require(msg.sender == timelock_address || msg.sender ==          
  owner_address, "You are not the owner or the governance timelock");           
            â‹®â”†----------------------------------------
         2883â”† require(global_collateral_ratio < COLLATERAL_RATIO_MAX &&        
  global_collateral_ratio > 0, "Collateral ratio needs to be between .000001 and
  .999999");                                                                    
            â‹®â”†----------------------------------------
         2884â”†                                                                  
  require(collateral_token.balanceOf(address(this)).sub(unclaimedPoolCollateral)
  .add(collateral_amount) <= pool_ceiling, "Pool ceiling reached, no more FRAX  
  can b ... [0m                                                                 
            [shortened a long line from output, adjust with                     
  --max-chars-per-line]                                                         
            â‹®â”†----------------------------------------
         2936â”† require(global_collateral_ratio < COLLATERAL_RATIO_MAX &&        
  global_collateral_ratio > 0, "Collateral ratio needs to be between .000001 and
  .999999");                                                                    
            â‹®â”†----------------------------------------
         2951â”† require(COLLATERAL_out_min <= collateral_amount, "Slippage limit 
  reached [collateral]");                                                       
            â‹®â”†----------------------------------------
         2994â”† require((lastRedeemed[msg.sender].add(redemption_delay)) <=      
  block.number, "Must wait for redemption_delay blocks before collecting        
  redemption");                                                                 
            â‹®â”†----------------------------------------
         3302â”† require(signatory != address(0), "Comp::delegateBySig: invalid   
  signature");                                                                  
            â‹®â”†----------------------------------------
         3303â”† require(nonce == nonces[signatory]++, "Comp::delegateBySig:      
  invalid nonce");                                                              
            â‹®â”†----------------------------------------
         3304â”† require(now <= expiry, "Comp::delegateBySig: signature expired");
            â‹®â”†----------------------------------------
         3326â”† require(blockNumber < block.number, "Comp::getPriorVotes: not yet
  determined");                                                                 
            â‹®â”†----------------------------------------
         3370â”† require(src != address(0), "Comp::_transferTokens: cannot        
  transfer from the zero address");                                             
            â‹®â”†----------------------------------------
         3371â”† require(dst != address(0), "Comp::_transferTokens: cannot        
  transfer to the zero address");                                               
            â‹®â”†----------------------------------------
         3739â”† require(msg.sender == timelock_address || msg.sender ==          
  owner_address, "You are not the owner or the governance timelock");           
            â‹®â”†----------------------------------------
         3744â”† require(msg.sender == custodian_address, "You are not the rewards
  custodian");                                                                  
            â‹®â”†----------------------------------------
         3959â”† require(allow_compound, 'Compound strategy is currently off');


A new version of Semgrep is available. See https://semgrep.dev/docs/upgrading

Versions prior to 1.43.0 will cease to work with Semgrep.dev after March 11th 2024, please upgrade.
