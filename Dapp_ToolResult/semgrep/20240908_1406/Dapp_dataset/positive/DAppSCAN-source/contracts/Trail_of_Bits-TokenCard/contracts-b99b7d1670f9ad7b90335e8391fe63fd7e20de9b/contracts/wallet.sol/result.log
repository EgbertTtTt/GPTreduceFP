METRICS: Using configs from the Registry (like --config=p/ci) reports pseudonymous rule metrics to semgrep.dev.
To disable Registry rule metrics, use "--metrics=off".
Using configs only from local files (like --config=xyz.yml) does not enable metrics.

More information: https://semgrep.dev/docs/metrics

               
               
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Scan Status â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  Scanning 1 file tracked by git with 48 Code rules:
  Scanning 1 file with 48 solidity rules.
                     
                     
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 221 Code Findings â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   
    /sb/wallet.sol 
       solidity.best-practice.use-ownable2step                                  
          By demanding that the receiver of the owner permissions actively      
  accept via a contract call                                                    
          of its own,  `Ownable2Step` and `Ownable2StepUpgradeable` prevent the 
  contract ownership                                                            
          from accidentally being transferred  to an address that cannot handle 
  it.                                                                           
                                                                                
          261â”† contract Licence is Claimable, Ownable {
            â‹®â”†----------------------------------------
          500â”† contract Controller is IController, Ownable, Claimable {
            â‹®â”†----------------------------------------
         1784â”† contract TokenWhitelist is ENSResolvable, Controllable, Ownable, 
  Claimable {                                                                   
            â‹®â”†----------------------------------------
         2077â”† contract ControllableOwnable is Controllable, Ownable {
            â‹®â”†----------------------------------------
       solidity.performance.array-length-outside-loop                           
          Caching the array length outside a loop saves reading it on each      
  iteration, as long as the                                                     
          array's length is not changed during the loop.                        
                                                                                
          872â”† if ((contentType & contentTypes) != 0 &&                         
  record.abis[contentType].length > 0) {                                        
            â‹®â”†----------------------------------------
         1744â”† for(i = 0; i < parts.length; i++) {
            â‹®â”†----------------------------------------
         1747â”† if (i < parts.length - 1) {
            â‹®â”†----------------------------------------
         1837â”† for (uint i = 0; i < _tokens.length; i++) {
            â‹®â”†----------------------------------------
         1863â”† for (uint i = 0; i < _tokens.length; i++) {
            â‹®â”†----------------------------------------
         1871â”† for (uint j = 0; j < _tokenAddressArray.length.sub(1); j++) {
            â‹®â”†----------------------------------------
         1873â”† _tokenAddressArray[j] =                                          
  _tokenAddressArray[_tokenAddressArray.length.sub(1)];                         
            â‹®â”†----------------------------------------
         1877â”† _tokenAddressArray.length--;
            â‹®â”†----------------------------------------
         2109â”† for (uint i = 0; i < _addresses.length; i++) {
            â‹®â”†----------------------------------------
         2138â”† for (uint i = 0; i < _addresses.length; i++) {
            â‹®â”†----------------------------------------
         2173â”† for (uint i = 0; i < _pendingWhitelistAddition.length; i++) {
            â‹®â”†----------------------------------------
         2225â”† for (uint i = 0; i < _pendingWhitelistRemoval.length; i++) {
            â‹®â”†----------------------------------------
         2229â”† for (uint j = 0; j < whitelistArray.length.sub(1); j++) {
            â‹®â”†----------------------------------------
         2231â”† whitelistArray[j] = whitelistArray[whitelistArray.length - 1];
            â‹®â”†----------------------------------------
         2235â”† whitelistArray.length--;
            â‹®â”†----------------------------------------
       solidity.performance.non-payable-constructor      
          Consider making costructor payable to save gas.
                                                         
          129â”† constructor(address _account_, bool _transferable_) internal {
          130â”†     _owner = _account_;
          131â”†     _isTransferable = _transferable_;
          132â”†     // Emit the LockedOwnership event if no longer transferable.
          133â”†     if (!_isTransferable) {
          134â”†         emit LockedOwnership(_account_);
          135â”†     }
          136â”†     emit TransferredOwnership(address(0), _account_);
          137â”† }
            â‹®â”†----------------------------------------
          312â”† constructor(address _owner_, bool _transferable_, uint _licence_,
  address _float_, address _holder_, address _tknAddress_) Ownable(_owner_,     
  _transferable_) publ ... [0m                                                  
          313â”†     _licenceAmountScaled = _licence_;
          314â”†     _cryptoFloat = _float_;
          315â”†     _tokenHolder = _holder_;
          316â”†     if (_tknAddress_ != address(0)) {
          317â”†         _tknContractAddress = _tknAddress_;
          318â”†     }
          319â”† }
            [shortened a long line from output, adjust with                     
  --max-chars-per-line]                                                         
            â‹®â”†----------------------------------------
          517â”† constructor(address _ownerAddress_, bool _transferable_)         
  Ownable(_ownerAddress_, _transferable_) public { }                            
            â‹®â”†----------------------------------------
          752â”† constructor(ENS ensAddr) public {
          753â”†     ens = ensAddr;
          754â”† }
            â‹®â”†----------------------------------------
          963â”† constructor(address _ensReg_) internal {
          964â”†     _ensRegistry = _ensReg_;
          965â”†     _ens = ENS(_ensRegistry);
          966â”† }
            â‹®â”†----------------------------------------
         1006â”† constructor(bytes32 _controllerNameHash_) internal {
         1007â”†     _controllerNode = _controllerNameHash_;
         1008â”† }
            â‹®â”†----------------------------------------
         1821â”† constructor(address _ens_, bytes32 _oracleNameHash_, bytes32     
  _controllerNameHash_, address _owner_, bool _transferable_, address           
  _stabelcoinAddress_) ENSResolva ... [0m                                       
         1822â”†     _oracleNode = _oracleNameHash_;
         1823â”†     _stablecoin = _stabelcoinAddress_;
         1824â”† }
            [shortened a long line from output, adjust with                     
  --max-chars-per-line]                                                         
            â‹®â”†----------------------------------------
         1974â”† constructor(bytes32 _tokenWhitelistNameHash_) internal {
         1975â”†     _tokenWhitelistNode = _tokenWhitelistNameHash_;
         1976â”† }
            â‹®â”†----------------------------------------
         2358â”† constructor(uint _limit_) internal {
         2359â”†     _spendLimit = DailyLimit(_limit_, _limit_, now, 0, false);
         2360â”† }
            â‹®â”†----------------------------------------
         2411â”† constructor() internal {
         2412â”†     _gasTopUpLimit = DailyLimit(_MAXIMUM_GAS_TOPUP_LIMIT,        
  _MAXIMUM_GAS_TOPUP_LIMIT, now, 0, false);                                     
         2413â”† }
            â‹®â”†----------------------------------------
         2528â”† constructor(address _owner_, bool _transferable_, bytes32        
  _tokenWhitelistNameHash_, bytes32 _controllerNameHash_, uint _spendLimit_)    
  SpendLimit(_spendLimit_) Ow ... [0m                                           
            [shortened a long line from output, adjust with                     
  --max-chars-per-line]                                                         
            â‹®â”†----------------------------------------
         2628â”† constructor(address _owner_, bool _transferable_, address _ens_, 
  bytes32 _tokenWhitelistNameHash_, bytes32 _controllerNameHash_, bytes32       
  _licenceNameHash_, uint ... [0m                                               
         2629â”†     // Get the stablecoin's magnitude.
         2630â”†     ( ,uint256 stablecoinMagnitude, , , , , ) =                  
  _getStablecoinInfo();                                                         
         2631â”†     require(stablecoinMagnitude > 0, "stablecoin not set");
         2632â”†     _initializeLoadLimit(_DEFAULT_MAX_STABLECOIN_LOAD_LIMIT *    
  stablecoinMagnitude);                                                         
         2633â”†     _licenceNode = _licenceNameHash_;
         2634â”† }
            [shortened a long line from output, adjust with                     
  --max-chars-per-line]                                                         
            â‹®â”†----------------------------------------
       solidity.performance.state-variable-read-in-a-loop                       
          Replace state variable reads and writes within loops with local       
  variable reads and writes.                                                    
                                                                                
         1839â”† require(!_tokenInfoMap[_tokens[i]].available, "token already     
  available");                                                                  
            â‹®â”†----------------------------------------
         1843â”† _tokenInfoMap[_tokens[i]] = Token({
            â‹®â”†----------------------------------------
         1853â”† _tokenAddressArray.push(_tokens[i]);
            â‹®â”†----------------------------------------
         1865â”† require(_tokenInfoMap[_tokens[i]].available, "token is not       
  available");                                                                  
            â‹®â”†----------------------------------------
         1869â”† delete _tokenInfoMap[token];
            â‹®â”†----------------------------------------
         1871â”† for (uint j = 0; j < _tokenAddressArray.length.sub(1); j++) {
            â‹®â”†----------------------------------------
         1872â”† if (_tokenAddressArray[j] == token) {
            â‹®â”†----------------------------------------
         1873â”† _tokenAddressArray[j] =                                          
  _tokenAddressArray[_tokenAddressArray.length.sub(1)];                         
            â‹®â”†----------------------------------------
         1873â”† _tokenAddressArray[j] =                                          
  _tokenAddressArray[_tokenAddressArray.length.sub(1)];                         
            â‹®â”†----------------------------------------
         1873â”† _tokenAddressArray[j] =                                          
  _tokenAddressArray[_tokenAddressArray.length.sub(1)];                         
            â‹®â”†----------------------------------------
         1877â”† _tokenAddressArray.length--;
            â‹®â”†----------------------------------------
         2140â”† whitelistMap[_addresses[i]] = true;
            â‹®â”†----------------------------------------
         2142â”† whitelistArray.push(_addresses[i]);
            â‹®â”†----------------------------------------
         2173â”† for (uint i = 0; i < _pendingWhitelistAddition.length; i++) {
            â‹®â”†----------------------------------------
         2175â”† if (!whitelistMap[_pendingWhitelistAddition[i]]) {
            â‹®â”†----------------------------------------
         2175â”† if (!whitelistMap[_pendingWhitelistAddition[i]]) {
            â‹®â”†----------------------------------------
         2177â”† whitelistMap[_pendingWhitelistAddition[i]] = true;
            â‹®â”†----------------------------------------
         2177â”† whitelistMap[_pendingWhitelistAddition[i]] = true;
            â‹®â”†----------------------------------------
         2178â”† whitelistArray.push(_pendingWhitelistAddition[i]);
            â‹®â”†----------------------------------------
         2178â”† whitelistArray.push(_pendingWhitelistAddition[i]);
            â‹®â”†----------------------------------------
         2225â”† for (uint i = 0; i < _pendingWhitelistRemoval.length; i++) {
            â‹®â”†----------------------------------------
         2227â”† if (whitelistMap[_pendingWhitelistRemoval[i]]) {
            â‹®â”†----------------------------------------
         2227â”† if (whitelistMap[_pendingWhitelistRemoval[i]]) {
            â‹®â”†----------------------------------------
         2228â”† whitelistMap[_pendingWhitelistRemoval[i]] = false;
            â‹®â”†----------------------------------------
         2228â”† whitelistMap[_pendingWhitelistRemoval[i]] = false;
            â‹®â”†----------------------------------------
         2229â”† for (uint j = 0; j < whitelistArray.length.sub(1); j++) {
            â‹®â”†----------------------------------------
         2230â”† if (whitelistArray[j] == _pendingWhitelistRemoval[i]) {
            â‹®â”†----------------------------------------
         2230â”† if (whitelistArray[j] == _pendingWhitelistRemoval[i]) {
            â‹®â”†----------------------------------------
         2231â”† whitelistArray[j] = whitelistArray[whitelistArray.length - 1];
            â‹®â”†----------------------------------------
         2231â”† whitelistArray[j] = whitelistArray[whitelistArray.length - 1];
            â‹®â”†----------------------------------------
         2231â”† whitelistArray[j] = whitelistArray[whitelistArray.length - 1];
            â‹®â”†----------------------------------------
         2235â”† whitelistArray.length--;
            â‹®â”†----------------------------------------
       solidity.performance.unnecessary-checked-arithmetic-in-loop              
          A lot of times there is no risk that the loop counter can overflow.   
  Using Solidity's                                                              
          unchecked block saves the overflow checks.                            
                                                                                
         1366â”† for (uint i = 1; i < length; i++) {
            â‹®â”†----------------------------------------
         1837â”† for (uint i = 0; i < _tokens.length; i++) {
            â‹®â”†----------------------------------------
         1863â”† for (uint i = 0; i < _tokens.length; i++) {
            â‹®â”†----------------------------------------
         1871â”† for (uint j = 0; j < _tokenAddressArray.length.sub(1); j++) {
            â‹®â”†----------------------------------------
         2109â”† for (uint i = 0; i < _addresses.length; i++) {
            â‹®â”†----------------------------------------
         2138â”† for (uint i = 0; i < _addresses.length; i++) {
            â‹®â”†----------------------------------------
         2173â”† for (uint i = 0; i < _pendingWhitelistAddition.length; i++) {
            â‹®â”†----------------------------------------
         2225â”† for (uint i = 0; i < _pendingWhitelistRemoval.length; i++) {
            â‹®â”†----------------------------------------
         2229â”† for (uint j = 0; j < whitelistArray.length.sub(1); j++) {
            â‹®â”†----------------------------------------
         2785â”† for (uint8 i = 0; i < 20; i++) {
            â‹®â”†----------------------------------------
         2803â”† for (uint8 i = 0; i < 4; i++) {
            â‹®â”†----------------------------------------
       solidity.performance.use-custom-error-not-require                        
          Consider using custom errors as they are more gas efficient while     
  allowing developers  to                                                       
          describe the error in detail using NatSpec.                           
                                                                                
          141â”† require(_isOwner(msg.sender), "sender is not an owner");
            â‹®â”†----------------------------------------
          150â”† require(_isTransferable, "ownership is not transferable");
            â‹®â”†----------------------------------------
          152â”† require(_account != address(0), "owner cannot be set to zero     
  address");                                                                    
            â‹®â”†----------------------------------------
          176â”† require(_isTransferable, "ownership is not transferable");
            â‹®â”†----------------------------------------
          228â”† require(ERC20(_asset).transfer(_to, _amount), "ERC20 token       
  transfer was unsuccessful");                                                  
            â‹®â”†----------------------------------------
          302â”† require(msg.sender == _licenceDAO, "the sender isn't the DAO");
            â‹®â”†----------------------------------------
          323â”† require(msg.data.length == 0, "msg data length should be 0");
            â‹®â”†----------------------------------------
          384â”† require(!floatLocked(), "float is locked");
            â‹®â”†----------------------------------------
          392â”† require(!holderLocked(), "holder contract is locked");
            â‹®â”†----------------------------------------
          400â”† require(!licenceDAOLocked(), "DAO is locked");
            â‹®â”†----------------------------------------
          408â”† require(!tknContractAddressLocked(), "TKN is locked");
            â‹®â”†----------------------------------------
          416â”† require(1 <= _newAmount && _newAmount <= MAX_AMOUNT_SCALE,       
  "licence amount out of range");                                               
            â‹®â”†----------------------------------------
          428â”† require(ERC20(_asset).transferFrom(msg.sender, _cryptoFloat,     
  loadAmount), "TKN transfer from external account was unsuccessful");          
            â‹®â”†----------------------------------------
          434â”† require(ERC20(_asset).transferFrom(msg.sender, _tokenHolder,     
  licenceAmount), "ERC20 licenceAmount transfer from external account was       
  unsuccessful");                                                               
            â‹®â”†----------------------------------------
          435â”† require(ERC20(_asset).transferFrom(msg.sender, _cryptoFloat,     
  loadAmount), "ERC20 token transfer from external account was unsuccessful");  
            â‹®â”†----------------------------------------
          437â”† require(msg.value == _amount, "ETH sent is not equal to amount");
            â‹®â”†----------------------------------------
          521â”† require(isAdmin(msg.sender), "sender is not an admin");
            â‹®â”†----------------------------------------
          527â”† require(isController(msg.sender), "sender is not a controller");
            â‹®â”†----------------------------------------
          580â”† require(!_isAdmin[_account], "provided account is already an     
  admin");                                                                      
            â‹®â”†----------------------------------------
          581â”† require(!_isController[_account], "provided account is already a 
  controller");                                                                 
            â‹®â”†----------------------------------------
          582â”† require(!_isOwner(_account), "provided account is already the    
  owner");                                                                      
            â‹®â”†----------------------------------------
          583â”† require(_account != address(0), "provided account is the zero    
  address");                                                                    
            â‹®â”†----------------------------------------
          591â”† require(_isAdmin[_account], "provided account is not an admin");
            â‹®â”†----------------------------------------
          599â”† require(!_isAdmin[_account], "provided account is already an     
  admin");                                                                      
            â‹®â”†----------------------------------------
          600â”† require(!_isController[_account], "provided account is already a 
  controller");                                                                 
            â‹®â”†----------------------------------------
          601â”† require(!_isOwner(_account), "provided account is already the    
  owner");                                                                      
            â‹®â”†----------------------------------------
          602â”† require(_account != address(0), "provided account is the zero    
  address");                                                                    
            â‹®â”†----------------------------------------
          610â”† require(_isController[_account], "provided account is not a      
  controller");                                                                 
            â‹®â”†----------------------------------------
         1012â”† require(_isController(msg.sender), "sender is not a controller");
            â‹®â”†----------------------------------------
         1808â”† require (_isController(msg.sender) || msg.sender ==              
  oracleAddress, "either oracle or controller");                                
            â‹®â”†----------------------------------------
         1835â”† require(_tokens.length == _symbols.length && _tokens.length ==   
  _magnitude.length && _tokens.length == _loadable.length && _tokens.length ==  
  _loadable.length, "p ... [0m                                                  
            [shortened a long line from output, adjust with                     
  --max-chars-per-line]                                                         
            â‹®â”†----------------------------------------
         1839â”† require(!_tokenInfoMap[_tokens[i]].available, "token already     
  available");                                                                  
            â‹®â”†----------------------------------------
         1865â”† require(_tokenInfoMap[_tokens[i]].available, "token is not       
  available");                                                                  
            â‹®â”†----------------------------------------
         1889â”† require(_tokenInfoMap[_token].available, "token is not           
  available");                                                                  
            â‹®â”†----------------------------------------
         2080â”† require (_isOwner(msg.sender) || _isController(msg.sender),      
  "either owner or controller");                                                
            â‹®â”†----------------------------------------
         2110â”† require(!_isOwner(_addresses[i]), "provided whitelist contains   
  the owner address");                                                          
            â‹®â”†----------------------------------------
         2111â”† require(_addresses[i] != address(0), "provided whitelist contains
  the zero address");                                                           
            â‹®â”†----------------------------------------
         2118â”† require(!submittedWhitelistAddition &&                           
  !submittedWhitelistRemoval, "whitelist operation has already been submitted");
            â‹®â”†----------------------------------------
         2136â”† require(!isSetWhitelist, "whitelist has already been             
  initialized");                                                                
            â‹®â”†----------------------------------------
         2153â”† require(isSetWhitelist, "whitelist has not been initialized");
            â‹®â”†----------------------------------------
         2155â”† require(_addresses.length > 0, "pending whitelist addition is    
  empty");                                                                      
            â‹®â”†----------------------------------------
         2169â”† require(submittedWhitelistAddition, "whitelist addition has not  
  been submitted");                                                             
            â‹®â”†----------------------------------------
         2171â”† require(_hash == calculateHash(_pendingWhitelistAddition), "hash 
  of the pending whitelist addition do not match");                             
            â‹®â”†----------------------------------------
         2192â”† require(submittedWhitelistAddition, "whitelist addition has not  
  been submitted");                                                             
            â‹®â”†----------------------------------------
         2194â”† require(_hash == calculateHash(_pendingWhitelistAddition), "hash 
  of the pending whitelist addition does not match");                           
            â‹®â”†----------------------------------------
         2207â”† require(isSetWhitelist, "whitelist has not been initialized");
            â‹®â”†----------------------------------------
         2209â”† require(_addresses.length > 0, "pending whitelist removal is     
  empty");                                                                      
            â‹®â”†----------------------------------------
         2221â”† require(submittedWhitelistRemoval, "whitelist removal has not    
  been submitted");                                                             
            â‹®â”†----------------------------------------
         2223â”† require(_hash == calculateHash(_pendingWhitelistRemoval), "hash  
  of the pending whitelist removal does not match the confirmed hash");         
            â‹®â”†----------------------------------------
         2249â”† require(submittedWhitelistRemoval, "whitelist removal has not    
  been submitted");                                                             
            â‹®â”†----------------------------------------
         2251â”† require(_hash == calculateHash(_pendingWhitelistRemoval), "hash  
  of the pending whitelist removal do not match");                              
            â‹®â”†----------------------------------------
         2293â”† require(dl.available >= _amount, "available has to be greater or 
  equal to use amount");                                                        
            â‹®â”†----------------------------------------
         2301â”† require(!dl.set, "daily limit has already been set");
            â‹®â”†----------------------------------------
         2312â”† require(dl.set, "limit has not been set");
            â‹®â”†----------------------------------------
         2320â”† require(dl.pending == _amount, "confirmed and submitted limits   
  dont match");                                                                 
            â‹®â”†----------------------------------------
         2418â”† require(_MINIMUM_GAS_TOPUP_LIMIT <= _amount && _amount <=        
  _MAXIMUM_GAS_TOPUP_LIMIT, "gas top up amount is outside the min/max range");  
            â‹®â”†----------------------------------------
         2426â”† require(_MINIMUM_GAS_TOPUP_LIMIT <= _amount && _amount <=        
  _MAXIMUM_GAS_TOPUP_LIMIT, "gas top up amount is outside the min/max range");  
            â‹®â”†----------------------------------------
         2468â”† require(_MINIMUM_LOAD_LIMIT <= _amount && _amount <=             
  _maximumLoadLimit, "card load amount is outside the min/max range");          
            â‹®â”†----------------------------------------
         2476â”† require(_MINIMUM_LOAD_LIMIT <= _amount && _amount <=             
  _maximumLoadLimit, "card load amount is outside the min/max range");          
            â‹®â”†----------------------------------------
         2532â”† require(_value != 0, "provided value cannot be zero");
            â‹®â”†----------------------------------------
         2538â”† require(msg.data.length == 0, "msg data needs to be empty");
            â‹®â”†----------------------------------------
         2559â”† require(_to != address(0), "_to address cannot be set to 0x0");
            â‹®â”†----------------------------------------
         2575â”† require(ERC20(_asset).transfer(_to, _amount), "ERC20 token       
  transfer was unsuccessful");                                                  
            â‹®â”†----------------------------------------
         2596â”† require(rate != 0, "token rate is 0");
            â‹®â”†----------------------------------------
         2631â”† require(stablecoinMagnitude > 0, "stablecoin not set");
            â‹®â”†----------------------------------------
         2653â”† require(_isTokenLoadable(_asset), "token not loadable");
            â‹®â”†----------------------------------------
         2661â”† require(ERC20(_asset).approve(licenceAddress, _amount), "ERC20   
  token approval was unsuccessful");                                            
            â‹®â”†----------------------------------------
         2683â”† require(_data.length >= 4 + 32 + 32, "invalid transfer / approve 
  transaction data");                                                           
            â‹®â”†----------------------------------------
         2705â”† require(_externalCall(_destination, _value, _data.length, _data),
  "executing transaction failed");                                              
            â‹®â”†----------------------------------------
         2729â”† require(available, "token is not available");
            â‹®â”†----------------------------------------
         2730â”† require(rate != 0, "token rate is 0");
            â‹®â”†----------------------------------------
         2738â”† require(stablecoinAvailable, "token is not available");
            â‹®â”†----------------------------------------
         2739â”† require(stablecoinRate != 0, "stablecoin rate is 0");
            â‹®â”†----------------------------------------
         2780â”† require(_bts.length >= _from + 20, "slicing out of range");
            â‹®â”†----------------------------------------
         2798â”† require(_bts.length >= _from + 4, "slicing out of range");
            â‹®â”†----------------------------------------
         2818â”† require(_bts.length >= _from + 32, "slicing out of range");
            â‹®â”†----------------------------------------
       solidity.performance.use-multiple-require                                
          Using multiple require statements is cheaper than using && multiple   
  check combinations.                                                           
          There are more advantages, such as easier to read code and better     
  coverage reports.                                                             
                                                                                
          416â”† require(1 <= _newAmount && _newAmount <= MAX_AMOUNT_SCALE,       
  "licence amount out of range");                                               
            â‹®â”†----------------------------------------
         1835â”† require(_tokens.length == _symbols.length && _tokens.length ==   
  _magnitude.length && _tokens.length == _loadable.length && _tokens.length ==  
  _loadable.length, "p ... [0m                                                  
            [shortened a long line from output, adjust with                     
  --max-chars-per-line]                                                         
            â‹®â”†----------------------------------------
         2118â”† require(!submittedWhitelistAddition &&                           
  !submittedWhitelistRemoval, "whitelist operation has already been submitted");
            â‹®â”†----------------------------------------
         2418â”† require(_MINIMUM_GAS_TOPUP_LIMIT <= _amount && _amount <=        
  _MAXIMUM_GAS_TOPUP_LIMIT, "gas top up amount is outside the min/max range");  
            â‹®â”†----------------------------------------
         2426â”† require(_MINIMUM_GAS_TOPUP_LIMIT <= _amount && _amount <=        
  _MAXIMUM_GAS_TOPUP_LIMIT, "gas top up amount is outside the min/max range");  
            â‹®â”†----------------------------------------
         2468â”† require(_MINIMUM_LOAD_LIMIT <= _amount && _amount <=             
  _maximumLoadLimit, "card load amount is outside the min/max range");          
            â‹®â”†----------------------------------------
         2476â”† require(_MINIMUM_LOAD_LIMIT <= _amount && _amount <=             
  _maximumLoadLimit, "card load amount is outside the min/max range");          
            â‹®â”†----------------------------------------
       solidity.performance.use-nested-if                                       
          Using nested is cheaper than using && multiple check combinations.    
  There are more                                                                
          advantages, such as easier to read code and better coverage reports.  
                                                                                
          872â”† if ((contentType & contentTypes) != 0 &&                         
  record.abis[contentType].length > 0) {                                        
          873â”†     data = record.abis[contentType];
          874â”†     return;
          875â”† }
            â‹®â”†----------------------------------------
       solidity.performance.use-prefix-decrement-not-postfix                    
          Consider using the prefix decrement expression whenever the return    
  value is not needed. The                                                      
          prefix decrement expression is cheaper in terms of gas.               
                                                                                
          593â”† _adminCount--;
            â‹®â”†----------------------------------------
          612â”† _controllerCount--;
            â‹®â”†----------------------------------------
         1561â”† ptr--;
            â‹®â”†----------------------------------------
         1877â”† _tokenAddressArray.length--;
            â‹®â”†----------------------------------------
         2235â”† whitelistArray.length--;
            â‹®â”†----------------------------------------
       solidity.performance.use-prefix-increment-not-postfix                    
          Consider using the prefix increment expression whenever the return    
  value is not needed. The                                                      
          prefix increment expression is cheaper in terms of gas.               
                                                                                
          585â”† _adminCount++;
            â‹®â”†----------------------------------------
          604â”† _controllerCount++;
            â‹®â”†----------------------------------------
         1200â”† for (l = 0; ptr < end; l++) {
            â‹®â”†----------------------------------------
         1366â”† for (uint i = 1; i < length; i++) {
            â‹®â”†----------------------------------------
         1521â”† ptr++;
            â‹®â”†----------------------------------------
         1530â”† for (idx = 0; idx <= selflen - needlelen; idx++) {
            â‹®â”†----------------------------------------
         1693â”† cnt++;
            â‹®â”†----------------------------------------
         1737â”† for(uint i = 0; i < parts.length; i++)
            â‹®â”†----------------------------------------
         1744â”† for(i = 0; i < parts.length; i++) {
            â‹®â”†----------------------------------------
         1837â”† for (uint i = 0; i < _tokens.length; i++) {
            â‹®â”†----------------------------------------
         1863â”† for (uint i = 0; i < _tokens.length; i++) {
            â‹®â”†----------------------------------------
         1871â”† for (uint j = 0; j < _tokenAddressArray.length.sub(1); j++) {
            â‹®â”†----------------------------------------
         2109â”† for (uint i = 0; i < _addresses.length; i++) {
            â‹®â”†----------------------------------------
         2138â”† for (uint i = 0; i < _addresses.length; i++) {
            â‹®â”†----------------------------------------
         2173â”† for (uint i = 0; i < _pendingWhitelistAddition.length; i++) {
            â‹®â”†----------------------------------------
         2225â”† for (uint i = 0; i < _pendingWhitelistRemoval.length; i++) {
            â‹®â”†----------------------------------------
         2229â”† for (uint j = 0; j < whitelistArray.length.sub(1); j++) {
            â‹®â”†----------------------------------------
         2785â”† for (uint8 i = 0; i < 20; i++) {
            â‹®â”†----------------------------------------
         2803â”† for (uint8 i = 0; i < 4; i++) {
            â‹®â”†----------------------------------------
       solidity.performance.use-short-revert-string                             
          Shortening revert strings to fit in 32 bytes will decrease gas costs  
  for deployment and  gas                                                       
          costs when the revert condition has been met.                         
                                                                                
          152â”† require(_account != address(0), "owner cannot be set to zero     
  address");                                                                    
            â‹®â”†----------------------------------------
          228â”† require(ERC20(_asset).transfer(_to, _amount), "ERC20 token       
  transfer was unsuccessful");                                                  
            â‹®â”†----------------------------------------
          428â”† require(ERC20(_asset).transferFrom(msg.sender, _cryptoFloat,     
  loadAmount), "TKN transfer from external account was unsuccessful");          
            â‹®â”†----------------------------------------
          434â”† require(ERC20(_asset).transferFrom(msg.sender, _tokenHolder,     
  licenceAmount), "ERC20 licenceAmount transfer from external account was       
  unsuccessful");                                                               
            â‹®â”†----------------------------------------
          435â”† require(ERC20(_asset).transferFrom(msg.sender, _cryptoFloat,     
  loadAmount), "ERC20 token transfer from external account was unsuccessful");  
            â‹®â”†----------------------------------------
          580â”† require(!_isAdmin[_account], "provided account is already an     
  admin");                                                                      
            â‹®â”†----------------------------------------
          581â”† require(!_isController[_account], "provided account is already a 
  controller");                                                                 
            â‹®â”†----------------------------------------
          582â”† require(!_isOwner(_account), "provided account is already the    
  owner");                                                                      
            â‹®â”†----------------------------------------
          583â”† require(_account != address(0), "provided account is the zero    
  address");                                                                    
            â‹®â”†----------------------------------------
          599â”† require(!_isAdmin[_account], "provided account is already an     
  admin");                                                                      
            â‹®â”†----------------------------------------
          600â”† require(!_isController[_account], "provided account is already a 
  controller");                                                                 
            â‹®â”†----------------------------------------
          601â”† require(!_isOwner(_account), "provided account is already the    
  owner");                                                                      
            â‹®â”†----------------------------------------
          602â”† require(_account != address(0), "provided account is the zero    
  address");                                                                    
            â‹®â”†----------------------------------------
          610â”† require(_isController[_account], "provided account is not a      
  controller");                                                                 
            â‹®â”†----------------------------------------
         2110â”† require(!_isOwner(_addresses[i]), "provided whitelist contains   
  the owner address");                                                          
            â‹®â”†----------------------------------------
         2111â”† require(_addresses[i] != address(0), "provided whitelist contains
  the zero address");                                                           
            â‹®â”†----------------------------------------
         2118â”† require(!submittedWhitelistAddition &&                           
  !submittedWhitelistRemoval, "whitelist operation has already been submitted");
            â‹®â”†----------------------------------------
         2136â”† require(!isSetWhitelist, "whitelist has already been             
  initialized");                                                                
            â‹®â”†----------------------------------------
         2153â”† require(isSetWhitelist, "whitelist has not been initialized");
            â‹®â”†----------------------------------------
         2155â”† require(_addresses.length > 0, "pending whitelist addition is    
  empty");                                                                      
            â‹®â”†----------------------------------------
         2169â”† require(submittedWhitelistAddition, "whitelist addition has not  
  been submitted");                                                             
            â‹®â”†----------------------------------------
         2171â”† require(_hash == calculateHash(_pendingWhitelistAddition), "hash 
  of the pending whitelist addition do not match");                             
            â‹®â”†----------------------------------------
         2192â”† require(submittedWhitelistAddition, "whitelist addition has not  
  been submitted");                                                             
            â‹®â”†----------------------------------------
         2194â”† require(_hash == calculateHash(_pendingWhitelistAddition), "hash 
  of the pending whitelist addition does not match");                           
            â‹®â”†----------------------------------------
         2207â”† require(isSetWhitelist, "whitelist has not been initialized");
            â‹®â”†----------------------------------------
         2209â”† require(_addresses.length > 0, "pending whitelist removal is     
  empty");                                                                      
            â‹®â”†----------------------------------------
         2221â”† require(submittedWhitelistRemoval, "whitelist removal has not    
  been submitted");                                                             
            â‹®â”†----------------------------------------
         2223â”† require(_hash == calculateHash(_pendingWhitelistRemoval), "hash  
  of the pending whitelist removal does not match the confirmed hash");         
            â‹®â”†----------------------------------------
         2249â”† require(submittedWhitelistRemoval, "whitelist removal has not    
  been submitted");                                                             
            â‹®â”†----------------------------------------
         2251â”† require(_hash == calculateHash(_pendingWhitelistRemoval), "hash  
  of the pending whitelist removal do not match");                              
            â‹®â”†----------------------------------------
         2293â”† require(dl.available >= _amount, "available has to be greater or 
  equal to use amount");                                                        
            â‹®â”†----------------------------------------
         2320â”† require(dl.pending == _amount, "confirmed and submitted limits   
  dont match");                                                                 
            â‹®â”†----------------------------------------
         2418â”† require(_MINIMUM_GAS_TOPUP_LIMIT <= _amount && _amount <=        
  _MAXIMUM_GAS_TOPUP_LIMIT, "gas top up amount is outside the min/max range");  
            â‹®â”†----------------------------------------
         2426â”† require(_MINIMUM_GAS_TOPUP_LIMIT <= _amount && _amount <=        
  _MAXIMUM_GAS_TOPUP_LIMIT, "gas top up amount is outside the min/max range");  
            â‹®â”†----------------------------------------
         2468â”† require(_MINIMUM_LOAD_LIMIT <= _amount && _amount <=             
  _maximumLoadLimit, "card load amount is outside the min/max range");          
            â‹®â”†----------------------------------------
         2476â”† require(_MINIMUM_LOAD_LIMIT <= _amount && _amount <=             
  _maximumLoadLimit, "card load amount is outside the min/max range");          
            â‹®â”†----------------------------------------
         2575â”† require(ERC20(_asset).transfer(_to, _amount), "ERC20 token       
  transfer was unsuccessful");                                                  
            â‹®â”†----------------------------------------
         2661â”† require(ERC20(_asset).approve(licenceAddress, _amount), "ERC20   
  token approval was unsuccessful");                                            
            â‹®â”†----------------------------------------
         2683â”† require(_data.length >= 4 + 32 + 32, "invalid transfer / approve 
  transaction data");                                                           

                
                
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Scan Summary â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Some files were skipped or only partially analyzed.
  Partially scanned: 1 files only partially analyzed due to parsing or internal Semgrep errors

Ran 48 rules on 1 file: 221 findings.

A new version of Semgrep is available. See https://semgrep.dev/docs/upgrading

Versions prior to 1.43.0 will cease to work with Semgrep.dev after March 11th 2024, please upgrade.
