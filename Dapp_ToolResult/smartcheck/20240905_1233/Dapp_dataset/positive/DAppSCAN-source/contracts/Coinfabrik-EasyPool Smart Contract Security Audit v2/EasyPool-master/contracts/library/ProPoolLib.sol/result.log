/sb/ProPoolLib.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 372
column: 8
content: for(uinti=0;i<admins.length;i++){addAdmin(pool,admins[i]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 809
column: 12
content: for(uinti=0;i<tokenAddresses.length;i++){tokenBalances[i]=IERC20Base(tokenAddresses[i]).balanceOf(address(this));}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 873
column: 16
content: for(uinti=0;i<pool.tokenAddresses.length;i++){tokenShare[i]=pool.tokenQuota[pool.tokenAddresses[i]].calcShare(addr,IERC20Base(pool.tokenAddresses[i]).balanceOf(address(this)),[netPartContribution,netPoolContribution]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 1282
column: 8
content: for(i=0;i<exclude.length;i++){participant=pool.participantToData[exclude[i]];if(participant.whitelist[idx]){participant.whitelist[idx]=false;emitExcludedFromWhitelist(exclude[i],idx);}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 1294
column: 8
content: for(i=0;i<include.length;i++){participant=pool.participantToData[include[i]];if(!participant.whitelist[idx]){if(!participant.exists){pool.participants.push(include[i]);participant.exists=true;}participant.whitelist[idx]=true;emitIncludedInWhitelist(include[i],idx);}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 1359
column: 8
content: for(uinti=0;i<pool.participants.length;i++){participant=pool.participantToData[pool.participants[i]];(contribution,remaining)=calcContribution(x,0,maxBalance,groupContribution,minContribution,maxContribution,isRestricted,participant);if(contribution!=participant.contribution[x]){participant.contribution[x]=contribution;participant.remaining[x]=remaining;}groupContribution+=contribution;groupRemaining+=remaining;emitContributionAdjusted(pool.participants[i],contribution,remaining,groupContribution,groupRemaining,x);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 1614
column: 8
content: for(uinti=0;i<array.length;i++){if(array[i]==addr){returntrue;}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 1021
column: 4
content: functionwithdrawAllRemaining2(Poolstoragepool)privatereturns(uintpoolContribution,uintpoolRemaining,uintpoolCtorFee,uintpartContribution,uintpartCtorFee){Participantstorageparticipant=pool.participantToData[msg.sender];Groupstoragegroup;uintsumRemaining;uintremaining;uintlength=pool.groups.length;for(uintidx=0;idx<length;idx++){group=pool.groups[idx];poolRemaining+=group.remaining;poolContribution+=group.contribution;poolCtorFee+=calcFee(group.contribution,group.ctorFeePerEther);remaining=participant.remaining[idx];partContribution+=participant.contribution[idx];partCtorFee+=calcFee(participant.contribution[idx],group.ctorFeePerEther);if(remaining>0){sumRemaining+=remaining;group.remaining-=remaining;participant.remaining[idx]=0;emitWithdrawal(msg.sender,idx,remaining,participant.contribution[idx],0,group.contribution,group.remaining);}}if(sumRemaining>0){poolRemaining-=sumRemaining;addressTransfer(msg.sender,sumRemaining);}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 1513
column: 4
content: functioncalcPoolSummary(Poolstoragepool)privateviewreturns(uintpoolContribution,uintpoolRemaining,uintctorFee){Groupstoragegroup;uintlength=pool.groups.length;for(uintidx=0;idx<length;idx++){group=pool.groups[idx];if(!group.exists){break;}poolRemaining+=group.remaining;poolContribution+=group.contribution;ctorFee+=calcFee(group.contribution,group.ctorFeePerEther);}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 1540
column: 4
content: functioncalcPoolSummary2(Poolstoragepool,addressaddr)privateviewreturns(uintpoolContribution,uintpoolRemaining,uintpoolCtorFee,uintpartContribution,uintpartCtorFee){Groupstoragegroup;Participantstorageparticipant=pool.participantToData[addr];uintlength=pool.groups.length;for(uintidx=0;idx<length;idx++){group=pool.groups[idx];if(!group.exists){break;}poolRemaining+=group.remaining;poolContribution+=group.contribution;poolCtorFee+=calcFee(group.contribution,group.ctorFeePerEther);partContribution+=participant.contribution[idx];partCtorFee+=calcFee(participant.contribution[idx],group.ctorFeePerEther);}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 372
column: 8
content: for(uinti=0;i<admins.length;i++){addAdmin(pool,admins[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 809
column: 12
content: for(uinti=0;i<tokenAddresses.length;i++){tokenBalances[i]=IERC20Base(tokenAddresses[i]).balanceOf(address(this));}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 837
column: 8
content: for(uinti=0;i<length;i++){contribution[i]=part.contribution[i];remaining[i]=part.remaining[i];whitelist[i]=part.whitelist[i];}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 873
column: 16
content: for(uinti=0;i<pool.tokenAddresses.length;i++){tokenShare[i]=pool.tokenQuota[pool.tokenAddresses[i]].calcShare(addr,IERC20Base(pool.tokenAddresses[i]).balanceOf(address(this)),[netPartContribution,netPoolContribution]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 934
column: 8
content: for(uintidx=0;idx<length;idx++){contribution=participant.contribution[idx];remaining=participant.remaining[idx];sum=contribution+remaining;if(sum>0){amount+=sum;group=pool.groups[idx];if(contribution>0){group.contribution-=contribution;participant.contribution[idx]=0;}if(remaining>0){group.remaining-=remaining;participant.remaining[idx]=0;}emitWithdrawal(msg.sender,idx,sum,0,0,group.contribution,group.remaining);}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 988
column: 8
content: for(uintidx=0;idx<length;idx++){remaining=participant.remaining[idx];if(remaining>0){amount+=remaining;group=pool.groups[idx];group.remaining-=remaining;participant.remaining[idx]=0;emitWithdrawal(msg.sender,idx,remaining,participant.contribution[idx],0,group.contribution,group.remaining);}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 1039
column: 8
content: for(uintidx=0;idx<length;idx++){group=pool.groups[idx];poolRemaining+=group.remaining;poolContribution+=group.contribution;poolCtorFee+=calcFee(group.contribution,group.ctorFeePerEther);remaining=participant.remaining[idx];partContribution+=participant.contribution[idx];partCtorFee+=calcFee(participant.contribution[idx],group.ctorFeePerEther);if(remaining>0){sumRemaining+=remaining;group.remaining-=remaining;participant.remaining[idx]=0;emitWithdrawal(msg.sender,idx,remaining,participant.contribution[idx],0,group.contribution,group.remaining);}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 1169
column: 8
content: for(uinti=0;i<length;i++){tokenAddress=pool.tokenAddresses[i];tokenContract=IERC20Base(tokenAddress);tokenBalance=tokenContract.balanceOf(address(this));if(tokenBalance>0){quota=pool.tokenQuota[tokenAddress];tokenAmount=quota.claimShare(msg.sender,tokenBalance,[netPartContribution,netPoolContribution]);if(tokenAmount>0){succeeded=tokenContract.transfer(msg.sender,tokenAmount);if(!succeeded){quota.undoClaimShare(msg.sender,tokenAmount);}emitTokenWithdrawal(tokenAddress,msg.sender,tokenBalance,tokenAmount,succeeded);}}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 1282
column: 8
content: for(i=0;i<exclude.length;i++){participant=pool.participantToData[exclude[i]];if(participant.whitelist[idx]){participant.whitelist[idx]=false;emitExcludedFromWhitelist(exclude[i],idx);}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 1294
column: 8
content: for(i=0;i<include.length;i++){participant=pool.participantToData[include[i]];if(!participant.whitelist[idx]){if(!participant.exists){pool.participants.push(include[i]);participant.exists=true;}participant.whitelist[idx]=true;emitIncludedInWhitelist(include[i],idx);}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 1359
column: 8
content: for(uinti=0;i<pool.participants.length;i++){participant=pool.participantToData[pool.participants[i]];(contribution,remaining)=calcContribution(x,0,maxBalance,groupContribution,minContribution,maxContribution,isRestricted,participant);if(contribution!=participant.contribution[x]){participant.contribution[x]=contribution;participant.remaining[x]=remaining;}groupContribution+=contribution;groupRemaining+=remaining;emitContributionAdjusted(pool.participants[i],contribution,remaining,groupContribution,groupRemaining,x);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 1525
column: 8
content: for(uintidx=0;idx<length;idx++){group=pool.groups[idx];if(!group.exists){break;}poolRemaining+=group.remaining;poolContribution+=group.contribution;ctorFee+=calcFee(group.contribution,group.ctorFeePerEther);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 1555
column: 8
content: for(uintidx=0;idx<length;idx++){group=pool.groups[idx];if(!group.exists){break;}poolRemaining+=group.remaining;poolContribution+=group.contribution;poolCtorFee+=calcFee(group.contribution,group.ctorFeePerEther);partContribution+=participant.contribution[idx];partCtorFee+=calcFee(participant.contribution[idx],group.ctorFeePerEther);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 1614
column: 8
content: for(uinti=0;i<array.length;i++){if(array[i]==addr){returntrue;}}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 15
column: 0
content: contractIFeeService{functiongetFeePerEther()publicviewreturns(uint);functionsendFee(addressfeePayer)externalpayable;}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 107
column: 4
content: usingSafeMathforuint;

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 1024
column: 4
content: (uintpoolContribution,uintpoolRemaining,uintpoolCtorFee,uintpartContribution,uintpartCtorFee)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 1478
column: 15
content: (uintcontribution,uintremaining)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 1516
column: 4
content: (uintpoolContribution,uintpoolRemaining,uintctorFee)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 1543
column: 4
content: (uintpoolContribution,uintpoolRemaining,uintpoolCtorFee,uintpartContribution,uintpartCtorFee)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 1576
column: 4
content: (uintnetPoolContribution,uintnetPartContribution,uintpoolRemaining,uintpoolCtorFee)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 347
column: 8
content: address[]whitelist

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 348
column: 8
content: address[]admins

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 434
column: 58
content: address[]include

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 434
column: 77
content: address[]exclude

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 532
column: 8
content: bytesdata

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 733
column: 72
content: bytesdata

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 774
column: 12
content: address[]participants

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 775
column: 12
content: address[]admins

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 797
column: 12
content: address[]tokenAddresses

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 798
column: 12
content: uint[]tokenBalances

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 821
column: 12
content: uint[]contribution

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 822
column: 12
content: uint[]remaining

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 823
column: 12
content: bool[]whitelist

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 847
column: 88
content: uint[]tokenShare

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1266
column: 62
content: address[]include

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1266
column: 81
content: address[]exclude

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1442
column: 64
content: bytesdata

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1449
column: 81
content: bytesdata

SOLIDITY_SAFEMATH :1
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_LOCKED_MONEY :1
SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN :3
SOLIDITY_EXTRA_GAS_IN_LOOPS :7
SOLIDITY_UPGRADE_TO_050 :18
SOLIDITY_GAS_LIMIT_IN_LOOPS :14
SOLIDITY_SHOULD_RETURN_STRUCT :5
